<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>回调通知 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        回调通知
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2023/11/30</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="0d87e7a519af80ef592de814aa791549-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E5%AE%A2%E6%9C%8D%E8%B4%A6%E5%8F%B7%E6%8E%88%E6%9D%83%E5%8F%98%E6%9B%B4%E4%BA%8B%E4%BB%B6" class="level-2">客服账号授权变更事件</a></li></dir><p data-sign="999739a41e99056cc1d5fafea19e3f56" data-type="p" data-lines="2">为了让实时获取企业的微信客服的状态，企业微信会将特定的事件推送给应用配置的<code>回调URL</code>。</p><p data-sign="4809a86d63cd66fb198658d01ebd37f3" data-type="p" data-lines="2">接收并解析事件的方法见：<a href="#12977" rel="nofollow">接收事件</a></p><div class="cherry-table-container" data-sign="90f7b383dac8aee4e5252fe7b1e8c656" data-lines="5">
        <table class="cherry-table"><thead><tr><th>应用类型</th><th>权限要求</th><th>接收事件开关</th></tr></thead><tbody><tr><td>自建应用</td><td>配置到「<a href="#31164" rel="nofollow">微信客服- 可调用接口的应用</a>」中</td><td><a href="#12977/%E5%BC%80%E5%90%AF%E6%8E%A5%E6%94%B6%E6%B6%88%E6%81%AF" rel="nofollow">微信客服消息和事件</a></td></tr><tr><td>代开发应用</td><td>具有「<span style="color:#ff0000">微信客服-&gt;管理账号、分配会话和收发消息</span>」权限</td><td>无</td></tr><tr><td>第三方应用</td><td>具有「<span style="color:#ff0000">微信客服-&gt;管理账号、分配会话和收发消息</span>」权限</td><td>无</td></tr></tbody></table></div><p data-sign="e053aa843c6cb7be780ad7c3df67763e" data-type="p" data-lines="1">特别说明：</p><ul data-sign="7ad7bf1e8b8ca09bb738560069c4e302list2" data-lines="2" class="cherry-list__default"><li>对自建应用，配置到「<a href="#31164" rel="nofollow">微信客服- 可调用接口的应用</a>」且授权了至少一个客服账号后，则自动获得「<span style="color:#ff0000">微信客服-&gt;管理账号、分配会话和收发消息</span>」权限</li><li>「取消客服账号的授权」事件，不需要有微信客服权限（如因权限被移除引起的客服账号取消授权）</li></ul><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><h2 id="%E5%AE%A2%E6%9C%8D%E8%B4%A6%E5%8F%B7%E6%8E%88%E6%9D%83%E5%8F%98%E6%9B%B4%E4%BA%8B%E4%BB%B6" data-sign="9d221676a2f8f4113fb4883a485dfe89" data-lines="1"><a class="anchor" href="#%E5%AE%A2%E6%9C%8D%E8%B4%A6%E5%8F%B7%E6%8E%88%E6%9D%83%E5%8F%98%E6%9B%B4%E4%BA%8B%E4%BB%B6"></a>客服账号授权变更事件</h2><p data-sign="6d2f31fc8d1c5f3ed313c1cb34f543b7" data-type="p" data-lines="1">当应用授权的客服账号发生变化（新增/取消客服账号的授权），触发该回调。</p><p data-sign="4dd561ee43c97ca00e59f6f71337c76f" data-type="p" data-lines="1"><strong>示例</strong></p><div data-sign="50f4bd46bef20be5dd9097f3bed79c35" data-type="codeBlock" data-lines="11">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token operator">&lt;</span>xml<span class="token operator">&gt;</span></span>
<span class="code-line">   <span class="token operator">&lt;</span>ToUserName<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>toUser<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>ToUserName<span class="token operator">&gt;</span></span>
<span class="code-line">   <span class="token operator">&lt;</span>FromUserName<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>sys<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>FromUserName<span class="token operator">&gt;</span> </span>
<span class="code-line">   <span class="token operator">&lt;</span>CreateTime<span class="token operator">&gt;</span><span class="token number">1348831860</span><span class="token operator">&lt;</span><span class="token operator">/</span>CreateTime<span class="token operator">&gt;</span></span>
<span class="code-line">   <span class="token operator">&lt;</span>MsgType<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>event<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>MsgType<span class="token operator">&gt;</span></span>
<span class="code-line">   <span class="token operator">&lt;</span>Event<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>kf_account_auth_change<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>Event<span class="token operator">&gt;</span></span>
<span class="code-line">   <span class="token operator">&lt;</span>AuthAddOpenKfId<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>wkxxxx1<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>AuthAddOpenKfId<span class="token operator">&gt;</span></span>
<span class="code-line">   <span class="token operator">&lt;</span>AuthDelOpenKfId<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>wkxxxx2<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>AuthDelOpenKfId<span class="token operator">&gt;</span></span>
<span class="code-line"><span class="token operator">&lt;</span><span class="token operator">/</span>xml<span class="token operator">&gt;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="c6247c0bd51e035939c487df6d2a61cd" data-type="p" data-lines="1"><strong>说明</strong></p><div class="cherry-table-container" data-sign="2d349df5d4c70deacbf2d945a6951070" data-lines="9">
        <table class="cherry-table"><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>ToUserName</td><td>企业微信CorpID</td></tr><tr><td>FromUserName</td><td>此事件该值固定为<code>sys</code>，表示该消息由系统生成</td></tr><tr><td>CreateTime</td><td>消息创建时间，unix时间戳</td></tr><tr><td>MsgType</td><td>消息类型，此时固定为：<code>event</code></td></tr><tr><td>Event</td><td>事件类型，此时固定为：<code>kf_account_auth_change</code></td></tr><tr><td>AuthAddOpenKfId</td><td>新增授权的客服账号列表，多个<code>AuthAddOpenKfId</code>节点表示多个新增账号</td></tr><tr><td>AuthDelOpenKfId</td><td>取消授权的客服账号列表，多个<code>AuthDelOpenKfId</code>节点表示多个取消账号</td></tr></tbody></table></div><p data-sign="br3" data-type="br" data-lines="3">&nbsp;</p></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>