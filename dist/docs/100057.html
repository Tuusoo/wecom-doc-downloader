<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>专区程序开发指引 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        专区程序开发指引
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2025/09/28</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="e7d629f46ce7b826513240633d1ad711-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E6%A6%82%E8%BF%B0" class="level-1">概述</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#sdk%E7%89%88%E6%9C%AC" class="level-2">SDK版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#python" class="level-3">Python</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#c" class="level-3">c++</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#java" class="level-3">Java</a></li><li class="toc-li"><a href="#%E4%B8%93%E5%8C%BA%E8%AF%B7%E6%B1%82%E4%BC%81%E5%BE%AE%E5%90%8E%E5%8F%B0" class="level-1">专区请求企微后台</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#python%E7%89%88%E6%9C%AC" class="level-2">Python版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8" class="level-3">基础参数列表</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B" class="level-3">调用接口示例</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#c%E7%89%88%E6%9C%AC" class="level-2">C++版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8-3" class="level-3">基础参数列表</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B-3" class="level-3">调用接口示例</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#java%E7%89%88%E6%9C%AC" class="level-2">Java版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8-4" class="level-3">基础参数列表</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B-4" class="level-3">调用接口示例</a></li><li class="toc-li"><a href="#%E4%BC%81%E5%BE%AE%E5%90%8E%E5%8F%B0%E8%B0%83%E7%94%A8%E4%B8%93%E5%8C%BA" class="level-1">企微后台调用专区</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#python%E7%89%88%E6%9C%AC-3" class="level-2">Python版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86" class="level-3">验签和解密</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-python" class="level-3">获取请求参数-Python</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%9B%9E%E5%8C%85" class="level-3">回包</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%9E%84%E9%80%A0header" class="level-4">构造header</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%8A%A0%E5%AF%86body" class="level-4">加密body</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#c%E7%89%88%E6%9C%AC-3" class="level-2">C++版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86-3" class="level-3">验签和解密</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-cpp" class="level-3">获取请求参数-CPP</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%9B%9E%E5%8C%85-3" class="level-3">回包</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#java%E7%89%88%E6%9C%AC-3" class="level-2">Java版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86-4" class="level-3">验签和解密</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-java" class="level-3">获取请求参数-Java</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%9B%9E%E5%8C%85-4" class="level-3">回包</a></li><li class="toc-li"><a href="#%E4%B8%93%E5%8C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0" class="level-1">专区程序的日志打印</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%AF%B4%E6%98%8E" class="level-2">日志格式说明</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%E8%AF%B4%E6%98%8E" class="level-2">日志级别说明</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#python%E7%89%88%E6%9C%AC-4" class="level-2">Python版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#c%E7%89%88%E6%9C%AC-4" class="level-2">C++版本</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#java%E7%89%88%E6%9C%AC-4" class="level-2">Java版本</a></li><li class="toc-li"><a href="#%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E6%8C%87%E5%BC%95" class="level-1">本地调试指引</a></li></dir><h1 id="%E6%A6%82%E8%BF%B0" data-sign="87e604caed8185ceee87dc50e1676ad9" data-lines="1"><a class="anchor" href="#%E6%A6%82%E8%BF%B0"></a>概述</h1><p data-sign="8fe0abfaa747fa233248a46bf46770c7" data-type="p" data-lines="3">专区sdk提供两种功能：<br>（1）专区请求企业微信后台sdk：提供用于拉取用户会话id记录、模型分析等功能的接口。<br>（2）企业微信请求专区程序：程序监听端口，接收到企微后台发起的请求后，利用sdk提供的加解密接口进行验签、解密和构造回包。</p><h2 id="sdk%E7%89%88%E6%9C%AC" data-sign="3e2d01710209dbb33f8e7ae31c71e938" data-lines="2"><a class="anchor" href="#sdk%E7%89%88%E6%9C%AC"></a>SDK版本</h2><p data-sign="93208a366bd55a0e0325c5b2373674ff" data-type="p" data-lines="1">目前sdk提供python、c++和java三种语言的版本，可通过<a href="#55652" rel="nofollow">这里下载</a>。</p><h3 id="python" data-sign="dbb3e1063cff6f9f48612c2a0f789dd4" data-lines="1"><a class="anchor" href="#python"></a>Python</h3><p data-sign="2f7f16440b9d8179fea532af02ba3cbd" data-type="p" data-lines="3"><strong>使用方式</strong><br>Python版本sdk目前只支持python 3.6、3.12；<br>使用前需要安装pycryptodome库：</p><div data-sign="64b81301342791bcd9e94666abff01d7" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">pip3 install pycryptodome</span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="8bd4b771be2f4198070240bbb2307153" data-type="p" data-lines="2">sdk文件名为<code>wwspecapisdk.so</code>，使用时可放置于工程目录；<br>使用时导入代码部分如下：</p><div data-sign="1bf81cb78bd805c1b64125c61c525f32" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">from wwspecapisdk <span class="token keyword">import</span> WWToSpecHTTPReqDecoder<span class="token punctuation">,</span> WWToSpecHTTPRspConstructor<span class="token punctuation">,</span> ChatDataSDK<span class="token punctuation">,</span> spec_log_info<span class="token punctuation">,</span> spec_log_error<span class="token punctuation">,</span> spec_log_debug<span class="token punctuation">,</span> spec_open_debug_mode</span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h3 id="c" data-sign="ca62d1fa1852054f797ec47064e597e6" data-lines="1"><a class="anchor" href="#c"></a>c++</h3><p data-sign="ca06e871212b768d036767f7c04e30cd" data-type="p" data-lines="2"><strong>使用方式</strong></p><p data-sign="9df7bd922571fd924c2ccd262f0b4640" data-type="p" data-lines="1">c++版本的sdk包括一个头文件和一个动态链接库：<code>cpp_sdk.h</code>和<code>libWeWorkSpecSDK.so</code>，使用时导入代码部分如下：</p><div data-sign="8b709e7180c001672df29071319b10c6" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">#include <span class="token string">"cpp_sdk.h"</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="5c6ac98ad177429883643830f95e91e6" data-type="p" data-lines="1">sdk依赖<code>openssl3</code>。需要<code>libcrypto.so.3</code>和<code>libssl.so.3</code></p><h3 id="java" data-sign="cdcd6699cc89b5d643d03d9aec203b53" data-lines="2"><a class="anchor" href="#java"></a>Java</h3><div data-sign="9125af2d814a509fb8004be78a24fffa" data-type="div" data-lines="3"><span></span><div class="colorful_tips colorful_tips_danger"><div class="colorful_tips_title"><img src="data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iMTYiIGhlaWdodD0iMTYiIHZpZXdCb3g9IjAgMCAxNiAxNiIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjE2IiBoZWlnaHQ9IjE2IiByeD0iOCIgZmlsbD0iI0FBMzUyRCIvPgo8cGF0aCBmaWxsLXJ1bGU9ImV2ZW5vZGQiIGNsaXAtcnVsZT0iZXZlbm9kZCIgZD0iTTExLjUzMDMgNS41MzAzM0MxMS44MjMyIDUuMjM3NDQgMTEuODIzMiA0Ljc2MjU2IDExLjUzMDMgNC40Njk2N0MxMS4yMzc0IDQuMTc2NzggMTAuNzYyNiA0LjE3Njc4IDEwLjQ2OTcgNC40Njk2N0w4IDYuOTM5MzRMNS41MzAzMyA0LjQ2OTY3QzUuMjM3NDQgNC4xNzY3OCA0Ljc2MjU2IDQuMTc2NzggNC40Njk2NyA0LjQ2OTY3QzQuMTc2NzggNC43NjI1NiA0LjE3Njc4IDUuMjM3NDQgNC40Njk2NyA1LjUzMDMzTDYuOTM5MzQgOEw0LjQ2OTY3IDEwLjQ2OTdDNC4xNzY3OCAxMC43NjI2IDQuMTc2NzggMTEuMjM3NCA0LjQ2OTY3IDExLjUzMDNDNC43NjI1NiAxMS44MjMyIDUuMjM3NDQgMTEuODIzMiA1LjUzMDMzIDExLjUzMDNMOCA5LjA2MDY2TDEwLjQ2OTcgMTEuNTMwM0MxMC43NjI2IDExLjgyMzIgMTEuMjM3NCAxMS44MjMyIDExLjUzMDMgMTEuNTMwM0MxMS44MjMyIDExLjIzNzQgMTEuODIzMiAxMC43NjI2IDExLjUzMDMgMTAuNDY5N0w5LjA2MDY2IDhMMTEuNTMwMyA1LjUzMDMzWiIgZmlsbD0id2hpdGUiLz4KPC9zdmc+Cg==">特别注意</div><div class="colorful_tips_cnt">Oracle JDK需要付费获得Oracle授权方可使用，严禁部署包含未授权的Oracle JDK的镜像到专区，否则产生的风险和后果由上传者承担！开发者可以使用<a href="https://openjdk.org/" rel="nofollow">OpenJDK</a>或Kona JDK(<a href="https://github.com/Tencent/TencentKona-8/releases/" rel="nofollow">Kona 8</a>、<a href="https://github.com/Tencent/TencentKona-11/releases/" rel="nofollow">Kona 11</a>、<a href="https://github.com/Tencent/TencentKona-17/releases/" rel="nofollow">Kona 17</a>或更新的Kona版本)。<br></div></div></div><p data-sign="58185a0283ddb27a497060403b1ad784" data-type="p" data-lines="3"><strong>使用方式</strong><br>Java版本的SDK包含三个类的源文件：<code>SpecSDK.java</code>、<code>SpecCallbackSDK.java</code>、<code>SpecUtil.java</code>和一个动态链接库<code>libWeWorkSpecSDK.so</code>（与C++版本的内容不同），SDK的配置要点如下：</p><ol data-sign="87d9cd9e9748a3c4b029b5da40b9d9bdlist1" data-lines="1" class="cherry-list__default" start="1"><li>配置SDK：三个类文件需保持包路径com.tencent.wework，即存放在com/tencent/wework目录下。</li></ol><blockquote data-sign="5b3fbcbc37edffa492c705d638e60f7c_2" data-lines="2">原因：java native方法的查找会拼接当前包路径作为前缀。以SDK中SpecCallbackSDK类的native方法NewCallbackSDK为例，其包路径为com.tencent.wework，则其注册的native方法签名为<code>Java_com_tencent_wework_SpecCallbackSDK_NewCallbackSDK</code>。因此，在使用SDK时必须维持包结构com.tencent.wework。</blockquote><ol data-sign="42468d3ce8ff821d18c11c471da19c37list1" data-lines="1" class="cherry-list__default" start="2"><li>使用时应将动态链接库libWeWorkSpecSDK.so拷贝到Java查找本地库的路径（java.library.path）下或添加本地库查找路径，如<code>/usr/lib</code>。</li></ol><blockquote data-sign="a630bdf59c9d5929a9da4f8d6a7a0573_2" data-lines="2">该参数可在Java程序内调用<code>System.getProperty("java.library.path")</code>或命令行界面调用<code>java -XshowSettings:properties -version</code>查看  </blockquote><ol data-sign="e6e24f7124f234910a09fc6754222295list1" data-lines="1" class="cherry-list__default" start="3"><li>sdk依赖<code>openssl3</code>，需要<code>libcrypto.so.3</code>和<code>libssl.so.3</code></li></ol><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="304fd772c1516b78d935e063d707bece" data-type="p" data-lines="1">导入代码如下：</p><div data-sign="19ffdfe9d2919677df8a4659011132ce" data-type="codeBlock" data-lines="5">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>tencent<span class="token punctuation">.</span>wework<span class="token punctuation">.</span></span><span class="token class-name">SpecSDK</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>tencent<span class="token punctuation">.</span>wework<span class="token punctuation">.</span></span><span class="token class-name">SpecCallbackSDK</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>tencent<span class="token punctuation">.</span>wework<span class="token punctuation">.</span></span><span class="token class-name">SpecUtil</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h1 id="%E4%B8%93%E5%8C%BA%E8%AF%B7%E6%B1%82%E4%BC%81%E5%BE%AE%E5%90%8E%E5%8F%B0" data-sign="4cd56bec5376d2d445302454c4e978e2" data-lines="2"><a class="anchor" href="#%E4%B8%93%E5%8C%BA%E8%AF%B7%E6%B1%82%E4%BC%81%E5%BE%AE%E5%90%8E%E5%8F%B0"></a>专区请求企微后台</h1><p data-sign="faef3a37d67039e1ad8001e10d6ea257" data-type="p" data-lines="4"><strong>请求方式</strong><br>通过官方提供的sdk接口进行调用，具体参考每个sdk接口定义<br><strong>请求包</strong><br>sdk接口请求包为json协议，具体的json协议参考每个sdk接口说明</p><h2 id="python%E7%89%88%E6%9C%AC" data-sign="de68c4e48e3a9e24f57dabc2e148aa1a" data-lines="2"><a class="anchor" href="#python%E7%89%88%E6%9C%AC"></a>Python版本</h2><p data-sign="a43b1338263f0c1d6eb387fd50debf1d" data-type="p" data-lines="2">python版本的sdk为每个接口封装了一个调用函数，调用时使用基础参数构造类的实例，之后调用对应成员函数来请求企业微信后台的对应接口。<br>接口正常调用成功时返回企微后台的回包内容，调用失败时抛出异常。</p><h3 id="%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8" data-sign="40ca3c23b2a6c6af27b2be790a7236aa" data-lines="2"><a class="anchor" href="#%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8"></a>基础参数列表</h3><div class="cherry-table-container" data-sign="7aee6d2f46939ffd2eef9f410bebc773" data-lines="6">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>corpid</td><td>str</td><td>授权企业的corpid</td></tr><tr><td>agentid</td><td>int</td><td>应用的agentid，将以这个应用的身份调用<br>仅当调用<a href="#53367" rel="nofollow">上报异步任务结果</a>接口，且该次任务在接受请求时并没有接收到应用的agentid时，可能没有应用的身份，此时填写0即可</td></tr><tr><td>ability_id</td><td>str</td><td>程序使用的能力id</td></tr><tr><td>job_info</td><td>str</td><td>用于关联异步任务的任务信息，仅当调用<a href="#53367" rel="nofollow">上报异步任务结果</a>时必填，具体内容在接受到企微后台发起的请求时获取，参考<a href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-python" rel="nofollow">企微后台调用专区-Python版本-获取请求参数-Python</a>部分<br>调用其他接口时填写空串即可</td></tr></tbody></table></div><h3 id="%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B" data-sign="924c91014c91d9a0f8bc799a5242cabd" data-lines="2"><a class="anchor" href="#%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B"></a>调用接口示例</h3><p data-sign="9a08e5ac446b83010dff509ef8c21e84" data-type="p" data-lines="1">例如，希望调用<a href="#53341" rel="nofollow">获取会话记录</a>接口时，可以使用如下代码：</p><div data-sign="7c42cc668229bf7a8b915f47da00a9fe" data-type="codeBlock" data-lines="4">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">req <span class="token operator">=</span> <span class="token string">"{\"</span>cursor\<span class="token string">":\"</span><span class="token constant">RMTJID</span>\<span class="token string">",\"</span>token\<span class="token string">":\"</span><span class="token constant">NGEJKGOEGJKOEGNEOAGOEGOKEGHOEEEEE</span>\<span class="token string">",\"</span>limit\<span class="token string">":200}"</span></span>
<span class="code-line">res <span class="token operator">=</span> <span class="token function">ChatDataSDK</span><span class="token punctuation">(</span>corpid<span class="token punctuation">,</span> agentid<span class="token punctuation">,</span> ability_id<span class="token punctuation">,</span> job_info<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">sync_msg</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="37907628715522398f1076fbffd7a75c" data-type="p" data-lines="5">其中，<br>● <code>corpid</code>、<code>agentid</code>、<code>ability_id</code>、<code>job_info</code>为基础参数；<br>● <code>sync_msg</code>为接口名称，可以在接口对应的文档中查看；<br>● <code>req</code>为请求的包体以json的格式转化成str的结果；<br>● 当接口正常调用成功时，<code>res</code>即为回包的json的内容；当接口调用失败时，接口将抛出异常。</p><blockquote data-sign="f5560094132afc825d5f7b12630a7d72_1" data-lines="1">请注意，这里的调用成功/失败指的是发起请求的成功/失败，接口正常返回<code>res</code>时，内容的errcode仍可能不为0。</blockquote><h2 id="c%E7%89%88%E6%9C%AC" data-sign="3ca53bfdbd98726267815e46388a1fbc" data-lines="2"><a class="anchor" href="#c%E7%89%88%E6%9C%AC"></a>C++版本</h2><p data-sign="5e0d3e6d9cd3ada51fd8e3f97fe0f17a" data-type="p" data-lines="1">C++版本的sdk提供了一个调用函数，通过将请求接口名作为参数传入来区分调用哪个接口。调用时使用基础参数构造类的实例（也可以使用企微后台请求专区时生成的回调类的实例来构造），之后调用<code>Invoke</code>成员函数来请求企业微信后台的对应接口。</p><h3 id="%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8-3" data-sign="04d6f8750357a885f58230d66699a8b7" data-lines="2"><a class="anchor" href="#%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8-3"></a>基础参数列表</h3><div class="cherry-table-container" data-sign="1cd8a7ee0d2a24ce63f21cc582723b40" data-lines="6">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>corpid</td><td>string</td><td>授权企业的corpid</td></tr><tr><td>agentid</td><td>uint32_t</td><td>应用的agentid，将以这个应用的身份调用<br>仅当调用<a href="#53367" rel="nofollow">上报异步任务结果</a>接口，且该次任务在接受请求时并没有接收到应用的agentid时，可能没有应用的身份，此时填写0即可</td></tr><tr><td>ability_id</td><td>string</td><td>程序使用的能力id</td></tr><tr><td>job_info</td><td>string</td><td>用于关联异步任务的任务信息，仅当调用<a href="#53367" rel="nofollow">上报异步任务结果</a>时必填，具体内容在接受到企微后台发起的请求时获取，参考<a href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-cpp" rel="nofollow">企微后台调用专区-C++版本-获取请求参数-CPP</a>部分<br>调用其他接口时填写空串即可</td></tr></tbody></table></div><h3 id="%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B-3" data-sign="a3f9b1594faf3b64464be3df93784035" data-lines="2"><a class="anchor" href="#%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B-3"></a>调用接口示例</h3><p data-sign="9a08e5ac446b83010dff509ef8c21e84" data-type="p" data-lines="1">例如，希望调用<a href="#53341" rel="nofollow">获取会话记录</a>接口时，可以使用如下代码：</p><div data-sign="de978270065137745107871d5675b6e2" data-type="codeBlock" data-lines="4">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">std<span class="token operator">:</span><span class="token operator">:</span>string req <span class="token operator">=</span> <span class="token string">"{\"</span>cursor\<span class="token string">":\"</span><span class="token constant">RMTJID</span>\<span class="token string">",\"</span>token\<span class="token string">":\"</span><span class="token constant">NGEJKGOEGJKOEGNEOAGOEGOKEGHOEEEEE</span>\<span class="token string">",\"</span>limit\<span class="token string">":200}"</span><span class="token punctuation">;</span></span>
<span class="code-line">int ret <span class="token operator">=</span> <span class="token function">SpecSdk</span><span class="token punctuation">(</span>corpid<span class="token punctuation">,</span> agentid<span class="token punctuation">,</span> ability_id<span class="token punctuation">,</span> job_info<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token string">"sync_msg"</span><span class="token punctuation">,</span> req<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rsp<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="9e98875e95906dc7e467eedc1a49980b" data-type="p" data-lines="6">其中，<br>● <code>corpid</code>、<code>agentid</code>、<code>ability_id</code>、<code>job_info</code>为基础参数；<br>● <code>sync_msg</code>为接口名称，可以在接口对应的文档中查看；<br>● <code>req</code>为请求的包体以json的格式转化成str的结果；<br>● <code>rsp</code>为接口正常调用成功时，企微后台的回包内容；<br>● <code>ret</code>为网络和请求协议层面的返回值，为0时表示接口正常调用成功。</p><blockquote data-sign="aa4959546f1be690cad3553a76a28916_1" data-lines="1">请注意，<code>ret</code>为0时表示没有网络或请求协议层面的失败,调用方需继续检查rsp中的errcode字段。</blockquote><p data-sign="247d41b8e805ece13a5f603e930fae60" data-type="p" data-lines="1">也可以使用回调类的实例进行构造：</p><div data-sign="7c9bc8cf49d4b0a5331b2570db297238" data-type="codeBlock" data-lines="4">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token comment">// SpecCallbackSDK callback_sdk;</span></span>
<span class="code-line">int ret <span class="token operator">=</span> <span class="token function">SpecSdk</span><span class="token punctuation">(</span>callback_sdk<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">Invoke</span><span class="token punctuation">(</span><span class="token string">"sync_msg"</span><span class="token punctuation">,</span> req<span class="token punctuation">,</span> <span class="token operator">&amp;</span>rsp<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="d069e81693eb87c876a27181adc0530d" data-type="p" data-lines="2">其中，<br>● <code>callback_sdk</code>为企微后台调用专区时生成的回调类的实例，<strong>用于构造时要求请求解析成功，即<code>callback_sdk.IsOk() == true</code></strong>。</p><h2 id="java%E7%89%88%E6%9C%AC" data-sign="a67f51aa30d785659b778730d6e17846" data-lines="2"><a class="anchor" href="#java%E7%89%88%E6%9C%AC"></a>Java版本</h2><h3 id="%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8-4" data-sign="3a172fb8ac2c51d2121f7903fa264fd4" data-lines="2"><a class="anchor" href="#%E5%9F%BA%E7%A1%80%E5%8F%82%E6%95%B0%E5%88%97%E8%A1%A8-4"></a>基础参数列表</h3><div class="cherry-table-container" data-sign="274517548ed22f5758f0358384d97f63" data-lines="6">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>corpId</td><td>String</td><td>授权企业的corpid</td></tr><tr><td>agentId</td><td>long</td><td>应用的agentid这个应用的身份调用<br>仅当调用<a href="#53367" rel="nofollow">上报异步任务结果</a>接口，且该次任务在接受请求时并没有接收到应用的agentid时，可能没有应用的身份，此时填写0即可</td></tr><tr><td>abilityId</td><td>String</td><td>程序使用的能力id</td></tr><tr><td>jobInfo</td><td>String</td><td>用于关联异步任务的任务信息，仅当调用<a href="#53367" rel="nofollow">上报异步任务结果</a>时必填，具体内容在接受到企微后台发起的请求时获取，参考<a href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-Java" rel="nofollow">企微后台调用专区-Java版本-获取请求参数-Java</a>部分<br>调用其他接口时填写空串即可</td></tr></tbody></table></div><h3 id="%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B-4" data-sign="1c4787c3664cf4a3654420bf13a7228f" data-lines="2"><a class="anchor" href="#%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%A4%BA%E4%BE%8B-4"></a>调用接口示例</h3><p data-sign="9a08e5ac446b83010dff509ef8c21e84" data-type="p" data-lines="1">例如，希望调用<a href="#53341" rel="nofollow">获取会话记录</a>接口时，可以使用如下代码：</p><div data-sign="79ad8195df3e7b23c1400182ae9d47f6" data-type="codeBlock" data-lines="6">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">SpecSDK</span> sdk <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpecSDK</span><span class="token punctuation">(</span>corpId<span class="token punctuation">,</span> agentId<span class="token punctuation">,</span> abilityId<span class="token punctuation">,</span> jobInfo<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token class-name"><span class="token namespace">sdk<span class="token punctuation">.</span></span>SetRequest</span><span class="token punctuation">(</span>req<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">sdk<span class="token punctuation">.</span></span>Invoke</span><span class="token punctuation">(</span><span class="token string">"sync_msg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token class-name">String</span> rsp <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">sdk<span class="token punctuation">.</span></span>GetResponse</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="eca3961943048270484bd14b58071045" data-type="p" data-lines="6">其中，<br>● <code>corpId</code>、<code>agentId</code>、<code>abilityId</code>、<code>jobInfo</code>为基础参数；<br>● <code>sync_msg</code>为接口名称，可以在接口对应的文档中查看；<br>● <code>req</code>为请求的包体以json的格式转化成str的结果；<br>● <code>rsp</code>为接口正常调用成功时，企微后台的回包内容；<br>● <code>ret</code>为网络和请求协议层面的返回值，为0时表示接口正常调用成功。</p><blockquote data-sign="aa4959546f1be690cad3553a76a28916_1" data-lines="1">请注意，<code>ret</code>为0时表示没有网络或请求协议层面的失败,调用方需继续检查rsp中的errcode字段。</blockquote><p data-sign="247d41b8e805ece13a5f603e930fae60" data-type="p" data-lines="1">也可以使用回调类的实例进行构造：</p><div data-sign="64245abcf9fd5a48a30b354c31733a58" data-type="codeBlock" data-lines="9">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">SpecCallbackSDK</span> callback <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SpecCallbackSDK</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> reqHeaders<span class="token punctuation">,</span> reqBody<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token class-name"><span class="token namespace">callback<span class="token punctuation">.</span></span>IsOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">	<span class="token class-name">String</span> rspContent <span class="token operator">=</span> <span class="token class-name">HandleCallback</span><span class="token punctuation">(</span>callback<span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// 自定义的处理函数</span></span>
<span class="code-line">	<span class="token class-name"><span class="token namespace">callback<span class="token punctuation">.</span></span>BuildResponseHeaderBody</span><span class="token punctuation">(</span>responseContent<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> rspHeaders <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">callback<span class="token punctuation">.</span></span>GetResponseHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token class-name">String</span> rspBody <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">callback<span class="token punctuation">.</span></span>GetResponseBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="75903b84776d22a823bfa4553e0dfe78" data-type="p" data-lines="3">其中，<br>● <code>SpecCallbackSDK</code>为企微后台调用专区时生成的回调类的实例，<strong>用于构造时要求请求解析成功，即<code>callback.IsOk() == true</code></strong>。<br>● HandleCallback为用户自定义的回调处理函数，返回String类型的回包数据</p><h1 id="%E4%BC%81%E5%BE%AE%E5%90%8E%E5%8F%B0%E8%B0%83%E7%94%A8%E4%B8%93%E5%8C%BA" data-sign="79a2dbaab7c4c89e7c3b241b8f50433c" data-lines="2"><a class="anchor" href="#%E4%BC%81%E5%BE%AE%E5%90%8E%E5%8F%B0%E8%B0%83%E7%94%A8%E4%B8%93%E5%8C%BA"></a>企微后台调用专区</h1><p data-sign="8d1d37b271945986928549929fac5698" data-type="p" data-lines="1">用户需要自行监听8080端口（IP使用0.0.0.0）接收企微后台调用专区的请求；收到请求后需要使用本SDK对请求进行验签和解密，处理完成后的回包也需要用本SDK进行加密和签名。</p><h2 id="python%E7%89%88%E6%9C%AC-3" data-sign="d4e6d0f7a9426bb6bdc3f6025b7be77f" data-lines="2"><a class="anchor" href="#python%E7%89%88%E6%9C%AC-3"></a>Python版本</h2><p data-sign="d3cb32dcc4ee426bd05cc8e52303492b" data-type="p" data-lines="2"><span id="python_sdk_verify"></span></p><h3 id="%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86" data-sign="b1b584ee194f2e75ea3446566fb9a52f" data-lines="1"><a class="anchor" href="#%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86"></a>验签和解密</h3><p data-sign="561ea81bc9cea64ea8c3fb507af8be02" data-type="p" data-lines="1">收到请求后，需要将请求的header和body放到<code>WWToSpecHTTPReqDecoder</code>中去验签和解密，示例如下：</p><div data-sign="2168d581fbdc8a0ff02d79c55d9f8b88" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">req <span class="token operator">=</span> <span class="token function">WWToSpecHTTPReqDecoder</span><span class="token punctuation">(</span>headers<span class="token punctuation">,</span> post_data<span class="token punctuation">)</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f85b36721a126a4681a19f0548aca4ed" data-type="p" data-lines="3">其中，<br>● <code>headers</code>为list格式，示例： [("Accept","<em>/</em>"),("Content-Type","application/json")]；<br>● <code>post_data</code>为str格式，是请求中的post body数据。</p><p data-sign="e25748b87fec3eed553b67c873b896ee" data-type="p" data-lines="2"><code>WWToSpecHTTPReqDecoder</code>构造时会对<code>headers</code>进行签名校验，并解密<code>post_data</code>，如果签名/解密失败会抛出异常，<strong>此时请使用<code>get_exception_header()</code>接口获取回包的header</strong>，参考<a href="#%E6%9E%84%E9%80%A0header" rel="nofollow">回包-构造header</a>部分。</p><h3 id="%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-python" data-sign="aee91b5c8016b89ffb97b86625f6d715" data-lines="2"><a class="anchor" href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-python"></a>获取请求参数-Python</h3><p data-sign="687538edb180438e86d9cb07e5b91576" data-type="p" data-lines="1"><code>WWToSpecHTTPReqDecoder</code>提供如下成员函数获取请求参数：</p><div data-sign="cd569149e6ee4520d9774f2a2c1b4635" data-type="codeBlock" data-lines="25">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">    def <span class="token function">get_corpid</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span></span>
<span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>corpid</span>
<span class="code-line"></span>
<span class="code-line">    def <span class="token function">get_agentid</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span></span>
<span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>agentid</span>
<span class="code-line"></span>
<span class="code-line">    def <span class="token function">get_data</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span></span>
<span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>data</span>
<span class="code-line"></span>
<span class="code-line">    def <span class="token function">get_call_type</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span></span>
<span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>call_type</span>
<span class="code-line"></span>
<span class="code-line">    def <span class="token function">get_is_async</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span></span>
<span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>is_async</span>
<span class="code-line"></span>
<span class="code-line">    def <span class="token function">get_job_info</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span></span>
<span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>job_info</span>
<span class="code-line"></span>
<span class="code-line">    def <span class="token function">get_ability_id</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span></span>
<span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>ability_id</span>
<span class="code-line">		</span>
<span class="code-line">    def <span class="token function">get_notify_id</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token operator">:</span></span>
<span class="code-line">        <span class="token keyword">return</span> self<span class="token punctuation">.</span>notify_id</span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="0b2ba392965bece12081a03a2f31f405" data-type="p" data-lines="1">参数说明如下：</p><div class="cherry-table-container" data-sign="52332edaa763a0c7bd6e211884a5562b" data-lines="9">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>corpid</td><td>str</td><td>企业corpid</td></tr><tr><td>agentid</td><td>int</td><td>应用agentid</td></tr><tr><td>call_type</td><td>int</td><td>企业微信请求专区类型，<br>1：企业/服务商通过<a href="#53337" rel="nofollow">应用调用程序</a>接口或其他方式对专区发起请求<br>2：企业微信后台对专区发起回调</td></tr><tr><td>data</td><td>str</td><td>json字符串，具体为应用调用专区时传入的request字段</td></tr><tr><td>is_async</td><td>bool</td><td>是否是异步调用，仅当<code>call_type</code>参数为1时有效</td></tr><tr><td>job_info</td><td>str</td><td>任务信息，用于关联异步任务，仅当<code>call_type</code>参数为1，且<code>is_async</code>参数为<code>true</code>时有效</td></tr><tr><td>alibity_id</td><td>str</td><td>能力id</td></tr></tbody></table></div><h3 id="%E5%9B%9E%E5%8C%85" data-sign="c84d8182dfebc9b86755833191be7104" data-lines="2"><a class="anchor" href="#%E5%9B%9E%E5%8C%85"></a>回包</h3><p data-sign="57e363fa2773eb0875abfdda61127246" data-type="p" data-lines="1">回包时可通过<code>WWToSpecHTTPRspConstructor</code>类进行签名和加密，构造示例代码如下：</p><div data-sign="a46f102e8cc756325ad09800bd745215" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">rsp <span class="token operator">=</span> <span class="token function">WWToSpecHTTPRspConstructor</span><span class="token punctuation">(</span>rsp_data<span class="token punctuation">)</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="93626a6b44e1028675949edfd47aefc4" data-type="p" data-lines="4">其中，<br>● <code>rsp_data</code>为回包的内容；<br>● 构造成功时，<code>rsp</code>为可用于获取请求header和body的类，构造失败时，将抛出异常。<br>专区程序通过<code>WWToSpecHTTPRspConstructor</code>类获取到对应的header和加密回包内容后，即可用其进行回包。</p><h4 id="%E6%9E%84%E9%80%A0header" data-sign="e7ca82b686eba139f7c4f10a4ef59661" data-lines="2"><a class="anchor" href="#%E6%9E%84%E9%80%A0header"></a>构造header</h4><p data-sign="8891f5a234fc664011cb98b74965dfa3" data-type="p" data-lines="1">调用 <code>get_normal_header()</code> 和 <code>get_exception_header()</code> 可以拿到<a href="#python_sdk_verify" rel="nofollow">验签和解密</a>正常返回/抛出异常的情况分别对应的回包header：</p><div data-sign="36b5953dff465bca292e76e6abf3b81c" data-type="codeBlock" data-lines="4">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">header <span class="token operator">=</span> rsp<span class="token punctuation">.</span><span class="token function">get_normal_header</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="code-line">header <span class="token operator">=</span> rsp<span class="token punctuation">.</span><span class="token function">get_exception_header</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="feb70bc0a20550177bd84056c557d415" data-type="p" data-lines="2">其中，<br>● <code>header</code>为生成的对应header，为dict格式，用于回包</p><h4 id="%E5%8A%A0%E5%AF%86body" data-sign="7b211e7365829755292f24ceaa28a6d5" data-lines="2"><a class="anchor" href="#%E5%8A%A0%E5%AF%86body"></a>加密body</h4><p data-sign="bc030c0a520eb8908452eee244972d34" data-type="p" data-lines="1">调用<code>get_encoded_body()</code>可以获取加密后的回包内容：</p><div data-sign="022f9bd20e6a806dc5b1578c3d33810a" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">encoded_body <span class="token operator">=</span> rsp<span class="token punctuation">.</span><span class="token function">get_encoded_body</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="b1eff84b22ab7039393d69303525bd3e" data-type="p" data-lines="2">其中，<br>● <code>encoded_body</code>为加密后的回包内容，为str格式，用于回包</p><h2 id="c%E7%89%88%E6%9C%AC-3" data-sign="82a52d5942c9de1c6bc5acec57dd59e4" data-lines="2"><a class="anchor" href="#c%E7%89%88%E6%9C%AC-3"></a>C++版本</h2><h3 id="%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86-3" data-sign="c99190b45d41bf94b1875b62d5f0e893" data-lines="2"><a class="anchor" href="#%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86-3"></a>验签和解密</h3><p data-sign="bf72e1156b9b44b7ff14a3fa07345759" data-type="p" data-lines="1">收到请求后，需要将请求的header和body放到<code>SpecCallbackSDK</code>中去验签和解密，示例如下：</p><div data-sign="6c7c52eb0161010c9c8c19807e90889f" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">SpecCallbackSDK <span class="token function">callback_sdk</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> post_data<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="b8e2ebfef9eb1b481ca872e4d5de8cf5" data-type="p" data-lines="4">其中，<br>● <code>method</code>为string格式，表示请求的方法，内容为<code>GET</code>或<code>POST</code>；<br>● <code>headers</code>为map格式，示例： {{"Accept","<em>/</em>"}, {"Content-Type","application/json"}}；<br>● <code>post_data</code>为string格式，是请求中的post body数据。</p><blockquote data-sign="c2d1c7d5a19368eb0abdaf785bba7643_1" data-lines="1">注意，SpecCallbackSDK仅持有headers和post_data的引用，因此需保证headers和body的生存期比SpecCallbackSDK长</blockquote><p data-sign="2afc5d1080a92d20e7ef650eca1b7c7d" data-type="p" data-lines="1">构造实例后，通过<code>IsOK()</code>成员函数判断解析是否成功，示例如下：</p><div data-sign="2ac9b1fae8f435828e3035e6b6da02b2" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">bool decrypt_success <span class="token operator">=</span> callback_sdk<span class="token punctuation">.</span><span class="token function">IsOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="57e96f8acf2e8eba2db8de9448b6fd84" data-type="p" data-lines="2">其中，<br>● <code>decrypt_success</code>为<code>true</code>时，表示签名校验和解密成功，为<code>false</code>时表示失败。</p><h3 id="%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-cpp" data-sign="0b9c859f5ff5de45492472e9406fcc8f" data-lines="2"><a class="anchor" href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-cpp"></a>获取请求参数-CPP</h3><p data-sign="c1495d3b4db394d9ff56f9db3d060989" data-type="p" data-lines="1"><code>SpecCallbackSDK</code>提供如下成员函数获取请求参数：</p><div data-sign="cca87ce2b43e9a0956734260b014802d" data-type="codeBlock" data-lines="62">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token comment">/*</span></span>
<span class="code-line"><span class="token comment">* @description: 获取请求的企业</span></span>
<span class="code-line"><span class="token comment">* @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment">* @return:      corpid</span></span>
<span class="code-line"><span class="token comment">* */</span></span>
<span class="code-line"><span class="token keyword">const</span> std<span class="token operator">:</span><span class="token operator">:</span>string <span class="token operator">&amp;</span><span class="token function">GetCorpId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/*</span></span>
<span class="code-line"><span class="token comment">* @description: 获取请求的应用</span></span>
<span class="code-line"><span class="token comment">* @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment">* @return:      agentid</span></span>
<span class="code-line"><span class="token comment">* */</span></span>
<span class="code-line">uint32_t <span class="token function">GetAgentId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/*</span></span>
<span class="code-line"><span class="token comment">* @description: 获取请求的类型</span></span>
<span class="code-line"><span class="token comment">* @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment">* @return:      1 - 来自[应用调用专区]的请求</span></span>
<span class="code-line"><span class="token comment">*               2 - 来自企业微信的回调事件</span></span>
<span class="code-line"><span class="token comment">* */</span></span>
<span class="code-line">uint32_t <span class="token function">GetCallType</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/*</span></span>
<span class="code-line"><span class="token comment">* @description: 获取请求数据</span></span>
<span class="code-line"><span class="token comment">* @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment">* @return:      请求数据,根据call_type可能是:</span></span>
<span class="code-line"><span class="token comment">*               - 企业微信回调事件</span></span>
<span class="code-line"><span class="token comment">*               - [应用调用专区]接口中的request_data</span></span>
<span class="code-line"><span class="token comment">* */</span></span>
<span class="code-line"><span class="token keyword">const</span> std<span class="token operator">:</span><span class="token operator">:</span>string <span class="token operator">&amp;</span><span class="token function">GetData</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/*</span></span>
<span class="code-line"><span class="token comment">* @description: 是否异步请求</span></span>
<span class="code-line"><span class="token comment">* @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment">* @return:      </span></span>
<span class="code-line"><span class="token comment">* */</span></span>
<span class="code-line">bool <span class="token function">GetIsAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/*</span></span>
<span class="code-line"><span class="token comment">* @description: 获取请求的job_info,</span></span>
<span class="code-line"><span class="token comment">* @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment">* @return:      job_info,无需理解内容,</span></span>
<span class="code-line"><span class="token comment">*               在同一个请求上下文中使用SpecSDK的时候传入</span></span>
<span class="code-line"><span class="token comment">* */</span></span>
<span class="code-line"><span class="token keyword">const</span> std<span class="token operator">:</span><span class="token operator">:</span>string <span class="token operator">&amp;</span><span class="token function">GetJobInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/*</span></span>
<span class="code-line"><span class="token comment">* @description: 获取请求的ability_id,[应用调用专区]接口时指定</span></span>
<span class="code-line"><span class="token comment">* @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment">* @return:      ability_id</span></span>
<span class="code-line"><span class="token comment">* */</span></span>
<span class="code-line"><span class="token keyword">const</span> std<span class="token operator">:</span><span class="token operator">:</span>string <span class="token operator">&amp;</span><span class="token function">GetAbilityId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/*</span></span>
<span class="code-line"><span class="token comment">* @description: 获取请求的notify_id,用于[应用同步调用专区程序]接口</span></span>
<span class="code-line"><span class="token comment">* @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment">* @return:      ability_id</span></span>
<span class="code-line"><span class="token comment">* */</span></span>
<span class="code-line"><span class="token keyword">const</span> std<span class="token operator">:</span><span class="token operator">:</span>string <span class="token operator">&amp;</span><span class="token function">GetNotifyId</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">const</span><span class="token punctuation">;</span></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h3 id="%E5%9B%9E%E5%8C%85-3" data-sign="cef1d37238c8185cb3ec02c954d453bb" data-lines="2"><a class="anchor" href="#%E5%9B%9E%E5%8C%85-3"></a>回包</h3><p data-sign="30059b081401a466b0f5afdf0e1a65bf" data-type="p" data-lines="1">回包时，可以通过调用接受请求时构造的<code>SpecCallbakSDK</code>类的实例的<code>BuildResponseHeaderBody</code>函数获取回包所需的header和加密回包内容，示例如下：</p><div data-sign="824f79a5d83b948d94e2b841fd0b172c" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">callback_sdk<span class="token punctuation">.</span><span class="token function">BuildResponseHeaderBody</span><span class="token punctuation">(</span>rsp<span class="token punctuation">,</span> <span class="token operator">&amp;</span>headers<span class="token punctuation">,</span> <span class="token operator">&amp;</span>encrypted_body<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="992277634aaf937001b9a830d7db3778" data-type="p" data-lines="4">其中，<br>● <code>rsp</code>为string格式，表示希望回包的body内容，当解析失败（即<code>callback_sdk.IsOk() == false</code>时）传入空串即可；<br>● <code>headers</code>为map格式，包含回包所需要的headers；<br>● <code>encrypted_body</code>为string格式，包含加密后的<code>rsp</code>字段。</p><h2 id="java%E7%89%88%E6%9C%AC-3" data-sign="17609279d78ff485e94e7eb8e041a7fc" data-lines="2"><a class="anchor" href="#java%E7%89%88%E6%9C%AC-3"></a>Java版本</h2><h3 id="%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86-4" data-sign="f2cc6955f8b762f1475f961b6ea7fb19" data-lines="2"><a class="anchor" href="#%E9%AA%8C%E7%AD%BE%E5%92%8C%E8%A7%A3%E5%AF%86-4"></a>验签和解密</h3><p data-sign="bf72e1156b9b44b7ff14a3fa07345759" data-type="p" data-lines="1">收到请求后，需要将请求的header和body放到<code>SpecCallbackSDK</code>中去验签和解密，示例如下：</p><div data-sign="d2fb34b6c6e8047c315a5dd8f9615fed" data-type="codeBlock" data-lines="3">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">SpecCallbackSDK</span> <span class="token function">callbackSdk</span><span class="token punctuation">(</span>method<span class="token punctuation">,</span> headers<span class="token punctuation">,</span> postData<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="1b034935a6c4ac3355faad6be6d4a1b4" data-type="p" data-lines="4">其中，<br>● <code>method</code>为String格式，表示请求的方法，内容为<code>GET</code>或<code>POST</code>；<br>● <code>headers</code>为Map&lt;String, String&gt;格式，示例： {{"Accept","<em>/</em>"}, {"Content-Type","application/json"}}；<br>● <code>post_data</code>为String格式，是请求中的post body数据。</p><p data-sign="2afc5d1080a92d20e7ef650eca1b7c7d" data-type="p" data-lines="1">构造实例后，通过<code>IsOK()</code>成员函数判断解析是否成功，示例如下：</p><div data-sign="278b8c077b3c172be34784931d2fee8a" data-type="codeBlock" data-lines="3">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line">bool decryptSuccess <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">callbackSdk<span class="token punctuation">.</span></span>IsOk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="c464a098890e59a956af60c211017479" data-type="p" data-lines="2">其中，<br>● <code>decryptSuccess</code>为<code>true</code>时，表示签名校验和解密成功，为<code>false</code>时表示失败。</p><h3 id="%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-java" data-sign="c0ac502bcbf96761888aa3bf1ff41745" data-lines="2"><a class="anchor" href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E5%8F%82%E6%95%B0-java"></a>获取请求参数-Java</h3><p data-sign="c1495d3b4db394d9ff56f9db3d060989" data-type="p" data-lines="1"><code>SpecCallbackSDK</code>提供如下成员函数获取请求参数：</p><div data-sign="ecfd606d2bafa77980f8bae5efdaf701" data-type="codeBlock" data-lines="61">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token comment">/**</span></span>
<span class="code-line"><span class="token comment"> * @description: 获取请求的企业</span></span>
<span class="code-line"><span class="token comment"> * @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment"> * @return:      corpid</span></span>
<span class="code-line"><span class="token comment"> * */</span></span>
<span class="code-line"><span class="token keyword">public</span> String <span class="token function">GetCorpId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">	</span>
<span class="code-line"><span class="token comment">/**</span></span>
<span class="code-line"><span class="token comment"> * @description: 获取请求的应用</span></span>
<span class="code-line"><span class="token comment"> * @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment"> * @return:      agentid</span></span>
<span class="code-line"><span class="token comment"> * */</span></span>
<span class="code-line"><span class="token keyword">public</span> long <span class="token function">GetAgentId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/**</span></span>
<span class="code-line"><span class="token comment"> * @description: 获取请求的类型</span></span>
<span class="code-line"><span class="token comment"> * @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment"> * @return:      1 - 来自[应用调用专区]的请求</span></span>
<span class="code-line"><span class="token comment"> *               2 - 来自企业微信的回调事件</span></span>
<span class="code-line"><span class="token comment"> * */</span></span>
<span class="code-line"><span class="token keyword">public</span> long <span class="token function">GetCallType</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/**</span></span>
<span class="code-line"><span class="token comment"> * @description: 获取请求数据</span></span>
<span class="code-line"><span class="token comment"> * @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment"> * @return:      请求数据,根据call_type可能是:</span></span>
<span class="code-line"><span class="token comment"> *               - 企业微信回调事件</span></span>
<span class="code-line"><span class="token comment"> *               - [应用调用专区]接口中的request_data</span></span>
<span class="code-line"><span class="token comment"> * */</span></span>
<span class="code-line"><span class="token keyword">public</span> String <span class="token function">GetData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/**</span></span>
<span class="code-line"><span class="token comment"> * @description: 是否异步请求</span></span>
<span class="code-line"><span class="token comment"> * @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment"> * @return:      是否异步请求</span></span>
<span class="code-line"><span class="token comment"> * */</span></span>
<span class="code-line"><span class="token keyword">public</span> boolean <span class="token function">GetIsAsync</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/**</span></span>
<span class="code-line"><span class="token comment"> * @description: 获取请求的job_info,</span></span>
<span class="code-line"><span class="token comment"> * @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment"> * @return:      job_info,无需理解内容,</span></span>
<span class="code-line"><span class="token comment"> *               在同一个请求上下文中使用SpecSDK的时候传入</span></span>
<span class="code-line"><span class="token comment"> * */</span></span>
<span class="code-line"><span class="token keyword">public</span> String <span class="token function">GetJobInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/**</span></span>
<span class="code-line"><span class="token comment"> * @description: 获取请求的ability_id,[应用调用专区]接口时指定</span></span>
<span class="code-line"><span class="token comment"> * @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment"> * @return:      ability_id</span></span>
<span class="code-line"><span class="token comment"> * */</span></span>
<span class="code-line"><span class="token keyword">public</span> String <span class="token function">GetAbilityId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">/**</span></span>
<span class="code-line"><span class="token comment"> * @description: 获取请求的notify_id,用于[应用同步调用专区程序]接口</span></span>
<span class="code-line"><span class="token comment"> * @require:     仅当IsOk() == true可调用</span></span>
<span class="code-line"><span class="token comment"> * @return:      notify_id</span></span>
<span class="code-line"><span class="token comment"> * */</span></span>
<span class="code-line"><span class="token keyword">public</span> String <span class="token function">GetNotifyId</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h3 id="%E5%9B%9E%E5%8C%85-4" data-sign="997349a9117b9604b55b53640f655ba6" data-lines="2"><a class="anchor" href="#%E5%9B%9E%E5%8C%85-4"></a>回包</h3><p data-sign="30059b081401a466b0f5afdf0e1a65bf" data-type="p" data-lines="1">回包时，可以通过调用接受请求时构造的<code>SpecCallbakSDK</code>类的实例的<code>BuildResponseHeaderBody</code>函数获取回包所需的header和加密回包内容，示例如下：</p><div data-sign="8e6d680d07167029aed580da37cb73c1" data-type="codeBlock" data-lines="5">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name"><span class="token namespace">callbackSdk<span class="token punctuation">.</span></span>BuildResponseHeaderBody</span><span class="token punctuation">(</span>responseContent<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token class-name">Map</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">,</span> <span class="token class-name">String</span><span class="token punctuation">&gt;</span></span> rspHeaders <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">callbackSdk<span class="token punctuation">.</span></span>GetResponseHeaders</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token class-name">String</span> rspBody <span class="token operator">=</span> <span class="token class-name"><span class="token namespace">callbackSdk<span class="token punctuation">.</span></span>GetResponseBody</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="1cb9acef3ebd4150cbd854d29707b8f1" data-type="p" data-lines="4">其中，<br>● <code>responseContent</code>为String格式，表示希望回包的body内容，当解析失败（即<code>callbackSdk.IsOk() == false</code>时）传入空串即可；<br>● <code>rspHeaders</code>为Map&lt;String, String&gt;格式，包含回包所需要的headers；<br>● <code>rspBody</code>为String格式，是加密后的<code>responseContent</code>字段。</p><h1 id="%E4%B8%93%E5%8C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0" data-sign="907bc9780e6f3b94efc2ecfd61c35162" data-lines="2"><a class="anchor" href="#%E4%B8%93%E5%8C%BA%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%97%A5%E5%BF%97%E6%89%93%E5%8D%B0"></a>专区程序的日志打印</h1><p data-sign="d92d1834a6f3a554271e7296ff71b76f" data-type="p" data-lines="1">在专区的程序与模型可以调用SDK接口打印日志，日志会被自动收集与汇总，开发者可在管理端「数据与智能专区 - 日志查询」中搜索日志。</p><blockquote data-sign="3380539f75825c239bc4eb77204c422a_1" data-lines="1">请更新到最新的SDK，才能调用SDK接口打印日志。<br>每个程序每小时输出的日志大小不能超过1G，该小时内超过1G后的新增日志将被丢弃。</blockquote><p data-sign="e90a545bd68aa12eb9af6d424dd4b257" data-type="p" data-lines="2"><img src="images/100057/1e102b52.png" alt="enter image description here"></p><h2 id="%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%AF%B4%E6%98%8E" data-sign="34c25caa47ba470c2dae46bec9dd5ed6" data-lines="2"><a class="anchor" href="#%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F%E8%AF%B4%E6%98%8E"></a>日志格式说明</h2><p data-sign="f553bf8e5db6a69a9bbf4d81b856c55f" data-type="p" data-lines="4">格式：<br><code>&lt;{pid},{tid}&gt;,{datetime},{log_level},{req_id},{file_name},{line_no},{custom}</code><br>例如：<br><code>&lt;94,924&gt;,2024-07-12 18:22:42.795,INF0,c5497e88bce56877,democpp,6</code></p><div class="cherry-table-container" data-sign="0afed8006cc9746f39aeee8c1dd6eeab" data-lines="10">
        <table class="cherry-table"><thead><tr><th>字段</th><th>含义</th><th>备注</th></tr></thead><tbody><tr><td>pid</td><td>进程ID</td><td></td></tr><tr><td>tid</td><td>线程ID</td><td></td></tr><tr><td>datetime</td><td>时间</td><td>如 <code>2024-07-12 18:22:42.795</code></td></tr><tr><td>log_level</td><td>日志级别，详见<a href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%E8%AF%B4%E6%98%8E" rel="nofollow">日志级别说明</a></td><td><code>INFO</code>、<code>ERR</code>、<code>DBG</code></td></tr><tr><td>req_id</td><td>请求ID</td><td>由专区sdk生成，每次请求生成一个独立的req_id，方便定位某次请求的日志</td></tr><tr><td>file_name</td><td>文件名</td><td></td></tr><tr><td>line_no</td><td>行号</td><td></td></tr><tr><td>custom</td><td>自定义字段</td><td>长度限制<code>128</code>字节，超出的部分截断。<br>调用sdk日志接口传入</td></tr></tbody></table></div><blockquote data-sign="4eae8f5d0595208c9a94e89a426e1c8d_1" data-lines="1">除了 <code>custom</code> ，其他字段由sdk提供的日志接口内部自动生成</blockquote><h2 id="%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%E8%AF%B4%E6%98%8E" data-sign="4ac0954aa174f9e0ae84e7015a011f6d" data-lines="2"><a class="anchor" href="#%E6%97%A5%E5%BF%97%E7%BA%A7%E5%88%AB%E8%AF%B4%E6%98%8E"></a>日志级别说明</h2><p data-sign="a8d55fd92fdc2a99ce052f4e576e147b" data-type="p" data-lines="1">在调用sdk打印日志时，开发者可以根据每条日志的重要程度，定义合适的log_level，例如用于调试的日志可以设置为<code>DBG</code>。默认情况下，<code>DBG</code>级别日志仅用于开发者在本地调试时输出到stdout，部署在专区的程序，仅<code>INFO</code>、<code>ERR</code>级别的日志会被收集。开发者可以通过应用调用<a href="#54963" rel="nofollow">设置日志打印级别接口</a>修改专区程序的日志级别。</p><h2 id="python%E7%89%88%E6%9C%AC-4" data-sign="4fbd8a884edc213855e839813c29d74b" data-lines="2"><a class="anchor" href="#python%E7%89%88%E6%9C%AC-4"></a>Python版本</h2><div data-sign="32c7355f8dc2d60cfb1c2b8f816dfbfd" data-type="codeBlock" data-lines="9">
      <pre class="language-python"><code class="language-python wrap"><span class="code-line"><span class="token keyword">from</span> wwspecapisdk <span class="token keyword">import</span> spec_log_info<span class="token punctuation">,</span> spec_log_error<span class="token punctuation">,</span> spec_log_debug</span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment"># 支持类似 print 传入可变参数</span></span>
<span class="code-line">spec_log_info<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># INFO级别</span></span>
<span class="code-line">spec_log_error<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># ERROR级别</span></span>
<span class="code-line">spec_log_debug<span class="token punctuation">(</span><span class="token punctuation">)</span>  <span class="token comment"># DEBUG 级别</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h2 id="c%E7%89%88%E6%9C%AC-4" data-sign="3fd664c67d95de6b6376e3ef501d24ef" data-lines="2"><a class="anchor" href="#c%E7%89%88%E6%9C%AC-4"></a>C++版本</h2><div data-sign="11d2914922f9441f423c6db79e72d808" data-type="codeBlock" data-lines="7">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">#include <span class="token string">"cpp_sdk.h"</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token constant">WWSPEC_LOG_INFO</span><span class="token punctuation">(</span><span class="token string">"result=%d,error=%s"</span><span class="token punctuation">,</span> ret<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">//INFO级别</span></span>
<span class="code-line"><span class="token constant">WWSPEC_LOG_ERROR</span><span class="token punctuation">(</span><span class="token string">"result=%d,error=%s"</span><span class="token punctuation">,</span> ret<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//ERROR级别</span></span>
<span class="code-line"><span class="token constant">WWSPEC_LOG_DEBUG</span><span class="token punctuation">(</span><span class="token string">"result=%d,error=%s"</span><span class="token punctuation">,</span> ret<span class="token punctuation">,</span> err<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//DEBUG级别</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h2 id="java%E7%89%88%E6%9C%AC-4" data-sign="469b9d2fae7a0f60b0268d8e3547051f" data-lines="2"><a class="anchor" href="#java%E7%89%88%E6%9C%AC-4"></a>Java版本</h2><div data-sign="1a5abd339b180409675ab77e61c2f235" data-type="codeBlock" data-lines="8">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>tencent<span class="token punctuation">.</span>wework<span class="token punctuation">.</span></span><span class="token class-name">SpecUtil</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">// 支持可长参数，默认String类型</span></span>
<span class="code-line"><span class="token class-name">SpecUtil<span class="token punctuation">.</span>WWSpecLogInfo</span><span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// INFO级别</span></span>
<span class="code-line"><span class="token class-name">SpecUtil<span class="token punctuation">.</span>WWSpecLogError</span><span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// ERROR级别</span></span>
<span class="code-line"><span class="token class-name">SpecUtil<span class="token punctuation">.</span>WWSpecLogDebug</span><span class="token punctuation">(</span><span class="token string">"xxx"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  <span class="token comment">// DEBUG级别</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h1 id="%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E6%8C%87%E5%BC%95" data-sign="96ec4030e241a46fccd404947b875e84" data-lines="2"><a class="anchor" href="#%E6%9C%AC%E5%9C%B0%E8%B0%83%E8%AF%95%E6%8C%87%E5%BC%95"></a>本地调试指引</h1><p data-sign="1314b530daa07ccb0780d07e90c7e646" data-type="p" data-lines="1">详见 <a href="#54809" rel="nofollow">专区调试模式-调试说明</a></p></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>