<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>构造网页授权链接 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        构造网页授权链接
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2019/08/08</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><p data-sign="034b9e310c3b4389934a684c601638af" data-type="p" data-lines="1">如果企业需要在打开的网页里面携带用户的身份信息，第一步需要构造如下的链接来获取code参数：</p><div data-sign="72e11f910653ce4ba5df0d008f6d678e" data-type="codeBlock" data-lines="3">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>open<span class="token punctuation">.</span>weixin<span class="token punctuation">.</span>qq<span class="token punctuation">.</span>com<span class="token operator">/</span>connect<span class="token operator">/</span>oauth2<span class="token operator">/</span>authorize<span class="token operator">?</span>appid<span class="token operator">=</span><span class="token constant">CORPID</span><span class="token operator">&amp;</span>redirect_uri<span class="token operator">=</span><span class="token constant">REDIRECT_URI</span><span class="token operator">&amp;</span>response_type<span class="token operator">=</span>code<span class="token operator">&amp;</span>scope<span class="token operator">=</span>snsapi_base<span class="token operator">&amp;</span>state<span class="token operator">=</span><span class="token constant">STATE</span>#wechat_redirect</span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="2"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="5c54e2939318fd77cb599d3177040538" data-lines="8">
        <table class="cherry-table"><thead><tr><th>参数</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>appid</td><td>是</td><td>企业的CorpID</td></tr><tr><td>redirect_uri</td><td>是</td><td>授权后重定向的回调链接地址，<strong>请使用urlencode对链接进行处理</strong></td></tr><tr><td>response_type</td><td>是</td><td>返回类型，此时固定为：code</td></tr><tr><td>scope</td><td>是</td><td>应用授权作用域。企业自建应用固定填写：snsapi_base</td></tr><tr><td>state</td><td>否</td><td>重定向后会带上state参数，企业可以填写a-zA-Z0-9的参数值，长度不可超过128个字节</td></tr><tr><td>#wechat_redirect</td><td>是</td><td>终端使用此参数判断是否需要带上身份信息</td></tr></tbody></table></div><p data-sign="b258ad9d19069b5406b17c65d0b54028" data-type="p" data-lines="2">员工点击后，页面将跳转至 redirect_uri?code=CODE&amp;state=STATE，企业可根据code参数获得员工的userid。code长度最大为512字节。</p><p data-sign="297864cba95380cb8df98246287f4fd2" data-type="p" data-lines="2"><strong>示例：</strong></p><div data-sign="e5d21761b7536b12a25f1091139d836d" data-type="codeBlock" data-lines="14">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">假定当前</span>
<span class="code-line">企业CorpID：wxdd725338566d6ffe</span>
<span class="code-line">访问链接：http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>api<span class="token punctuation">.</span><span class="token number">3</span>dept<span class="token punctuation">.</span>com<span class="token operator">/</span>cgi<span class="token operator">-</span>bin<span class="token operator">/</span>query<span class="token operator">?</span>action<span class="token operator">=</span><span class="token keyword">get</span></span>
<span class="code-line"></span>
<span class="code-line">根据<span class="token constant">URL</span>规范，将上述参数分别进行UrlEncode，得到拼接的OAuth2链接为：</span>
<span class="code-line">https<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>open<span class="token punctuation">.</span>weixin<span class="token punctuation">.</span>qq<span class="token punctuation">.</span>com<span class="token operator">/</span>connect<span class="token operator">/</span>oauth2<span class="token operator">/</span>authorize<span class="token operator">?</span>appid<span class="token operator">=</span>wxdd725338566d6ffe<span class="token operator">&amp;</span>redirect_uri<span class="token operator">=</span>http<span class="token operator">%</span><span class="token number">3</span>a<span class="token operator">%</span><span class="token number">2</span>f<span class="token operator">%</span><span class="token number">2</span>fapi<span class="token punctuation">.</span><span class="token number">3</span>dept<span class="token punctuation">.</span>com<span class="token operator">%</span><span class="token number">2</span>fcgi<span class="token operator">-</span>bin<span class="token operator">%</span><span class="token number">2</span>fquery<span class="token operator">%</span><span class="token number">3</span>faction<span class="token operator">%</span><span class="token number">3</span>dget<span class="token operator">&amp;</span>response_type<span class="token operator">=</span>code<span class="token operator">&amp;</span>scope<span class="token operator">=</span>snsapi_base<span class="token operator">&amp;</span>state<span class="token operator">=</span>#wechat_redirect</span>
<span class="code-line"></span>
<span class="code-line">员工点击后，页面将跳转至 </span>
<span class="code-line">http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>api<span class="token punctuation">.</span><span class="token number">3</span>dept<span class="token punctuation">.</span>com<span class="token operator">/</span>cgi<span class="token operator">-</span>bin<span class="token operator">/</span>query<span class="token operator">?</span>action<span class="token operator">=</span>get<span class="token operator">&amp;</span>code<span class="token operator">=</span>eh3CZBgG333qs9EdaPbCAP1VaOrjuNkiAZHTWgaWsZQ<span class="token operator">&amp;</span>state<span class="token operator">=</span></span>
<span class="code-line"></span>
<span class="code-line">企业可根据code参数调用获得员工的userid</span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><blockquote data-sign="d50453862e5d24ef6ce4c195c0a5839b_1" data-lines="1">注意到，构造OAuth2链接中参数的redirect_uri是经过UrlEncode的</blockquote></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>