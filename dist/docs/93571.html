<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>wx.qy.shareToExternalContact - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        wx.qy.shareToExternalContact
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2025/07/11</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><h3 id="wxqysharetoexternalcontactobject-object" data-sign="d6626bc400ac34c5db41348d476ac14f" data-lines="1"><a class="anchor" href="#wxqysharetoexternalcontactobject-object"></a>wx.qy.shareToExternalContact(Object object)</h3><p data-sign="5d6266c82bdde6969208953ca9b736e0" data-type="p" data-lines="2">该接口支持在小程序环境中，具有客户联系权限的企业成员将文本内容和附件传递到群发助手、发送给客户。<br>为了防止滥用，每次群发最多可选20000个客户，同一个成员每日向一个客户最多可群发一条消息，可在企业微信-群发助手-设置群发规则中调整为每周接收七条或每月可接收条数为当月天数。</p><blockquote data-sign="a0fe1b7c7dacd0d0fa033eb9d89e259f_7" data-lines="7"><strong>调用说明：</strong><br>文本最多支持传入4000个字<br>附件最多支持传入9个，类型支持图片(“image”)，视频(“video”)，图文(“link”)，小程序(“miniprogram”)和文件(“file”)<br>支持传入文本和多附件的能力，仅在企业微信3.1.6及以后版本支持（mac端暂不支持）（<a href="#29620" rel="nofollow">查看旧版本接口调用方式</a>）。微信客户端和微信开发者工具都不支持该接口。<br>必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态<br>当前成员必须在应用的可见范围<br>仅<a href="#13473/%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E8%81%94%E7%B3%BB%E5%8A%9F%E8%83%BD%E7%9A%84%E6%88%90%E5%91%98" rel="nofollow">配置了客户联系功能</a>的用户可调用<br>应用需有<a href="#13473/%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E8%81%94%E7%B3%BB%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%BA%94%E7%94%A8" rel="nofollow">客户联系功能权限</a>（第三方应用需具有“企业客户权限-&gt;客户基础信息”权限），否则会报“no permission”错误</blockquote><p data-sign="br3" data-type="br" data-lines="3">&nbsp;</p><h4 id="%E5%8F%82%E6%95%B0" data-sign="8cb71f61557fabe1ccf527e1bd04a132" data-lines="1"><a class="anchor" href="#%E5%8F%82%E6%95%B0"></a>参数</h4><h5 id="object-object" data-sign="46276ba891600e417ac243f8fabb1b82" data-lines="2"><a class="anchor" href="#object-object"></a>Object object</h5><div class="cherry-table-container" data-sign="ce7108f553b64e92342104d7eb710ad2" data-lines="27">
        <table class="cherry-table"><thead><tr><th>参数名</th><th>类型</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>externalUserIds</td><td>Array</td><td>否</td><td>指定的客户列表，从4.1.10版本开始支持（mac端不支持）</td></tr><tr><td>text</td><td>Object</td><td>否</td><td>文本消息</td></tr><tr><td>text::content</td><td>string</td><td>否</td><td>消息文本内容</td></tr><tr><td>attachments</td><td>Array</td><td>是</td><td>附件，最多支持添加9个附件</td></tr><tr><td>msgtype</td><td>string</td><td>是</td><td>附件类型，可选image、link、miniprogram或者video</td></tr><tr><td>image</td><td>Object</td><td>否</td><td>图片消息附件</td></tr><tr><td>image::mediaid</td><td>string</td><td>否</td><td>图片的素材id，可通过<a href="#10112" rel="nofollow">素材管理</a>接口获得</td></tr><tr><td>image::imgUrl</td><td>string</td><td>否</td><td>图片的链接，<strong>仅可使用<a href="#13219" rel="nofollow">上传图片</a>接口得到的链接</strong>，跟图片mediaid填其中一个即可</td></tr><tr><td>link</td><td>Object</td><td>否</td><td>图文消息附件</td></tr><tr><td>link::title</td><td>string</td><td>否</td><td>图文消息标题，最多64个<strong>字节</strong></td></tr><tr><td>link::desc</td><td>string</td><td>否</td><td>图文消息摘要，最多512个<strong>字节</strong></td></tr><tr><td>link::url</td><td>string</td><td>否</td><td>图文消息</td></tr><tr><td>link::imgUrl</td><td>string</td><td>否</td><td>图文消息封面图片URL</td></tr><tr><td>miniprogram</td><td>Object</td><td>否</td><td>小程序消息附件</td></tr><tr><td>miniprogram::appid</td><td>string</td><td>是</td><td>当前小程序appid，必须是关联到企业的小程序应用</td></tr><tr><td>miniprogram::title</td><td>string</td><td>是</td><td>小程序消息标题，最多64个<strong>字节</strong></td></tr><tr><td>miniprogram::imgUrl</td><td>string</td><td>是</td><td>小程序消息封面的URL</td></tr><tr><td>miniprogram::page</td><td>string</td><td>否</td><td>小程序打开后的路径，注意要以.html作为后缀，否则在微信端打开会提示找不到页面</td></tr><tr><td>video</td><td>Object</td><td>否</td><td>视频消息附件</td></tr><tr><td>video::mediaid</td><td>string</td><td>是</td><td>视频的素材id，可通过<a href="#10112" rel="nofollow">素材管理</a>接口获得</td></tr><tr><td>file</td><td>Object</td><td>否</td><td>文件消息附件</td></tr><tr><td>file::mediaid</td><td>string</td><td>是</td><td>文件的素材id，可通过<a href="#10112" rel="nofollow">素材管理</a>接口获得</td></tr><tr><td>success</td><td>Function</td><td>否</td><td>群发成功的回调函数</td></tr><tr><td>fail</td><td>Function</td><td>否</td><td>群发失败的回调函数</td></tr><tr><td>complete</td><td>Function</td><td>否</td><td>调用结束的回调函数（群发成功、失败都会执行）</td></tr></tbody></table></div><blockquote data-sign="4b32972d8bba2f45894183266786ec55_1" data-lines="1">* text和attachments不能同时为空（注：若text和attachments同时为空，接口将用老的方式<a href="#29620" rel="nofollow">wx.qy.shareToExternalContact</a>进行兼容。）</blockquote><ul data-sign="5705e0cee83ddbabf3c85020b3fd3bc9list1" data-lines="1" class="cherry-list__square"><li>attachments中每个附件信息必须与msgtype一致，例如，msgtype指定为image，则需要填写image::imgUrl或者image::mediaid，否则会报错。mediaid和imgUrl只需填写一个，两者同时填写时使用media_id且imgUrl失效，二者不可同时为空</li></ul><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><h4 id="%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%EF%BC%9A" data-sign="a3eb661066708b00561e1028019ee536" data-lines="1"><a class="anchor" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%EF%BC%9A"></a>示例代码：</h4><div data-sign="48e37fc1c42631f7a7a717c55247e71f" data-type="codeBlock" data-lines="52">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line">wx<span class="token punctuation">.</span>qy<span class="token punctuation">.</span><span class="token function">shareToExternalContact</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">	  externalUserIds<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"wmEAlECwAAHrbAAAOK5u3Bf13xlYDAAA"</span><span class="token punctuation">,</span><span class="token string">"wmEAlECwAAHiBBBDOK5u3Af13xlYDBBB"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token comment">//客户列表，从4.1.10版本开始支持（mac端不支持）</span></span>
<span class="code-line">	  text<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">			content<span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>	<span class="token comment">// 文本内容</span></span>
<span class="code-line">	  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">      attachments<span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">	        <span class="token punctuation">{</span></span>
<span class="code-line">            	  msgtype<span class="token operator">:</span> <span class="token string">"image"</span><span class="token punctuation">,</span>    <span class="token comment">// 消息类型，必填</span></span>
<span class="code-line">				  image<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">						mediaid<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>      <span class="token comment">// 图片的素材id</span></span>
<span class="code-line">						imgUrl<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// 图片的imgUrl,跟图片mediaid填其中一个即可</span></span>
<span class="code-line">				  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				  msgtype<span class="token operator">:</span> <span class="token string">"link"</span><span class="token punctuation">,</span>    <span class="token comment">// 消息类型，必填</span></span>
<span class="code-line">				  link<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">						title<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// H5消息标题</span></span>
<span class="code-line">					    imgUrl<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    <span class="token comment">// H5消息封面图片URL</span></span>
<span class="code-line">					    desc<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    <span class="token comment">// H5消息摘要</span></span>
<span class="code-line">					    url<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// H5消息页面url 必填</span></span>
<span class="code-line">				  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				  msgtype<span class="token operator">:</span> <span class="token string">"miniprogram"</span><span class="token punctuation">,</span>    <span class="token comment">// 消息类型，必填</span></span>
<span class="code-line">				  miniprogram<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">					    appid<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    <span class="token comment">// 小程序的appid</span></span>
<span class="code-line">					    title<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// 小程序消息的title</span></span>
<span class="code-line">					    imgUrl <span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    <span class="token comment">//小程序消息的封面图。</span></span>
<span class="code-line">					    page<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">//小程序消息打开后的路径，注意要以.html作为后缀，否则在微信端打开会提示找不到页面</span></span>
<span class="code-line">				  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				  msgtype<span class="token operator">:</span> <span class="token string">"video"</span><span class="token punctuation">,</span>    <span class="token comment">// 消息类型，必填</span></span>
<span class="code-line">				  video<span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">						mediaid<span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// 视频的素材id</span></span>
<span class="code-line">				 <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				  msgtype<span class="token operator">:</span> <span class="token string">"file"</span><span class="token punctuation">,</span>    <span class="token comment">// 消息类型，必填，从3.1.12版本开始支持</span></span>
<span class="code-line">				  file<span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">						mediaid<span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// 文件的素材id，必填</span></span>
<span class="code-line">				 <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">      <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">             <span class="token comment">//todo:</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>