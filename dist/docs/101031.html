<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>被动回复消息 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        被动回复消息
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2025/10/21</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="8e2df6741500ab29bd68ee4694285a34-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E6%A6%82%E8%BF%B0" class="level-1">概述</a></li><li class="toc-li"><a href="#%E5%9B%9E%E5%A4%8D%E6%AC%A2%E8%BF%8E%E8%AF%AD" class="level-1">回复欢迎语</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%96%87%E6%9C%AC%E6%B6%88%E6%81%AF" class="level-2">文本消息</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E6%B6%88%E6%81%AF" class="level-2">模板卡片消息</a></li><li class="toc-li"><a href="#%E5%9B%9E%E5%A4%8D%E7%94%A8%E6%88%B7%E6%B6%88%E6%81%AF" class="level-1">回复用户消息</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%B5%81%E5%BC%8F%E6%B6%88%E6%81%AF%E5%9B%9E%E5%A4%8D" class="level-2">流式消息回复</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E6%B6%88%E6%81%AF-3" class="level-2">模板卡片消息</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%B5%81%E5%BC%8F%E6%B6%88%E6%81%AF%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E5%9B%9E%E5%A4%8D" class="level-2">流式消息+模板卡片回复</a></li><li class="toc-li"><a href="#%E5%9B%9E%E5%A4%8D%E6%B6%88%E6%81%AF%E6%9B%B4%E6%96%B0%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87" class="level-1">回复消息更新模板卡片</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%A8%A1%E7%89%88%E5%8D%A1%E7%89%87%E6%9B%B4%E6%96%B0%E6%B6%88%E6%81%AF" class="level-2">模版卡片更新消息</a></li></dir><h1 id="%E6%A6%82%E8%BF%B0" data-sign="87e604caed8185ceee87dc50e1676ad9" data-lines="1"><a class="anchor" href="#%E6%A6%82%E8%BF%B0"></a>概述</h1><p data-sign="c75afdb412dada0119103b0455a2b06e" data-type="p" data-lines="1">当用户与智能机器人进行交互时，企业微信会将相关的交互事件回调到开发者设置的回调URL，开发者可根据事件类型做出相应的响应，实现丰富的自定义功能。</p><p data-sign="c8b8c7d6d20d8e14e15f28fe5b247410" data-type="p" data-lines="1">目前主要有以下场景支持回复消息：</p><ol data-sign="0810ef74728717e63bf242b4f2310ae8list3" data-lines="3" class="cherry-list__default" start="1"><li>用户当天首次进入智能机器人单聊会话，回复欢迎语</li><li>用户向智能机器人发送消息 ，回复消息</li><li>用户点击模板卡片相关按钮等，回复消息更新模板卡片</li></ol><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><blockquote data-sign="30aff583166df9c9fec8e6d0c75edb09_1" data-lines="1">具体可参考<a href="#59174/%E6%8E%A5%E6%94%B6%E5%9B%9E%E8%B0%83%E4%B8%8E%E8%A2%AB%E5%8A%A8%E5%9B%9E%E5%A4%8D%E6%B6%88%E6%81%AF" rel="nofollow">接收回调与被动回复消息流程</a></blockquote><p data-sign="br4" data-type="br" data-lines="4">&nbsp;</p><h1 id="%E5%9B%9E%E5%A4%8D%E6%AC%A2%E8%BF%8E%E8%AF%AD" data-sign="66e6d7401026a5cf48b358ec27f502d9" data-lines="1"><a class="anchor" href="#%E5%9B%9E%E5%A4%8D%E6%AC%A2%E8%BF%8E%E8%AF%AD"></a>回复欢迎语</h1><h2 id="%E6%96%87%E6%9C%AC%E6%B6%88%E6%81%AF" data-sign="0f52a10d539ec3ed9cb15a609207ae1b" data-lines="2"><a class="anchor" href="#%E6%96%87%E6%9C%AC%E6%B6%88%E6%81%AF"></a>文本消息</h2><div data-sign="3dcbe7aeaa3d5eb947a0b2aac2224efe" data-type="codeBlock" data-lines="8">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token property">"msgtype"</span><span class="token operator">:</span> <span class="token string">"text"</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token property">"text"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"hello\nI'm RobotA\n"</span></span>
<span class="code-line">  <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="1"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="9a99a3d3b6316caf4a977481b5eec43d" data-lines="5">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>msgtype</td><td>String</td><td>是</td><td>此时固定为text</td></tr><tr><td>text</td><td>Object</td><td>是</td><td>文本消息的详细内容</td></tr><tr><td>text.content</td><td>String</td><td>是</td><td>文本内容</td></tr></tbody></table></div><blockquote data-sign="f2d8291dc223ed257bed30b8735df23d_2" data-lines="2">目前仅支持进入会话回调事件时，支持被动回复文本消息</blockquote><h2 id="%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E6%B6%88%E6%81%AF" data-sign="d00cedfd42b8b4de958333ba07695b80" data-lines="2"><a class="anchor" href="#%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E6%B6%88%E6%81%AF"></a>模板卡片消息</h2><div data-sign="1edc30c8ddf8f09d38467ec991a53f9d" data-type="codeBlock" data-lines="54">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"msgtype"</span><span class="token operator">:</span> <span class="token string">"template_card"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"template_card"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token property">"card_type"</span><span class="token operator">:</span> <span class="token string">"multiple_interaction"</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"source"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"icon_url"</span><span class="token operator">:</span> 		 <span class="token string">"https://wework.qpic.cn/wwpic/252813_jOfDHtcISzuodLa_1629280209/0"</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"企业微信"</span></span>
<span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"main_title"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"欢迎使用企业微信"</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"desc"</span><span class="token operator">:</span> <span class="token string">"您的好友正在邀请您加入企业微信"</span></span>
<span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"select_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">            <span class="token punctuation">{</span></span>
<span class="code-line">                <span class="token property">"question_key"</span><span class="token operator">:</span> <span class="token string">"question_key_one"</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"选择标签1"</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"disable"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"selected_id"</span><span class="token operator">:</span> <span class="token string">"id_one"</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"option_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                    <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"id_one"</span><span class="token punctuation">,</span></span>
<span class="code-line">                        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"选择器选项1"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">                    <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"id_two"</span><span class="token punctuation">,</span></span>
<span class="code-line">                        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"选择器选项2"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span></span>
<span class="code-line">                <span class="token punctuation">]</span></span>
<span class="code-line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token punctuation">{</span></span>
<span class="code-line">                <span class="token property">"question_key"</span><span class="token operator">:</span> <span class="token string">"question_key_two"</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"选择标签2"</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"selected_id"</span><span class="token operator">:</span> <span class="token string">"id_three"</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"option_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                    <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"id_three"</span><span class="token punctuation">,</span></span>
<span class="code-line">                        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"选择器选项3"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">                    <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"id_four"</span><span class="token punctuation">,</span></span>
<span class="code-line">                        <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"选择器选项4"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span></span>
<span class="code-line">                <span class="token punctuation">]</span></span>
<span class="code-line">            <span class="token punctuation">}</span></span>
<span class="code-line">        <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"submit_button"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"提交"</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"key"</span><span class="token operator">:</span> <span class="token string">"submit_key"</span></span>
<span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"task_id"</span><span class="token operator">:</span> <span class="token string">"task_id"</span></span>
<span class="code-line">    <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="1"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="f7c04cef595d64264b21410e9c23d53d" data-lines="4">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>msgtype</td><td>String</td><td>是</td><td>此时固定为template_card</td></tr><tr><td>template_card</td><td>Object</td><td>是</td><td>模板卡片TemplateCard结构体。参考<a href="#59098" rel="nofollow">模板卡片类型</a>中类型说明参考<a href="#59098" rel="nofollow">模板卡片类型</a>中类型说明</td></tr></tbody></table></div><blockquote data-sign="fe9417268de9773fb05559bf6c579b9f_2" data-lines="2">目前仅支持进入会话回调事件或者接收消息回调时，支持被动回复模板卡片消息</blockquote><h1 id="%E5%9B%9E%E5%A4%8D%E7%94%A8%E6%88%B7%E6%B6%88%E6%81%AF" data-sign="057eb8059deef8e852da500a1ee56ba9" data-lines="2"><a class="anchor" href="#%E5%9B%9E%E5%A4%8D%E7%94%A8%E6%88%B7%E6%B6%88%E6%81%AF"></a>回复用户消息</h1><h2 id="%E6%B5%81%E5%BC%8F%E6%B6%88%E6%81%AF%E5%9B%9E%E5%A4%8D" data-sign="ac8e02c132197b6eb07e7b63bc2b6235" data-lines="1"><a class="anchor" href="#%E6%B5%81%E5%BC%8F%E6%B6%88%E6%81%AF%E5%9B%9E%E5%A4%8D"></a>流式消息回复</h2><div data-sign="ad1af3fb9569f99520b1934b3e9e7442" data-type="codeBlock" data-lines="22">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token string">"msgtype"</span><span class="token operator">:</span> <span class="token string">"stream"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token string">"stream"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token string">"id"</span><span class="token operator">:</span> <span class="token string">"STREAMID"</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token string">"finish"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token string">"content"</span><span class="token operator">:</span> <span class="token string">"**广州**今日天气：29度，大部分多云，降雨概率：60%"</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token string">"msg_item"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">            <span class="token punctuation">{</span></span>
<span class="code-line">                <span class="token string">"msgtype"</span><span class="token operator">:</span> <span class="token string">"image"</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token string">"image"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">                    <span class="token string">"base64"</span><span class="token operator">:</span> <span class="token string">"BASE64"</span><span class="token punctuation">,</span></span>
<span class="code-line">                    <span class="token string">"md5"</span><span class="token operator">:</span> <span class="token string">"MD5"</span></span>
<span class="code-line">                <span class="token punctuation">}</span></span>
<span class="code-line">            <span class="token punctuation">}</span></span>
<span class="code-line">        <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token string">"feedback"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token string">"id"</span><span class="token operator">:</span> <span class="token string">"FEEDBACKID"</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="1"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="ee9978189de53ec8ad46e2b61961950f" data-lines="12">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>是否必填</th><th>说明</th></tr></thead><tbody><tr><td>msgtype</td><td>String</td><td>是</td><td>消息类型，此时固定为：stream</td></tr><tr><td>stream.id</td><td>String</td><td>否，流式消息首次回复的时候要求设置</td><td>自定义的唯一id，某次回调的首次回复第一次设置，后续回调会根据这个id来获取最新的流式消息</td></tr><tr><td>stream.finish</td><td>Bool</td><td>否</td><td>流式消息是否结束</td></tr><tr><td>stream.content</td><td>String</td><td>否</td><td>流式消息内容，最长不超过20480个字节，必须是utf8编码。<br>特殊的，第一次回复内容为"1"，第二次回复"123"，则此时消息展示内容"123"</td></tr><tr><td>stream.msg_item</td><td>Object[]</td><td>否</td><td>流式消息图文混排消息列表。</td></tr><tr><td>stream.msg_item.msgtype</td><td>String</td><td>否</td><td>图文混排消息类型，目前支持：image<br>特殊的，目前image的消息类型仅当finish=true，即流式消息结束的最后一次回复中设置</td></tr><tr><td>stream.msg_item.image</td><td>Object</td><td>否</td><td>图片混排的图片资源。目前最多支持设置10个</td></tr><tr><td>image.base64</td><td>String</td><td>是</td><td>图片内容的base64编码。<br>图片（base64编码前）最大不能超过10M，支持JPG,PNG格式</td></tr><tr><td>image.md5</td><td>String</td><td>是</td><td>图片内容（base64编码前）的md5值</td></tr><tr><td>stream.feedback.id</td><td>String</td><td>否</td><td>流式消息首次回复时候若字段不为空值，回复的消息被用户反馈时候会触发<a href="#59058/%E7%94%A8%E6%88%B7%E5%8F%8D%E9%A6%88%E4%BA%8B%E4%BB%B6" rel="nofollow">回调事件</a>。有效长度为 256 字节以内，必须是 utf-8 编码。</td></tr></tbody></table></div><blockquote data-sign="89cb50983b732fb8cf3bbfdb2c65a0ba_3" data-lines="3">流式消息回复内容content字段支持常见的<a href="#14404/markdown-v2%E7%B1%BB%E5%9E%8B" rel="nofollow">markdown格式</a><br>若content中包含思考过程&lt;think&gt;&lt;/think&gt;标签，客户端会展示思考过程。<br>若回复内容包含图片，仅支持在最后一次回复时，即finish=true时支持包含msgtype为image的msg_item。</blockquote><blockquote data-sign="fe9417268de9773fb05559bf6c579b9f_2" data-lines="2">目前仅支持进入会话回调事件或者接收消息回调时，支持被动回复模板卡片消息</blockquote><h2 id="%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E6%B6%88%E6%81%AF-3" data-sign="45c7e5ec76d71a9f63583a2346a95bb0" data-lines="2"><a class="anchor" href="#%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E6%B6%88%E6%81%AF-3"></a>模板卡片消息</h2><div data-sign="27ff86b6bdd69c6b82db5c1a0ed2366b" data-type="codeBlock" data-lines="10">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"msgtype"</span><span class="token operator">:</span> <span class="token string">"template_card"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"template_card"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token property">"feedback"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"FEEDBACKID"</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="1"><strong>参数说明：</strong></p><div data-sign="80ad37691e7e7f21519db2b708273e9f" data-lines="5" class="cherry-table-container">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>是否必填</th><th>说明</th></tr></thead><tbody><tr><td>msgtype</td><td>String</td><td>是</td><td>消息类型，此时固定为：template_card</td></tr><tr><td>template_card</td><td>Object</td><td>是</td><td>模板卡片结构体，参考<a href="#59098" rel="nofollow">模板卡片类型</a>中类型说明</td></tr><tr><td>template_card.feedback.id</td><td>String</td><td>否</td><td>特殊的该回复场景支持设置反馈信息。若字段不为空值，回复的消息被用户反馈时候会触发<a href="#59058/%E7%94%A8%E6%88%B7%E5%8F%8D%E9%A6%88%E4%BA%8B%E4%BB%B6" rel="nofollow">回调事件</a>。有效长度为 256 字节以内，必须是 utf-8 编码。</td></tr></tbody></table></div><h2 id="%E6%B5%81%E5%BC%8F%E6%B6%88%E6%81%AF%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E5%9B%9E%E5%A4%8D" data-sign="40f4c278ad1f8fd48be1e5fb7dc05077" data-lines="1"><a class="anchor" href="#%E6%B5%81%E5%BC%8F%E6%B6%88%E6%81%AF%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E5%9B%9E%E5%A4%8D"></a>流式消息+模板卡片回复</h2><p data-sign="978045cb5ee40301859b130bfc8e0699" data-type="p" data-lines="1">若开发者需要回复流式消息外，还需要回复模板卡片，可回复该消息类型。</p><blockquote data-sign="b91a85b8aeb95f2ba2651bc4333db6ac_2" data-lines="2">目前仅支持进入会话回调事件或者接收消息回调时，支持被动回复模板卡片消息<br>首次回复时必须返回stream的id。<br>template_card可首次回复，也可在收到流式消息刷新事件时回复。但是同一个消息只能回复一次。</blockquote><div data-sign="aa8ac9a05f2724323f22dccce86ba7f2" data-type="codeBlock" data-lines="28">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"msgtype"</span><span class="token operator">:</span> <span class="token string">"stream_with_template_card"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"stream"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"STREAMID"</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"finish"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"content"</span><span class="token operator">:</span> <span class="token string">"**广州**今日天气：29度，大部分多云，降雨概率：60%"</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"msg_item"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">            <span class="token punctuation">{</span></span>
<span class="code-line">                <span class="token property">"msgtype"</span><span class="token operator">:</span> <span class="token string">"image"</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"image"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">                    <span class="token property">"base64"</span><span class="token operator">:</span> <span class="token string">"BASE64"</span><span class="token punctuation">,</span></span>
<span class="code-line">                    <span class="token property">"md5"</span><span class="token operator">:</span> <span class="token string">"MD5"</span></span>
<span class="code-line">                <span class="token punctuation">}</span></span>
<span class="code-line">            <span class="token punctuation">}</span></span>
<span class="code-line">        <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token property">"feedback"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"FEEDBACKID"</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"template_card"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token property">"feedback"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"FEEDBACKID"</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="1"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="66564d50bc4e67063beedafbd2b09651" data-lines="7">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>是否必填</th><th>说明</th></tr></thead><tbody><tr><td>msgtype</td><td>String</td><td>是</td><td>消息类型，此时固定为：stream_with_template_card</td></tr><tr><td>stream</td><td>Object</td><td>是</td><td>参考<a href="#59068/%E6%B5%81%E5%BC%8F%E5%9B%9E%E5%A4%8D%E6%B6%88%E6%81%AF" rel="nofollow">流式回复消息</a>说明。</td></tr><tr><td>stream.feedback.id</td><td>String</td><td>否</td><td>特殊的该回复场景支持设置反馈信息。流式消息首次回复时候若字段不为空值，回复的消息被用户反馈时候会触发<a href="#59058/%E7%94%A8%E6%88%B7%E5%8F%8D%E9%A6%88%E4%BA%8B%E4%BB%B6" rel="nofollow">回调事件</a>。有效长度为 256 字节以内，必须是 utf-8 编码。</td></tr><tr><td>template_card</td><td>Object</td><td>否</td><td>模板卡片结构体，参考<a href="#59098" rel="nofollow">模板卡片类型</a>中类型说明</td></tr><tr><td>template_card.feedback.id</td><td>String</td><td>否</td><td>特殊的该回复场景支持设置反馈信息。若字段不为空值，回复的消息被用户反馈时候会触发<a href="#59058/%E7%94%A8%E6%88%B7%E5%8F%8D%E9%A6%88%E4%BA%8B%E4%BB%B6" rel="nofollow">回调事件</a>。有效长度为 256 字节以内，必须是 utf-8 编码。</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><h1 id="%E5%9B%9E%E5%A4%8D%E6%B6%88%E6%81%AF%E6%9B%B4%E6%96%B0%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87" data-sign="960c646449bee12106966ede6add59d3" data-lines="2"><a class="anchor" href="#%E5%9B%9E%E5%A4%8D%E6%B6%88%E6%81%AF%E6%9B%B4%E6%96%B0%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87"></a>回复消息更新模板卡片</h1><h2 id="%E6%A8%A1%E7%89%88%E5%8D%A1%E7%89%87%E6%9B%B4%E6%96%B0%E6%B6%88%E6%81%AF" data-sign="4f7a6380582081ff2054cb3506816205" data-lines="1"><a class="anchor" href="#%E6%A8%A1%E7%89%88%E5%8D%A1%E7%89%87%E6%9B%B4%E6%96%B0%E6%B6%88%E6%81%AF"></a>模版卡片更新消息</h2><p data-sign="67a28e971a4e148a4524c940d5635e75" data-type="p" data-lines="1">当机器人服务接收到<a href="#59058/%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E4%BA%8B%E4%BB%B6" rel="nofollow">模版卡片事件</a>后，可以在该事件的返回包中添加消息进行即时响应。</p><div data-sign="c39674268deedc184d68f12ff9dacde1" data-type="codeBlock" data-lines="15">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"response_type"</span><span class="token operator">:</span> <span class="token string">"update_template_card"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"userids"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">        <span class="token string">"USERID1"</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token string">"USERID2"</span></span>
<span class="code-line">    <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"template_card"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token property">"feedback"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token string">"FEEDBACKID"</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="54d2f7abd4f226094d9bdd35b3129b56" data-type="p" data-lines="2"><strong>参数说明</strong></p><div data-sign="c0d5e5022ffeee70b697620adfca2241" data-lines="6" class="cherry-table-container">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">类型</th><th align="left">必须</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">response_type</td><td align="left">String</td><td align="left">是</td><td align="left">响应类型，此处固定为<br><code>update_template_card</code> - 替换部分用户的模版<br></td></tr><tr><td align="left">userids</td><td align="left">String[]</td><td align="left">否</td><td align="left">表示要替换模版卡片消息的userid列表。若不填，则表示替换当前消息涉及到的所有用户。开发者可以通过<a href="#59058/%E6%A8%A1%E6%9D%BF%E5%8D%A1%E7%89%87%E4%BA%8B%E4%BB%B6" rel="nofollow">模版卡片事件</a>中获取userid</td></tr><tr><td align="left">template_card</td><td align="left">Object</td><td align="left">是</td><td align="left">要替换的模版卡片TemplateCard结构体。参考<a href="#59098" rel="nofollow">模板卡片类型</a>中类型说明</td></tr><tr><td align="left">template_card.feedback.id</td><td align="left">String</td><td align="left">否</td><td align="left">特殊的该回复场景支持设置反馈信息，替换用户模板会覆盖原先消息的反馈信息。若字段不为空值，回复的消息被用户反馈时候会触发<a href="#59058/%E7%94%A8%E6%88%B7%E5%8F%8D%E9%A6%88%E4%BA%8B%E4%BB%B6" rel="nofollow">回调事件</a>。有效长度为 256 字节以内，必须是 utf-8 编码。</td></tr></tbody></table></div><blockquote data-sign="e4b77a91edf4afdb1fd3445dde487889_1" data-lines="1">注：模板卡片中的task_id需跟回调收到的task_id一致<br></blockquote></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>