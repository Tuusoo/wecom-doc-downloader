<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>向员工收款 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        向员工收款
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2025/08/21</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="96c3f5353063cd2e1740a3e2e21b6775-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E4%BC%81%E4%B8%9A%E5%90%91%E5%86%85%E9%83%A8%E5%91%98%E5%B7%A5%E6%94%B6%E6%AC%BE" class="level-2">企业向内部员工收款</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%BC%80%E9%80%9A%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E4%B8%93%E5%8C%BA" class="level-3">第一步：开通企业微信专区</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7openid" class="level-3">第二步：获取用户openid</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E6%B7%BB%E5%8A%A0jsapi%E7%9A%84%E6%9D%83%E9%99%90%E9%AA%8C%E8%AF%81" class="level-3">第三步：添加JSAPI的权限验证</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E5%8F%91%E8%B5%B7%E5%90%91%E5%91%98%E5%B7%A5%E6%94%B6%E6%AC%BE%E6%94%AF%E4%BB%98" class="level-3">第四步：发起向员工收款支付</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E7%AC%AC%E4%BA%94%E6%AD%A5%EF%BC%9A%E8%B0%83%E7%94%A8%E6%94%AF%E4%BB%98jsapi%E5%AE%8C%E6%88%90%E6%94%AF%E4%BB%98" class="level-3">第五步：调用支付JSAPI完成支付</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" class="level-3">注意事项</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%A4%87%E6%B3%A8" class="level-3">备注</a></li></dir><p data-sign="58db5cde1d1b893b1acd6cd3d1708075" data-type="p" data-lines="2">在企业微信里面，企业微信通过对微信公众号支付的能力进行了扩展，企业可以通过自定义应用的方式开发出具有收款能力的应用。</p><h2 id="%E4%BC%81%E4%B8%9A%E5%90%91%E5%86%85%E9%83%A8%E5%91%98%E5%B7%A5%E6%94%B6%E6%AC%BE" data-sign="e6e1762d86c1ae497b6c2eda8c53f8fe" data-lines="2"><a class="anchor" href="#%E4%BC%81%E4%B8%9A%E5%90%91%E5%86%85%E9%83%A8%E5%91%98%E5%B7%A5%E6%94%B6%E6%AC%BE"></a>企业向内部员工收款</h2><h3 id="%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%BC%80%E9%80%9A%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E4%B8%93%E5%8C%BA" data-sign="149a965dbaabe499657f3ef89d678809" data-lines="2"><a class="anchor" href="#%E7%AC%AC%E4%B8%80%E6%AD%A5%EF%BC%9A%E5%BC%80%E9%80%9A%E4%BC%81%E4%B8%9A%E5%BE%AE%E4%BF%A1%E4%B8%93%E5%8C%BA"></a>第一步：开通企业微信专区</h3><p data-sign="14228e6f21662c0d75cf971fa96fe7f3" data-type="p" data-lines="2">企业使用向员工收款能力，需要先了解并在按照指引在微信支付侧开通企业微信专区，具体开通页面，详见如下地址：<br><a href="https://work.weixin.qq.com/wework_admin/frame#hongbao/guide/hongbaoGuideEntry" target="&quot;_blank&quot;">https://work.weixin.qq.com/wework_admin/frame#hongbao/guide/hongbaoGuideEntry</a></p><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><h3 id="%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7openid" data-sign="fa0faf4d9bd42207d8a762edefefc888" data-lines="1"><a class="anchor" href="#%E7%AC%AC%E4%BA%8C%E6%AD%A5%EF%BC%9A%E8%8E%B7%E5%8F%96%E7%94%A8%E6%88%B7openid"></a>第二步：获取用户openid</h3><p data-sign="60efd98f5f23a28e6f535868ab5e03e1" data-type="p" data-lines="1">这里需要特别注意的是使用微信公众号的oauth流程进行公众号支付的场景不能在企业微信中直接发起支付，区别在于此处需要使用企业微信的oauth流程先获取用户的userid（参考文档：<a href="#90000/90135/91020" rel="nofollow">企业微信oauth流程</a>），再通过接口将userid转换为openid，具体的转换方式可以参考以下文档：<a href="#11279" rel="nofollow" title="userid与openid互换">userid与openid互换</a></p><h3 id="%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E6%B7%BB%E5%8A%A0jsapi%E7%9A%84%E6%9D%83%E9%99%90%E9%AA%8C%E8%AF%81" data-sign="5c1f02d160b80a12c08d142ef4fe6183" data-lines="2"><a class="anchor" href="#%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E6%B7%BB%E5%8A%A0jsapi%E7%9A%84%E6%9D%83%E9%99%90%E9%AA%8C%E8%AF%81"></a>第三步：添加JSAPI的权限验证</h3><p data-sign="2d5fb0346b91526ab40162625e81dbea" data-type="p" data-lines="1">在网页里通过JSAPI的方式发起支付出于安全因素需要对调用方的身份进行验证，所以开发者需要在页面上添加getBrandWCPayRequest接口的权限验证，验证方式如下：</p><div data-sign="ce77d0cdb2690fa192d9312cad1ac946" data-type="codeBlock" data-lines="10">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">wx<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">        debug<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启调试模式,调用的所有api的返回值会在客户端alert出来</span></span>
<span class="code-line">        appId<span class="token operator">:</span> <span class="token string">'appId'</span><span class="token punctuation">,</span> <span class="token comment">// 必填，企业微信的corpID</span></span>
<span class="code-line">        timestamp<span class="token operator">:</span> <span class="token string">'timestamp'</span><span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的时间戳</span></span>
<span class="code-line">        nonceStr<span class="token operator">:</span> <span class="token string">'noncestr'</span><span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的随机串</span></span>
<span class="code-line">        signature<span class="token operator">:</span> <span class="token string">'signature'</span><span class="token punctuation">,</span><span class="token comment">// 必填，签名</span></span>
<span class="code-line">        jsApiList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'getBrandWCPayRequest'</span><span class="token punctuation">]</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="b89fb57ab3df1a2e16509f13940ca92f" data-type="p" data-lines="1">此处的验证方式和微信公众平台的网页开发签名算法一致，更多关于JSAPI签名算法的完整流程，请参考文档 ：<a href="#10029/%E9%99%84%E5%BD%951-JS-SDK%E4%BD%BF%E7%94%A8%E6%9D%83%E9%99%90%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95" rel="nofollow" title="JS-SDK签名算法">JS-SDK签名算法</a></p><h3 id="%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E5%8F%91%E8%B5%B7%E5%90%91%E5%91%98%E5%B7%A5%E6%94%B6%E6%AC%BE%E6%94%AF%E4%BB%98" data-sign="c19d3ecd4fabed9f44f3a8495da31def" data-lines="2"><a class="anchor" href="#%E7%AC%AC%E5%9B%9B%E6%AD%A5%EF%BC%9A%E5%8F%91%E8%B5%B7%E5%90%91%E5%91%98%E5%B7%A5%E6%94%B6%E6%AC%BE%E6%94%AF%E4%BB%98"></a>第四步：发起向员工收款支付</h3><p data-sign="ba1c486eddd75ecab0757d2ebf2ad5e5" data-type="p" data-lines="3">企业完成上述配置以后，即可开始开发针对企业微信内支付的h5应用，具体的下单流程和微信支付公众号支付的下单流程一致，可参见以下文档进行统一下单操作：<br><a href="https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_1" target="_blank">https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_1</a></p><h3 id="%E7%AC%AC%E4%BA%94%E6%AD%A5%EF%BC%9A%E8%B0%83%E7%94%A8%E6%94%AF%E4%BB%98jsapi%E5%AE%8C%E6%88%90%E6%94%AF%E4%BB%98" data-sign="aeefa60fded11bb24c7b43b5573567a2" data-lines="2"><a class="anchor" href="#%E7%AC%AC%E4%BA%94%E6%AD%A5%EF%BC%9A%E8%B0%83%E7%94%A8%E6%94%AF%E4%BB%98jsapi%E5%AE%8C%E6%88%90%E6%94%AF%E4%BB%98"></a>第五步：调用支付JSAPI完成支付</h3><p data-sign="a3d2c38e7d1986f083e550d4f2369882" data-type="p" data-lines="3">企业微信支付的JSAPI和微信公众号支付使用相同的接口，调用方式可参见如下接口文档：<br><a href="https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_7&amp;index=6" target="_blank">https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=7_7&amp;index=6</a></p><div data-sign="189c6f1097820c9d9def08d21029ad52" data-type="codeBlock" data-lines="10">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"> WeixinJSBridge<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span></span>
<span class="code-line">            <span class="token string">'getBrandWCPayRequest'</span><span class="token punctuation">,</span></span>
<span class="code-line">            payParams<span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span>                </span>
<span class="code-line">                <span class="token comment">//TODO:res.err_code+res.err_desc+res.err_msg);</span></span>
<span class="code-line">            <span class="token punctuation">}</span></span>
<span class="code-line"> <span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h3 id="%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9" data-sign="8a43e8f617a4d9952d7ed726e5cf280c" data-lines="2"><a class="anchor" href="#%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"></a>注意事项</h3><p data-sign="556d5f04a9b0606c06c009a4c2c19b15" data-type="p" data-lines="2">1、当前参与支付的页面路径的url域名需要与当前开发的企业微信应用配置中的可信域名匹配。<br>2、当使用企业微信的JSSDK进行鉴权失败时，请查阅 <a href="http://work.weixin.qq.com/api/doc?st=5C8C795BE2D4D0B916C2DA92FF77CA2857D83F117047C7766F462042B870A37C31D3F270B5AD959948E3FF47B51E077F5F41403367AA163BF5C95EA2B718699AB8CEACD84238E05EB91568DA59EA710074821DB1BC8BCA823CFEE7DD9C10B085976CFBB626EABAB17D036E3E459A48E6650754E951705107CB14DB8F418CE93FEFBAEB8D3353C5F3FB0D882358A76CF1&amp;vid=1688851418270494&amp;version=2.4.22.1023&amp;platform=mac#10029/%E9%99%84%E5%BD%954-%E5%B8%B8%E8%A7%81%E9%94%99%E8%AF%AF%E5%8F%8A%E8%A7%A3%E5%86%B3%E6%96%B9%E6%B3%95" rel="nofollow" title="常见错误及解决方法">常见错误及解决方法</a></p><h3 id="%E5%A4%87%E6%B3%A8" data-sign="e6206aca6195c5117362c46d6a6af3e7" data-lines="2"><a class="anchor" href="#%E5%A4%87%E6%B3%A8"></a>备注</h3><p data-sign="40e1f2da4b5d24fc518c9fea963c4c05" data-type="p" data-lines="2">1、获取企业微信版本号<br>企业微信2.1.0版本后开始支持微信支付功能，低版本用户调用微信支付功能将无效。因此，建议企业通过user agent来确定用户当前的版本号后再调用支付接口。</p><p data-sign="b9f6f7064357065c15c21a9184a567be" data-type="p" data-lines="3">以iPhone版本为例，可通过user agent获取如下企业微信版本，示例信息：<br>"Mozilla/5.0 (iPhone; CPU iPhone OS 10_3_2 like Mac OS X) AppleWebKit/603.2.4 (KHTML, like Gecko) Mobile/14F89 wxwork/2.1.0 MicroMessenger/6.3.22"</p><p data-sign="8a932ef377b5adb53a1011dd196620de" data-type="p" data-lines="2">其中2.1.0为用户安装的企业微信版本号，企业可以解析以上HTTP头，获取企业微信版本号是否高于或者等于2.1.0。</p><p data-sign="b9c2433048f8d60d89760e727d1285cd" data-type="p" data-lines="4">2、关于订单查询以及退款等API功能<br>由于向员工收款功能是在微信公众号支付的能力进行了扩展，所以和后台相关的订单操作、退款操作等相关接口和微信公众号支付流程一致，可参见文档：<br><a href="https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_2" target="_blank">https://pay.weixin.qq.com/wiki/doc/api/jsapi.php?chapter=9_2</a></p></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>