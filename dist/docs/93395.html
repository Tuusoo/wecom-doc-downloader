<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>获取汇报统计数据 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        获取汇报统计数据
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2023/11/30</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><p data-sign="360dc3219e46e0edf1f18efe06b8ef38" data-type="p" data-lines="1">企业可通过调用本接口，根据汇报表单id查询企业微信“汇报应用”的汇报统计汇总信息。该接口只能拉取到已经汇总的统计数据，对于尚未完成汇总的周期不会返回。</p><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="7b303dfb6ccfa6c4d12dae062b7720e8" data-type="p" data-lines="1"><strong>请求方式</strong>:POST(<strong>HTTPS</strong>)</p><p data-sign="7e4c60d7613fe545cade70a4ce219bc1" data-type="p" data-lines="2"><strong>请求地址:</strong>https://qyapi.weixin.qq.com/cgi-bin/oa/journal/get_stat_list?access_token=ACCESS_TOKEN</p><p data-sign="8b8b131af4d7916d08149d0729990346" data-type="p" data-lines="2"><strong>请求示例</strong></p><div data-sign="c69cf3fb8cbddefc1cf243354bbf392d" data-type="codeBlock" data-lines="8">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"template_id"</span><span class="token operator">:</span> <span class="token string">"3TmALk1ogfgKiQE3e3jRwnTUhMTh8vca1N8zUVNUx"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"starttime"</span><span class="token operator">:</span> <span class="token number">1604160000</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"endtime"</span><span class="token operator">:</span> <span class="token number">1606363092</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="aa23204fbe4fd4230ddbc285930d9e58" data-type="p" data-lines="2"><strong>参数说明</strong>:</p><div class="cherry-table-container" data-sign="d8dfcb825a2fc16d32cd853ad9a2a71b" data-lines="6">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">必须</th><th align="left">类型</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">access_token</td><td align="left">是</td><td align="left">string</td><td align="left">调用接口凭证</td></tr><tr><td align="left">template_id</td><td align="left">是</td><td align="left">string</td><td align="left">汇报表单id,不多于256字节</td></tr><tr><td align="left">starttime</td><td align="left">是</td><td align="left">uint64</td><td align="left">开始时间</td></tr><tr><td align="left">endtime</td><td align="left">是</td><td align="left">uint64</td><td align="left">结束时间，时间区间最大长度为一年</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="73c9ab6dac00e2be67fbc46dc7f323b4" data-type="p" data-lines="2"><strong>权限说明</strong>: <br>调用的应用需要满足如下的权限：</p><div class="cherry-table-container" data-sign="751b5b4bf990c1d8e126666ec3b12370" data-lines="5">
        <table class="cherry-table"><thead><tr><th>应用类型</th><th>权限要求</th></tr></thead><tbody><tr><td>自建应用</td><td>需要配置到「<a href="#26566/%E5%8F%AF%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%BA%94%E7%94%A8" rel="nofollow">汇报 - 可调用接口的应用</a>」中</td></tr><tr><td>代开发应用</td><td>暂不支持</td></tr><tr><td>第三方应用</td><td>暂不支持</td></tr></tbody></table></div><p data-sign="0d9e8df569fd1af08e5af1a04c3f7f01" data-type="p" data-lines="1"> <em>注：</em> 从2023年12月1日0点起，不再支持通过系统应用secret调用接口，存量企业暂不受影响 <a href="https://developer.work.weixin.qq.com/document/51165" rel="nofollow">查看详情</a></p><p data-sign="25ff3159d1dae3e8ef08523b3dd72cc2" data-type="p" data-lines="1"><strong>返回结果</strong>:</p><div data-sign="ebda7f365b5c4a3a8bb89f325673ea8c" data-type="codeBlock" data-lines="85">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"errcode"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"errmsg"</span><span class="token operator">:</span> <span class="token string">"ok"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"stat_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">        <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"template_id"</span><span class="token operator">:</span> <span class="token string">"3TmALk1ogfgKiQE3e3jRwnTUhMTh8vca1N8zUVNU"</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"template_name"</span><span class="token operator">:</span> <span class="token string">"日报"</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"report_range"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">                <span class="token property">"user_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                    <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"userid"</span><span class="token operator">:</span> <span class="token string">"user1"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span></span>
<span class="code-line">                <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"party_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                    <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"open_partyid"</span><span class="token operator">:</span> <span class="token string">"1"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span></span>
<span class="code-line">                <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"tag_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="code-line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"white_range"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">                <span class="token property">"user_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"party_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"tag_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="code-line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"receivers"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">                <span class="token property">"user_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                    <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"userid"</span><span class="token operator">:</span> <span class="token string">"user3"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span></span>
<span class="code-line">                <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"tag_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token property">"leader_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span></span>
<span class="code-line">            <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"cycle_begin_time"</span><span class="token operator">:</span> <span class="token number">1606147200</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"cycle_end_time"</span><span class="token operator">:</span> <span class="token number">1606233600</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"stat_begin_time"</span><span class="token operator">:</span> <span class="token number">1606147200</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"stat_end_time"</span><span class="token operator">:</span> <span class="token number">1606230000</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"report_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                <span class="token punctuation">{</span></span>
<span class="code-line">                    <span class="token property">"user"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"userid"</span><span class="token operator">:</span> <span class="token string">"user2"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">                    <span class="token property">"itemlist"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                        <span class="token punctuation">{</span></span>
<span class="code-line">                            <span class="token property">"journaluuid"</span><span class="token operator">:</span> <span class="token string">"4U9abSUrpY78VNxeNNv3J5TW5e9VLj8cDymH9py1Efpuj5X8QCDQx3stKr69pia3UL8auRjrCMsiRjgzL8mvKnff"</span><span class="token punctuation">,</span></span>
<span class="code-line">                            <span class="token property">"reporttime"</span><span class="token operator">:</span> <span class="token number">1606218548</span><span class="token punctuation">,</span></span>
<span class="code-line">                            <span class="token property">"flag"</span><span class="token operator">:</span> <span class="token number">0</span></span>
<span class="code-line">                        <span class="token punctuation">}</span></span>
<span class="code-line">                    <span class="token punctuation">]</span></span>
<span class="code-line">                <span class="token punctuation">}</span></span>
<span class="code-line">            <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"unreport_list"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                <span class="token punctuation">{</span></span>
<span class="code-line">                    <span class="token property">"user"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"userid"</span><span class="token operator">:</span> <span class="token string">"user1"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">                    <span class="token property">"itemlist"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                        <span class="token punctuation">{</span></span>
<span class="code-line">                            <span class="token property">"journaluuid"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span></span>
<span class="code-line">                            <span class="token property">"reporttime"</span><span class="token operator">:</span> <span class="token number">1606147200</span><span class="token punctuation">,</span></span>
<span class="code-line">                            <span class="token property">"flag"</span><span class="token operator">:</span> <span class="token number">0</span></span>
<span class="code-line">                        <span class="token punctuation">}</span></span>
<span class="code-line">                    <span class="token punctuation">]</span></span>
<span class="code-line">                <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">                <span class="token punctuation">{</span></span>
<span class="code-line">                    <span class="token property">"user"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">                        <span class="token property">"userid"</span><span class="token operator">:</span> <span class="token string">"user3"</span></span>
<span class="code-line">                    <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">                    <span class="token property">"itemlist"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">                        <span class="token punctuation">{</span></span>
<span class="code-line">                            <span class="token property">"journaluuid"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span></span>
<span class="code-line">                            <span class="token property">"reporttime"</span><span class="token operator">:</span> <span class="token number">1606147200</span><span class="token punctuation">,</span></span>
<span class="code-line">                            <span class="token property">"flag"</span><span class="token operator">:</span> <span class="token number">0</span></span>
<span class="code-line">                        <span class="token punctuation">}</span></span>
<span class="code-line">                    <span class="token punctuation">]</span></span>
<span class="code-line">                <span class="token punctuation">}</span></span>
<span class="code-line">            <span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"report_type"</span><span class="token operator">:</span> <span class="token number">2</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">]</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="aa23204fbe4fd4230ddbc285930d9e58" data-type="p" data-lines="2"><strong>参数说明</strong>:</p><div class="cherry-table-container" data-sign="6bdb4ea27386e40ea008f6b95def7d47" data-lines="43">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">类型</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">errcode</td><td align="left">int32</td><td align="left">返回码</td></tr><tr><td align="left">errmsg</td><td align="left">string</td><td align="left">错误码描述</td></tr><tr><td align="left">stat_list</td><td align="left">obj[]</td><td align="left">统计数据列表</td></tr><tr><td align="left">stat_list.template_id</td><td align="left">string</td><td align="left">汇报表单id</td></tr><tr><td align="left">stat_list.template_name</td><td align="left">string</td><td align="left">汇报表单名称</td></tr><tr><td align="left">stat_list.report_range</td><td align="left">obj</td><td align="left">汇报人员范围</td></tr><tr><td align="left">stat_list.report_range.user_list</td><td align="left">obj[]</td><td align="left">指定人集合</td></tr><tr><td align="left">stat_list.report_range.user_list.userid</td><td align="left">string</td><td align="left">用户id</td></tr><tr><td align="left">stat_list.report_range.party_list</td><td align="left">obj[]</td><td align="left">指定部门集合</td></tr><tr><td align="left">stat_list.report_range.party_list.open_partyid</td><td align="left">string</td><td align="left">部门id</td></tr><tr><td align="left">stat_list.report_range.tag_list</td><td align="left">obj[]</td><td align="left">指定标签集合</td></tr><tr><td align="left">stat_list.report_range.tag_list.open_tagid</td><td align="left">string</td><td align="left">标签id</td></tr><tr><td align="left">stat_list.white_range</td><td align="left">obj</td><td align="left">白名单集合</td></tr><tr><td align="left">stat_list.white_range.user_list</td><td align="left">obj[]</td><td align="left">指定人集合</td></tr><tr><td align="left">stat_list.white_range.user_list.userid</td><td align="left">string</td><td align="left">用户id</td></tr><tr><td align="left">stat_list.white_range.party_list</td><td align="left">obj[]</td><td align="left">指定部门集合</td></tr><tr><td align="left">stat_list.white_range.party_list.open_partyid</td><td align="left">string</td><td align="left">部门id</td></tr><tr><td align="left">stat_list.white_range.tag_list</td><td align="left">obj[]</td><td align="left">指定标签集合</td></tr><tr><td align="left">stat_list.white_range.tag_list.open_tagid</td><td align="left">string</td><td align="left">标签id</td></tr><tr><td align="left">stat_list.receivers</td><td align="left">obj</td><td align="left">固定汇报对象</td></tr><tr><td align="left">stat_list.receivers.user_list</td><td align="left">obj[]</td><td align="left">指定人集合</td></tr><tr><td align="left">stat_list.receivers.user_list.userid</td><td align="left">string</td><td align="left">用户id</td></tr><tr><td align="left">stat_list.receivers.tag_list</td><td align="left">obj[]</td><td align="left">指定标签集合</td></tr><tr><td align="left">stat_list.receivers.tag_list.open_tagid</td><td align="left">string</td><td align="left">标签id</td></tr><tr><td align="left">stat_list.receivers.leader_list</td><td align="left">obj[]</td><td align="left">指定上级集合</td></tr><tr><td align="left">stat_list.receivers.leader_list.level</td><td align="left">uint64</td><td align="left">上级级别从1开始</td></tr><tr><td align="left">stat_list.cycle_begin_time</td><td align="left">uint64</td><td align="left">周期开始时间</td></tr><tr><td align="left">stat_list.cycle_end_time</td><td align="left">uint64</td><td align="left">周期结束时间</td></tr><tr><td align="left">stat_list.stat_begin_time</td><td align="left">uint64</td><td align="left">统计开始时间</td></tr><tr><td align="left">stat_list.stat_end_time</td><td align="left">uint64</td><td align="left">统计结束时间</td></tr><tr><td align="left">stat_list.report_list</td><td align="left">obj[]</td><td align="left">已汇报用户列表</td></tr><tr><td align="left">stat_list.report_list.user</td><td align="left">obj</td><td align="left">汇报用户</td></tr><tr><td align="left">stat_list.report_list.user.userid</td><td align="left">string</td><td align="left">用户id</td></tr><tr><td align="left">stat_list.report_list.itemlist</td><td align="left">obj[]</td><td align="left">汇报记录列表</td></tr><tr><td align="left">stat_list.report_list.itemlist.journaluuid</td><td align="left">string</td><td align="left">汇报记录id</td></tr><tr><td align="left">stat_list.report_list.itemlist.reporttime</td><td align="left">uint32</td><td align="left">汇报时间</td></tr><tr><td align="left">stat_list.report_list.itemlist.flag</td><td align="left">uint32</td><td align="left">是否迟交，1迟交;0非迟交</td></tr><tr><td align="left">stat_list.unreport_list</td><td align="left">obj[]</td><td align="left">未汇报用户列表</td></tr><tr><td align="left">stat_list.unreport_list.user</td><td align="left">obj</td><td align="left">未汇报用户</td></tr><tr><td align="left">stat_list.unreport_list.user.userid</td><td align="left">string</td><td align="left">用户id</td></tr><tr><td align="left">stat_list.report_type</td><td align="left">uint32</td><td align="left">汇报方式：2按日汇报; 3按周汇报; 4按月汇报</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="0b5e2cbea4e0f0fb4da25d3e6b256853" data-type="p" data-lines="1"><strong>错误说明</strong>：</p><div class="cherry-table-container" data-sign="a20973386c8ab6e004a808bce2f69f6c" data-lines="5">
        <table class="cherry-table"><thead><tr><th align="left">错误码</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">301065</td><td align="left">无汇报应用数据拉取权限</td></tr><tr><td align="left">301066</td><td align="left">请求参数错误</td></tr><tr><td align="left">301067</td><td align="left">接口内部失败</td></tr></tbody></table></div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>