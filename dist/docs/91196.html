<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>Android应用 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        Android应用
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2024/11/27</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="dfaa0b9283d201a4a43ce9941affebc0-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#android%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97" class="level-2">Android接入指南</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%88%9B%E5%BB%BA%E5%BA%94%E7%94%A8" class="level-3">创建应用</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%88%86%E4%BA%AB%E5%8A%9F%E8%83%BD%E6%8E%A5%E5%85%A5" class="level-3">分享功能接入</a></li></dir><h2 id="android%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97" data-sign="4563a1c1cadea64f4833a4f459d108bb" data-lines="1"><a class="anchor" href="#android%E6%8E%A5%E5%85%A5%E6%8C%87%E5%8D%97"></a>Android接入指南</h2><blockquote data-sign="a3ae63582c910b090dddd7e7f457b726_2" data-lines="2"><strong>接入说明：</strong><br>任何需要调用企业微信API的应用，都需要先在企业微信管理后台创建一个应用，设置完成后，即可使用对应的功能。</blockquote><h3 id="%E5%88%9B%E5%BB%BA%E5%BA%94%E7%94%A8" data-sign="75a599e4313591ae25e60203d73939bf" data-lines="2"><a class="anchor" href="#%E5%88%9B%E5%BB%BA%E5%BA%94%E7%94%A8"></a>创建应用</h3><ol data-sign="36db68e95c5864e86e06c3fa05b59f60list10" data-lines="10" class="cherry-list__default" start="1"><li>管理员登录企业微信管理后台，选择<strong>企业应用</strong><br></li><li>选择已有应用或添加应用，进入应用详情页面。<br></li><li>选择“企业微信授权登录”，在设置界面填写Android的 App的签名&amp;包名，设置完成后系统自动生成应用程序<strong>schema</strong>。<br><blockquote data-sign="7a4e69ac50eaecde8906a5faff7e62f4_1" data-lines="1">企业微信分享的设置，复用企业微信授权登录的设置，设置以后登录、分享任何一个都可以使用。</blockquote><br></li><li>下载企业微信终端开发工具包<br><a href="https://dldir1.qq.com/wework/wwopen/client_sdk/android/lib_wwapi-3.0.0.7.aar" rel="nofollow">lib_wwapi-3.0.0.7.aar</a><br><blockquote data-sign="3f96ffc792a42290e2a502f0db393e0b_5" data-lines="5">SDK名称：企业微信登录/分享SDK<br>版本号：3.0.0.7<br>主要功能：通过企业微信登录/分享SDK，企业可在自建的app引入sdk，从而可使用企业微信账号登录app，并且在app中分享消息到企业微信。<br>使用说明：详见本接入指南<br>开发者：深圳市腾讯计算机系统有限公司<br><strong>隐私政策：请接入企业微信登录/分享 SDK的开发者，认真阅读《<a href="https://work.weixin.qq.com/nl/act/p/47eb57a00e9f4ad5" rel="nofollow">企业微信登录/分享SDK个人信息保护规则</a>》，并确保对企业微信登录/分享SDK的接入使用情况符合上述规则的相关要求。</strong></blockquote></li></ol><p data-sign="dbf458c1a335787f34ac37ffa9244644" data-type="p" data-lines="1">每个第三方应用必须要导入该sdk库，用于实现与企业微信的通信。</p><ol data-sign="3976d9624d3bebe96d445923b80be55alist22" data-lines="22" class="cherry-list__default" start="5"><li>搭建开发环境<br>在你需要使用企业微信终端API的文件中导入相应的类。<br>import com.tencent.wework.api.model.WWMediaText;</li><li>在代码中使用开发工具包<ul class="cherry-list__square"><li>注册到企业微信<br>要使你的程序启动后企业微信终端能响应你的程序，必须在代码中向企业微信终端注册你的id。可以在程序入口Activity的onCreate回调函数处，或其他合适的地方将你的应用schema注册到企业微信。<br><div data-sign="40aa7040dc71130dbefcdc4008664b6e" data-type="codeBlock" data-lines="14">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line">	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> APPID <span class="token operator">=</span> <span class="token string">"WW1e933be11645237c"</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> AGENTID <span class="token operator">=</span> <span class="token string">"1000012"</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> SCHEMA <span class="token operator">=</span> <span class="token string">"wwauth1e933be11645237c000012"</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">	<span class="token annotation punctuation">@Override</span></span>
<span class="code-line">	<span class="token keyword">protected</span> <span class="token keyword">void</span> <span class="token function">onCreate</span><span class="token punctuation">(</span><span class="token class-name">Bundle</span> savedInstanceState<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">		<span class="token keyword">super</span><span class="token punctuation">.</span><span class="token function">onCreate</span><span class="token punctuation">(</span>savedInstanceState<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token function">setContentView</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>layout<span class="token punctuation">.</span>activity_main<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		stringId <span class="token operator">=</span> <span class="token function">getApplicationInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>labelRes<span class="token punctuation">;</span></span>
<span class="code-line">		iwwapi <span class="token operator">=</span> <span class="token class-name">WWAPIFactory</span><span class="token punctuation">.</span><span class="token function">createWWAPI</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		iwwapi<span class="token punctuation">.</span><span class="token function">registerApp</span><span class="token punctuation">(</span>SCHEMA<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div></li><li>发送请求和接收返回值<br>现在，你的程序要发送请求到企业微信终端，可以通过IWWAPI的sendMessage方法来实现。<br>boolean sendMessage(BaseMessage msg);<br>sendMessage是第三方app主动发送消息给企业微信，发送完成之后会切回到第三方app界面。<br>boolean sendMessage(BaseMessage req, IWWAPIEventHandler callback)<br>带回调的sendMessage是第三方app向企业微信请求数据，企业微信回应数据之后会切回到第三方app界面。<br>sendMessage的实现示例，如下所示：<br><div data-sign="656d8697183a4553811bf1bf06922bc9" data-type="codeBlock" data-lines="8">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">WWMediaText</span> txt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WWMediaText</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">txt<span class="token punctuation">.</span>appPkg <span class="token operator">=</span> <span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">txt<span class="token punctuation">.</span>appName <span class="token operator">=</span> <span class="token function">getString</span><span class="token punctuation">(</span>stringId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">txt<span class="token punctuation">.</span>appId <span class="token operator">=</span> APPID<span class="token punctuation">;</span></span>
<span class="code-line">txt<span class="token punctuation">.</span>agentId <span class="token operator">=</span> AGENTID<span class="token punctuation">;</span></span>
<span class="code-line">iwwapi<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br>带回调的sendMessage的实现，如下所示：<br><div data-sign="b8ca2cda13e54f4df18cd7fa47e2a931" data-type="codeBlock" data-lines="23">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token keyword">final</span> <span class="token class-name">WWAuthMessage<span class="token punctuation">.</span>Req</span> req <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WWAuthMessage<span class="token punctuation">.</span>Req</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">req<span class="token punctuation">.</span>sch <span class="token operator">=</span> SCHEMA<span class="token punctuation">;</span></span>
<span class="code-line">req<span class="token punctuation">.</span>appId <span class="token operator">=</span> APPID<span class="token punctuation">;</span></span>
<span class="code-line">req<span class="token punctuation">.</span>agentId <span class="token operator">=</span> AGENTID<span class="token punctuation">;</span></span>
<span class="code-line">req<span class="token punctuation">.</span>state <span class="token operator">=</span> <span class="token string">"dd"</span><span class="token punctuation">;</span></span>
<span class="code-line">iwwapi<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>req<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IWWAPIEventHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">	<span class="token annotation punctuation">@Override</span></span>
<span class="code-line">	<span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleResp</span><span class="token punctuation">(</span><span class="token class-name">BaseMessage</span> resp<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">		<span class="token keyword">if</span> <span class="token punctuation">(</span>resp <span class="token keyword">instanceof</span> <span class="token class-name">WWAuthMessage<span class="token punctuation">.</span>Resp</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token class-name">WWAuthMessage<span class="token punctuation">.</span>Resp</span> rsp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">WWAuthMessage<span class="token punctuation">.</span>Resp</span><span class="token punctuation">)</span> resp<span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token keyword">if</span> <span class="token punctuation">(</span>rsp<span class="token punctuation">.</span>errCode <span class="token operator">==</span> <span class="token class-name">WWAuthMessage</span><span class="token punctuation">.</span>ERR_CANCEL<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"登录取消"</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>rsp<span class="token punctuation">.</span>errCode <span class="token operator">==</span> <span class="token class-name">WWAuthMessage</span><span class="token punctuation">.</span>ERR_FAIL<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"登录失败"</span><span class="token punctuation">,</span> <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>rsp<span class="token punctuation">.</span>errCode <span class="token operator">==</span> <span class="token class-name">WWAuthMessage</span><span class="token punctuation">.</span>ERR_OK<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span> <span class="token string">"登录成功："</span> <span class="token operator">+</span> rsp<span class="token punctuation">.</span>code<span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_SHORT<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">		<span class="token punctuation">}</span></span>
<span class="code-line">	<span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br>具体要发送的内容由第三方app开发者定义，具体可参考微信开发工具包中的SDK apitest源码。<br>注意<br>如果需要混淆代码，为了保证sdk的正常使用，需要在proguard.cfg加上下面两行配置：<br><div data-sign="a5fe822436d607e6b57e8c900b601282" data-type="codeBlock" data-lines="5">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token operator">-</span>keep <span class="token keyword">class</span> com<span class="token punctuation">.</span>tencent<span class="token punctuation">.</span>wework<span class="token punctuation">.</span>api<span class="token punctuation">.</span>*<span class="token operator">*</span> <span class="token punctuation">{</span></span>
<span class="code-line">   <span class="token operator">*</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br>至此，你已经能使用企业微信Android开发工具包的API内容了。如果想更详细了解每个API函数的用法，请查阅 Android 平台参考手册 或自行下载阅读企业微信apitest源码。</li></ul></li></ol><h3 id="%E5%88%86%E4%BA%AB%E5%8A%9F%E8%83%BD%E6%8E%A5%E5%85%A5" data-sign="19868fd4465686825927770d9fae133c" data-lines="2"><a class="anchor" href="#%E5%88%86%E4%BA%AB%E5%8A%9F%E8%83%BD%E6%8E%A5%E5%85%A5"></a>分享功能接入</h3><p data-sign="1aff2813a76006a447dfd46a1c2fdbde" data-type="p" data-lines="2">企业微信分享是指第三方App通过接入该功能，让用户可以从App分享文字、图片、文件、视频、网页至企业微信会话。<br>企业微信分享目前支持文字、图片、文件、视频、网页共五种类型。开发者在App中在集成企业微信SDK后，可调用接口实现，以下依次是文字分享、图片分享、文件分享、视频分享、网站分享的示例。</p><ol data-sign="f9d52a48209a4be5d08c33483b7ffd92list15" data-lines="15" class="cherry-list__default" start="1"><li>文字类型分享示例<br><div data-sign="ecb8e9e4653c0e3050453925e3a785d8" data-type="codeBlock" data-lines="9">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">WWMediaText</span> txt <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WWMediaText</span><span class="token punctuation">(</span></span>
<span class="code-line">						<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">txt<span class="token punctuation">.</span>appPkg <span class="token operator">=</span> <span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">txt<span class="token punctuation">.</span>appName <span class="token operator">=</span> <span class="token function">getString</span><span class="token punctuation">(</span>stringId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">txt<span class="token punctuation">.</span>appId <span class="token operator">=</span> APPID<span class="token punctuation">;</span> <span class="token comment">//企业唯一标识。创建企业后显示在，我的企业 CorpID字段</span></span>
<span class="code-line">txt<span class="token punctuation">.</span>agentId <span class="token operator">=</span> AGENTID<span class="token punctuation">;</span> <span class="token comment">//应用唯一标识。显示在具体应用下的 AgentId字段</span></span>
<span class="code-line">iwwapi<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>txt<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br></li><li>图片类型分享示例<br><div data-sign="b4a5f4df29f43417ca473daed0fc7504" data-type="codeBlock" data-lines="10">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">WWMediaImage</span> img <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WWMediaImage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">img<span class="token punctuation">.</span>fileName <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">;</span></span>
<span class="code-line">img<span class="token punctuation">.</span>filePath <span class="token operator">=</span> path<span class="token punctuation">;</span></span>
<span class="code-line">img<span class="token punctuation">.</span>appPkg <span class="token operator">=</span> <span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">img<span class="token punctuation">.</span>appName <span class="token operator">=</span> <span class="token function">getString</span><span class="token punctuation">(</span>stringId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">img<span class="token punctuation">.</span>appId <span class="token operator">=</span> APPID<span class="token punctuation">;</span> <span class="token comment">//企业唯一标识。创建企业后显示在，我的企业 CorpID字段</span></span>
<span class="code-line">img<span class="token punctuation">.</span>agentId <span class="token operator">=</span> AGENTID<span class="token punctuation">;</span></span>
<span class="code-line">iwwapi<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>img<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br></li><li>文件类型分享示例<br><div data-sign="d3060d748c1da711c0990acb04d7322e" data-type="codeBlock" data-lines="10">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">WWMediaFile</span> file <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WWMediaFile</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">file<span class="token punctuation">.</span>fileName <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">;</span></span>
<span class="code-line">file<span class="token punctuation">.</span>filePath <span class="token operator">=</span> path<span class="token punctuation">;</span></span>
<span class="code-line">file<span class="token punctuation">.</span>appPkg <span class="token operator">=</span> <span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">file<span class="token punctuation">.</span>appName <span class="token operator">=</span> <span class="token function">getString</span><span class="token punctuation">(</span>stringId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">file<span class="token punctuation">.</span>appId <span class="token operator">=</span> APPID<span class="token punctuation">;</span> <span class="token comment">//企业唯一标识。创建企业后显示在，我的企业 CorpID字段</span></span>
<span class="code-line">file<span class="token punctuation">.</span>agentId <span class="token operator">=</span> AGENTID<span class="token punctuation">;</span> <span class="token comment">//应用唯一标识。显示在具体应用下的 AgentId字段</span></span>
<span class="code-line">iwwapi<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br></li><li>视频类型分享示例<br><div data-sign="f55f45c000302dd7ea1f8caedc15172c" data-type="codeBlock" data-lines="10">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">WWMediaVideo</span> video <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WWMediaVideo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">video<span class="token punctuation">.</span>fileName <span class="token operator">=</span> <span class="token string">"test"</span><span class="token punctuation">;</span></span>
<span class="code-line">video<span class="token punctuation">.</span>filePath <span class="token operator">=</span> path<span class="token punctuation">;</span></span>
<span class="code-line">video<span class="token punctuation">.</span>appPkg <span class="token operator">=</span> <span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">video<span class="token punctuation">.</span>appName <span class="token operator">=</span> <span class="token function">getString</span><span class="token punctuation">(</span>stringId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">video<span class="token punctuation">.</span>appId <span class="token operator">=</span> APPID<span class="token punctuation">;</span> <span class="token comment">//企业唯一标识。创建企业后显示在，我的企业 CorpID字段</span></span>
<span class="code-line">video<span class="token punctuation">.</span>agentId <span class="token operator">=</span> AGENTID<span class="token punctuation">;</span> <span class="token comment">//应用唯一标识。显示在具体应用下的 AgentId字段</span></span>
<span class="code-line">iwwapi<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>video<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div></li><li>网页类型分享示例<br><div data-sign="ec4cd4bafccf33b9bfbe82673265e7b9" data-type="codeBlock" data-lines="12">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">WWMediaLink</span> link <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WWMediaLink</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">link<span class="token punctuation">.</span>thumbUrl <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et2<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">link<span class="token punctuation">.</span>webpageUrl <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et1<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">link<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et3<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">link<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">EditText</span><span class="token punctuation">)</span> <span class="token function">findViewById</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>id<span class="token punctuation">.</span>et4<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getText</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">link<span class="token punctuation">.</span>appPkg <span class="token operator">=</span> <span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">link<span class="token punctuation">.</span>appName <span class="token operator">=</span> <span class="token function">getString</span><span class="token punctuation">(</span>stringId<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">link<span class="token punctuation">.</span>appId <span class="token operator">=</span> APPID<span class="token punctuation">;</span> <span class="token comment">//企业唯一标识。创建企业后显示在，我的企业 CorpID字段</span></span>
<span class="code-line">link<span class="token punctuation">.</span>agentId <span class="token operator">=</span> AGENTID<span class="token punctuation">;</span> <span class="token comment">//应用唯一标识。显示在具体应用下的 AgentId字段</span></span>
<span class="code-line">iwwapi<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>link<span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br></li><li>小程序类型分享示例</li></ol><div data-sign="fc4cc2ff14dbb8444b15a90fa69ac955" data-type="codeBlock" data-lines="33">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token class-name">WWMediaMiniProgram</span> miniProgram <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">WWMediaMiniProgram</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>appPkg <span class="token operator">=</span> <span class="token function">getPackageName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>appName <span class="token operator">=</span> <span class="token string">"teset"</span><span class="token punctuation">;</span><span class="token comment">//app name of this android pkg</span></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>appId <span class="token operator">=</span> APPID<span class="token punctuation">;</span> <span class="token comment">//企业唯一标识。创建企业后显示在，我的企业 CorpID字段</span></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>agentId <span class="token operator">=</span> AGENTID<span class="token punctuation">;</span> <span class="token comment">//应用唯一标识。显示在具体应用下的 AgentId字段</span></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>schema <span class="token operator">=</span> SCHEMA<span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token string">"gh_dde54cb88ce7@app"</span><span class="token punctuation">;</span> <span class="token comment">//必须是应用关联的小程序，注意要有@app后缀</span></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>description <span class="token operator">=</span> <span class="token string">"dddddd"</span><span class="token punctuation">;</span></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>path <span class="token operator">=</span> <span class="token string">"/pages/plugin/index.html?plugid=1cbd3b7c8674e61769436b5e354ddb2f"</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token class-name">Bitmap</span> bitmap <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">BitmapDrawable</span><span class="token punctuation">)</span> <span class="token function">getDrawable</span><span class="token punctuation">(</span><span class="token class-name">R</span><span class="token punctuation">.</span>drawable<span class="token punctuation">.</span>test<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBitmap</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token class-name">ByteArrayOutputStream</span> stream <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ByteArrayOutputStream</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">bitmap<span class="token punctuation">.</span><span class="token function">compress</span><span class="token punctuation">(</span><span class="token class-name">Bitmap<span class="token punctuation">.</span>CompressFormat</span><span class="token punctuation">.</span>JPEG<span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">,</span> stream<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> byteArray <span class="token operator">=</span> stream<span class="token punctuation">.</span><span class="token function">toByteArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>hdImageData <span class="token operator">=</span> byteArray<span class="token punctuation">;</span></span>
<span class="code-line">miniProgram<span class="token punctuation">.</span>title <span class="token operator">=</span> <span class="token string">"测试_MaHow"</span><span class="token punctuation">;</span></span>
<span class="code-line">iwwapi<span class="token punctuation">.</span><span class="token function">sendMessage</span><span class="token punctuation">(</span>miniProgram<span class="token punctuation">,</span> <span class="token keyword">new</span> <span class="token class-name">IWWAPIEventHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token annotation punctuation">@Override</span></span>
<span class="code-line">    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">handleResp</span><span class="token punctuation">(</span><span class="token class-name">BaseMessage</span> resp<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token keyword">if</span><span class="token punctuation">(</span>resp <span class="token keyword">instanceof</span> <span class="token class-name">WWSimpleRespMessage</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token class-name">WWSimpleRespMessage</span> rsp <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token class-name">WWSimpleRespMessage</span><span class="token punctuation">)</span>resp<span class="token punctuation">;</span></span>
<span class="code-line">            <span class="token class-name">String</span> t <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></span>
<span class="code-line">            <span class="token class-name">Toast</span><span class="token punctuation">.</span><span class="token function">makeText</span><span class="token punctuation">(</span><span class="token class-name">MainActivity</span><span class="token punctuation">.</span><span class="token keyword">this</span><span class="token punctuation">,</span></span>
<span class="code-line">                    t <span class="token operator">=</span> <span class="token string">"发小程序,"</span> <span class="token operator">+</span> rsp<span class="token punctuation">.</span>errCode <span class="token operator">+</span> <span class="token string">","</span> <span class="token operator">+</span> rsp<span class="token punctuation">.</span>errMsg<span class="token punctuation">,</span></span>
<span class="code-line">                    <span class="token class-name">Toast</span><span class="token punctuation">.</span>LENGTH_LONG<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>