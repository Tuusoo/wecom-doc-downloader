<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>JS-SDK 签名算法 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        JS-SDK 签名算法
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2024/11/14</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir data-sign="177a7da565edcacd0418349f6972c35c-1" data-lines="1" class="toc"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95" class="level-2">签名算法</a></li><li class="toc-li"><a href="#%E8%8E%B7%E5%8F%96%E4%BC%81%E4%B8%9A-jsapi-ticket" class="level-2">获取企业 jsapi_ticket</a></li><li class="toc-li"><a href="#%E8%8E%B7%E5%8F%96%E5%BA%94%E7%94%A8-jsapi-ticket" class="level-2">获取应用 jsapi_ticket</a></li></dir><h2 id="%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95" data-sign="ac8b82fb6d12088c475a11077a04fcc4" data-lines="1"><a class="anchor" href="#%E7%AD%BE%E5%90%8D%E7%AE%97%E6%B3%95"></a>签名算法</h2><p data-sign="5388ac7f9e8a5c5f5f014dd04391e384" data-type="p" data-lines="2">生成 JS-SDK 签名需要用到以下参数：</p><ol data-sign="40aa4bfd2082f9ebf928d6169d148da5list4" data-lines="4" class="cherry-list__default" start="1"><li><strong>jsapi_ticket:</strong> 获取方法参考 [获取企业 jsapi_ticket](#获取企业 jsapi_ticket) 和 [获取应用 jsapi_ticket](#获取应用 jsapi_ticket)</li><li><strong>noncestr:</strong> 随机字符串</li><li><strong>timestamp:</strong> 当前时间戳，单位为秒</li><li><strong>url:</strong> 当前页面的 URL，<font color="red">不包含“#”及后面部分</font></li></ol><p data-sign="be4b43bf6ddc3e079c97c818db8ef125" data-type="p" data-lines="1">准备好上述参数后，按以下结构拼接成一个字符串：</p><div data-sign="bb2fa7da26652582b2fc5acd2eaba173" data-type="codeBlock" data-lines="4">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">jsapi_ticket<span class="token operator">=</span><span class="token constant">JSAPI_TICKET</span><span class="token operator">&amp;</span>noncestr<span class="token operator">=</span><span class="token constant">NONCESTR</span><span class="token operator">&amp;</span>timestamp<span class="token operator">=</span><span class="token constant">TIMESTAMP</span><span class="token operator">&amp;</span>url<span class="token operator">=</span><span class="token constant">URL</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="c129dd85922b33a96f72d95e38eeeaa0" data-type="p" data-lines="2"><strong>注意：只需按上述规则进行拼接，不要改变参数顺序，不要进行 URL encode</strong></p><p data-sign="30fc5010cfe104c66003cad7bb765139" data-type="p" data-lines="2">拼接完成后，对拼接后的字符串进行 SHA-1，SHA-1 的结果即为 JS 接口签名。</p><p data-sign="4dd561ee43c97ca00e59f6f71337c76f" data-type="p" data-lines="2"><strong>示例</strong></p><p data-sign="241609b98c3d2f9667272a2c4cb7ce98" data-type="p" data-lines="2">假设有如下参数：</p><div data-sign="6f4c4ab39899092a719bb9ec944b10cd" data-type="codeBlock" data-lines="8">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">noncestr<span class="token operator">=</span>Wm3WZYTPz0wzccnW</span>
<span class="code-line">jsapi_ticket<span class="token operator">=</span>sM4AOVdWfPE4DxkXGEs8VMCPGGVi4C3VM0P37wVUCFvkVAy_90u5h9nbSlYy3<span class="token operator">-</span>Sl<span class="token operator">-</span>HhTdfl2fzFy1AOcHKP7qg</span>
<span class="code-line">timestamp<span class="token operator">=</span><span class="token number">1414587457</span></span>
<span class="code-line">url<span class="token operator">=</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mp<span class="token punctuation">.</span>weixin<span class="token punctuation">.</span>qq<span class="token punctuation">.</span>com<span class="token operator">?</span>params<span class="token operator">=</span>value</span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="7d29dc9a383c94006144cb65cca519b9" data-type="p" data-lines="2">将这些参数拼接成字符串 str1：</p><div data-sign="e59022c9c4e731a86a0e56be8aa43f98" data-type="codeBlock" data-lines="5">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">jsapi_ticket<span class="token operator">=</span>sM4AOVdWfPE4DxkXGEs8VMCPGGVi4C3VM0P37wVUCFvkVAy_90u5h9nbSlYy3<span class="token operator">-</span>Sl<span class="token operator">-</span>HhTdfl2fzFy1AOcHKP7qg<span class="token operator">&amp;</span>noncestr<span class="token operator">=</span>Wm3WZYTPz0wzccnW<span class="token operator">&amp;</span>timestamp<span class="token operator">=</span><span class="token number">1414587457</span><span class="token operator">&amp;</span>url<span class="token operator">=</span>http<span class="token operator">:</span><span class="token operator">/</span><span class="token operator">/</span>mp<span class="token punctuation">.</span>weixin<span class="token punctuation">.</span>qq<span class="token punctuation">.</span>com<span class="token operator">?</span>params<span class="token operator">=</span>value</span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="ffee9230cc1267286f3926dd63aa7848" data-type="p" data-lines="2">随后对 str1 进行 SHA-1，得到 signature：</p><div data-sign="6f9b8b0cce59f43a715290df7cbf765d" data-type="codeBlock" data-lines="4">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token number">0</span>f9de62fce790f9a083d5c99e95740ceb90c27ed</span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="718116248b4f3d2b9624ac4b9bbf95d2" data-type="p" data-lines="2"><strong>注意事项</strong></p><ul data-sign="f2204ac84c84e402da6d6ffc5e1fc543list2" data-lines="2" class="cherry-list__default"><li>出于安全考虑，开发者必须在服务器端实现签名的逻辑</li><li>如出现 invalid signature 等错误，请参考<a href="#90001/90144/93204" rel="nofollow">常见错误及解决办法</a></li></ul><h2 id="%E8%8E%B7%E5%8F%96%E4%BC%81%E4%B8%9A-jsapi-ticket" data-sign="245d2a098df731c123fc31fe916ff913" data-lines="2"><a class="anchor" href="#%E8%8E%B7%E5%8F%96%E4%BC%81%E4%B8%9A-jsapi-ticket"></a>获取企业 jsapi_ticket</h2><p data-sign="43ab70cd474e1d8e8180ad25782a8739" data-type="p" data-lines="2">企业的 jsapi_ticket 是企业页面调用企业微信 JS 接口的临时票据，用于企业应用鉴权（getConfigSignature）。</p><p data-sign="0d09e6d8c0b6ddffe3d060c8c75c2639" data-type="p" data-lines="2"><strong>注意</strong></p><p data-sign="502a8ad30609ef45e26fbd114a8afb75" data-type="p" data-lines="2">获取 jsapi_ticket 的接口有非常严格的调用频率限制（一小时内，一个企业最多可获取 400 次，且单个应用不能超过 100 次），开发者必须在自己的后台服务中对 jsapi_ticket 进行缓存。</p><p data-sign="828e86a078d692b39730adb568916d5b" data-type="p" data-lines="2">正常情况下 jsapi_ticket 的有效期为 7200 秒（2 小时），具体过期时间需要参考接口返回的 expires_in 属性。</p><p data-sign="42c06de25443f550c362fd9733955874" data-type="p" data-lines="3"><strong>请求方式：</strong>GET（<strong>HTTPS</strong>）<br><strong>请求 URL：</strong>https://qyapi.weixin.qq.com/cgi-bin/get_jsapi_ticket?access_token=ACCESS_TOKEN</p><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="2"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="db5f037ff2cd5fd1296eaa9f26f67f9a" data-lines="3">
        <table class="cherry-table"><thead><tr><th>参数</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>access_token</td><td>是</td><td>调用接口凭证，<br>企业内部开发，获取方式参考“<a href="#15074" rel="nofollow">获取 access_token</a>” <br>第三方应用开发，获取方式参考“<a href="#14944" rel="nofollow">获取企业凭证</a>”</td></tr></tbody></table></div><p data-sign="8c8bd07f58486862a201112e85376126" data-type="p" data-lines="2"><strong>返回结果：</strong></p><div data-sign="e79d9ebcf58a4dcca08058c8e71c8324" data-type="codeBlock" data-lines="9">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token string">"errcode"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token string">"errmsg"</span><span class="token operator">:</span> <span class="token string">"ok"</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token string">"ticket"</span><span class="token operator">:</span> <span class="token string">"bxLdikRXVbTPdHSM05e5u5sUoXNKd8-41ZO3MhKoyN5OfkWITDGgnr2fwJ0m9E8NYzWKVZvdVtaUgWvsdshFKA"</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token string">"expires_in"</span><span class="token operator">:</span> <span class="token number">7200</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><div class="cherry-table-container" data-sign="711313cab0bbf29c07dbf15403957d2f" data-lines="4">
        <table class="cherry-table"><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>ticket</td><td>生成签名所需的 jsapi_ticket，最长为512字节</td></tr><tr><td>expires_in</td><td>凭证的有效时间（秒）</td></tr></tbody></table></div><h2 id="%E8%8E%B7%E5%8F%96%E5%BA%94%E7%94%A8-jsapi-ticket" data-sign="88a98218e9284cac04173a0de64b1a25" data-lines="2"><a class="anchor" href="#%E8%8E%B7%E5%8F%96%E5%BA%94%E7%94%A8-jsapi-ticket"></a>获取应用 jsapi_ticket</h2><p data-sign="b71a9cc2cba0fdab7e4b45e9fca08c08" data-type="p" data-lines="2">企业的 jsapi_ticket 是应用调用企业微信 JS 接口的临时票据，用于第三方应用鉴权（getAgentConfigSignature）。</p><p data-sign="405fad10cefa95e4c4392ef5d430bce9" data-type="p" data-lines="3"><strong>请求方式：</strong>GET（<strong>HTTPS</strong>）<br><strong>请求URL：</strong>https://qyapi.weixin.qq.com/cgi-bin/ticket/get?access_token=ACCESS_TOKEN&amp;type=agent_config</p><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="2"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="3140caae628c359a772ba96179cafbe5" data-lines="3">
        <table class="cherry-table"><thead><tr><th>参数</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>access_token</td><td>是</td><td>应用的调用接口凭证，<br>企业内部开发，获取方式参考“<a href="#15074" rel="nofollow">获取 access_token</a>” <br>第三方应用开发，获取方式参考“<a href="#14944" rel="nofollow">获取企业凭证</a>”</td></tr></tbody></table></div><p data-sign="8c8bd07f58486862a201112e85376126" data-type="p" data-lines="2"><strong>返回结果：</strong></p><div data-sign="e79d9ebcf58a4dcca08058c8e71c8324" data-type="codeBlock" data-lines="9">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token string">"errcode"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token string">"errmsg"</span><span class="token operator">:</span> <span class="token string">"ok"</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token string">"ticket"</span><span class="token operator">:</span> <span class="token string">"bxLdikRXVbTPdHSM05e5u5sUoXNKd8-41ZO3MhKoyN5OfkWITDGgnr2fwJ0m9E8NYzWKVZvdVtaUgWvsdshFKA"</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token string">"expires_in"</span><span class="token operator">:</span> <span class="token number">7200</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><div class="cherry-table-container" data-sign="711313cab0bbf29c07dbf15403957d2f" data-lines="4">
        <table class="cherry-table"><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>ticket</td><td>生成签名所需的 jsapi_ticket，最长为512字节</td></tr><tr><td>expires_in</td><td>凭证的有效时间（秒）</td></tr></tbody></table></div><p data-sign="7ad8ee65a75cdfb2823b5ad3c3fdd729" data-type="p" data-lines="7"><style>code {  font-family: monospace !important;  white-space: pre;}</style></p></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>