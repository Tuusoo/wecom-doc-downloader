<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>查询红包记录 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        查询红包记录
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2023/03/27</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><h2 id="api%E6%8E%A5%E5%8F%A3%E5%8D%8F%E8%AE%AE" data-sign="a62817f224b7ff325b52ca54b6971031" data-lines="1"><a class="anchor" href="#api%E6%8E%A5%E5%8F%A3%E5%8D%8F%E8%AE%AE"></a>API接口协议</h2><p data-sign="d73da655ae97f5a02b5942b2458d9b0c" data-type="p" data-lines="1"><strong>注意事项：</strong></p><ul data-sign="d2584fc93e061d4806e19cbae856e383list5" data-lines="5" class="cherry-list__default"><li>查询红包记录API只支持查询30天内的红包订单，30天之前的红包订单请登录商户平台查询。</li><li>如果查询单号对应的数据不存在，那么数据不存在的原因可能是：（1）发放请求还在处理中；（2）红包发放处理失败导致红包订单没有落地。在上述情况下，商户首先需要检查该商户订单号是否确实是自己发起的，如果商户确认是自己发起的，则请商户不要直接当做红包发放失败处理，请商户隔几分钟再尝试查询，或者商户可以通过相同的商户订单号再次发起发放请求。如果商户误把还在发放中的订单直接当发放失败处理，商户应当自行承担因此产生的所有损失和责任。 </li><li>XML具有可扩展性，因此返回参数可能会有新增，而且顺序可能不完全遵循此文档规范，如果在解析回包的时候发生错误，请商户务必不要换单重试，请商户联系客服确认红包发放情况。如果有新回包字段，会更新到此API文档中。 </li><li>因为错误代码字段err_code的值后续可能会增加，所以商户如果遇到回包返回新的错误码，请商户务必不要换单重试，请商户联系客服确认红包发放情况。如果有新的错误码，会更新到此API文档中。</li><li>错误代码描述字段err_code_des只供人工定位问题时做参考，系统实现时请不要依赖这个字段来做自动化处理。</li></ul><p data-sign="9cc3e66a5d8658537c05739be6e0227c" data-type="p" data-lines="4"><strong>请求地址：</strong>https://api.mch.weixin.qq.com/mmpaymkttransfers/queryworkwxredpack<br><strong>是否需要证书 : **是<br></strong>请求方式：<strong>POST<br></strong>数据格式：**xml</p><p data-sign="0eaf88df03cd3784619d00af1ca68a35" data-type="p" data-lines="2"><strong>请求示例：</strong></p><div data-sign="8eed622aee1da70a7967a652f1fab4f7" data-type="codeBlock" data-lines="11">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token operator">&lt;</span>xml<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>nonce_str<span class="token operator">&gt;</span><span class="token number">5</span>K8264ILTKCH16CQ2502SI8ZNMTM67VS<span class="token operator">&lt;</span><span class="token operator">/</span>nonce_str<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>sign<span class="token operator">&gt;</span><span class="token constant">C380BEC2BFD727A4B6845133519F3AD6</span><span class="token operator">&lt;</span><span class="token operator">/</span>sign<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>mch_billno<span class="token operator">&gt;</span><span class="token number">123456</span><span class="token operator">&lt;</span><span class="token operator">/</span>mch_billno<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>mch_id<span class="token operator">&gt;</span><span class="token number">10000098</span><span class="token operator">&lt;</span><span class="token operator">/</span>mch_id<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>appid<span class="token operator">&gt;</span>wx8888888888888888<span class="token operator">&lt;</span><span class="token operator">/</span>appid<span class="token operator">&gt;</span></span>
<span class="code-line"><span class="token operator">&lt;</span><span class="token operator">/</span>xml<span class="token operator">&gt;</span></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="efaf67314a0c58b46e6bf2fbaf489b0b" data-type="p" data-lines="22"><strong>参数说明：</strong><br><style>table{    table-layout:fixed;}table th:first-of-type {    width: 14%;}table th:nth-of-type(2) {    width: 14%;}table th:nth-of-type(3) {    width: 14%;}table th:nth-of-type(4) {    width: 14%;}table th:nth-of-type(5) {    width: 14%;}</style></p><div class="cherry-table-container" data-sign="f8076ef35943de93ae90fc82df6d6684" data-lines="7">
        <table class="cherry-table"><thead><tr><th>字段名</th><th>字段</th><th>必填</th><th>示例值</th><th>类型</th></tr></thead><tbody><tr><td>随机字符串</td><td>nonce_str</td><td>是</td><td>5K8264ILTKCH16CQ2502SI8ZNMTM67VS</td><td>String(32)</td></tr><tr><td>微信支付签名</td><td>sign</td><td>是</td><td>C380BEC2BFD727A4B6845133519F3AD6</td><td>String(32)</td></tr><tr><td>商户订单号</td><td>mch_billno</td><td>是</td><td>123456</td><td>String(28)</td></tr><tr><td>商户号</td><td>mch_id</td><td>是</td><td>10000098</td><td>String(32)</td></tr><tr><td>Appid</td><td>appid</td><td>是</td><td>wxe062425f740d30d8</td><td>String(32)</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="0b789d7580f376b3feaff0d57431f7b7" data-type="p" data-lines="1"><strong>返回结果 ：</strong></p><div data-sign="0fa95a59b6d890791022ba8c2a1ab0da" data-type="codeBlock" data-lines="26">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token operator">&lt;</span>xml<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>return_code<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token constant">SUCCESS</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>return_code<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>return_msg<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>ok<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>return_msg<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>sign<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token constant">C380BEC2BFD727A4B6845133519F3AD6</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>sign<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>result_code<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token constant">SUCCESS</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>result_code<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>mch_billno<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token number">123456</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>mch_billno<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>mch_id<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token number">10000098</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>mch_id<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>detail_id<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token number">43235678654322356</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>detail_id<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>status<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token constant">RECEIVED</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>status<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>send_type<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token constant">API</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>send_type<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>total_amount<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token number">5000</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>total_amount<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>reason<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>余额不足<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>reason<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>send_time<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token number">2017</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">22</span>：<span class="token number">45</span>：<span class="token number">12</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>send_time<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>wishing<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>新年快乐<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>wishing<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>remark<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>新年红包<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>remark<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>act_name<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>新年红包<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>act_name<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>openid<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span>ohO4GtzOAAYMp2yapORH3dQB3W18<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>openid<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>amount<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token number">100</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>amount<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>rcv_time<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token number">2017</span><span class="token operator">-</span><span class="token number">07</span><span class="token operator">-</span><span class="token number">20</span> <span class="token number">22</span>：<span class="token number">46</span>：<span class="token number">59</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>rcv_time<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>sender_name<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token constant">XX</span>活动<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>sender_name<span class="token operator">&gt;</span></span>
<span class="code-line">	<span class="token operator">&lt;</span>sender_header_media_id<span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">!</span><span class="token punctuation">[</span><span class="token constant">CDATA</span><span class="token punctuation">[</span><span class="token number">1</span>G6nrLmr5EC3MMb_<span class="token operator">-</span>zK1dDdzmd0p7cNliYu9V5w7o8K0<span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>sender_header_media_id<span class="token operator">&gt;</span></span>
<span class="code-line"><span class="token operator">&lt;</span><span class="token operator">/</span>xml<span class="token operator">&gt;</span></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="fd349f5b366c476773faead078956a92" data-type="p" data-lines="1"><strong>返回参数:</strong></p><div class="cherry-table-container" data-sign="f850ddec77038a9ed3003b3861b1585d" data-lines="4">
        <table class="cherry-table"><thead><tr><th>字段名</th><th>字段</th><th>必填</th><th>示例值</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>返回状态码</td><td>return_code</td><td>是</td><td>SUCCESS</td><td>String(16)</td><td>SUCCESS/FAIL此字段是通信标识，非交易标识，交易是否成功需要查看result_code来判断</td></tr><tr><td>返回信息</td><td>return_msg</td><td>否</td><td>签名失败</td><td>String(128)</td><td>返回信息，如非空，为错误原因</td></tr></tbody></table></div><p data-sign="bcbd2701aadd16c0d0807353a7dcde9d" data-type="p" data-lines="2"><strong>以下字段在return_code为SUCCESS的时候有返回:</strong></p><div class="cherry-table-container" data-sign="4ef0097359ea308401e4a79ebf2f3d03" data-lines="6">
        <table class="cherry-table"><thead><tr><th>字段名</th><th>字段</th><th>必填</th><th>示例值</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>微信支付签名</td><td>sign</td><td>是</td><td>C380BEC2BFD727A4B6845133519F3AD6</td><td>String(32)</td><td>微信支付签名</td></tr><tr><td>业务结果</td><td>result_code</td><td>是</td><td>SUCCESS</td><td>String(16)</td><td>SUCCESS/FAIL</td></tr><tr><td>错误代码</td><td>err_code</td><td>否</td><td>SYSTEMERROR</td><td>String(32)</td><td>错误码信息</td></tr><tr><td>错误代码描述</td><td>err_code_des</td><td>否</td><td>系统错误</td><td>String(128)</td><td>结果信息描述</td></tr></tbody></table></div><p data-sign="68ffd80abb27f7b3f0f071365d0ca139" data-type="p" data-lines="2"><strong>以下字段在return_code 和result_code都为SUCCESS的时候有返回:</strong></p><div class="cherry-table-container" data-sign="978aac803e9e16e94ff9440c60891602" data-lines="20">
        <table class="cherry-table"><thead><tr><th>字段名</th><th>字段</th><th>必填</th><th>示例值</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>商户订单号</td><td>mch_billno</td><td>是</td><td>1E+25</td><td>String(28)</td><td>商户使用查询API填写的商户单号的原路返回</td></tr><tr><td>商户号</td><td>mch_id</td><td>是</td><td>10000098</td><td>String(32)</td><td>微信支付分配的商户号</td></tr><tr><td>红包单号</td><td>detail_id</td><td>是</td><td>1E+27</td><td>String(32)</td><td>使用API发放现金红包时返回的红包单号</td></tr><tr><td>红包状态</td><td>status</td><td>是</td><td>RECEIVED</td><td>string(16)</td><td>SENDING:发放 SENT:已发放待领取  FAILED：发放失败  RECEIVED:已领取  RFUND_ING:退款中  REFUND:已退款</td></tr><tr><td>发放类型</td><td>send_type</td><td>是</td><td>API</td><td>String(32)</td><td>API:通过API接口发放</td></tr><tr><td>红包金额</td><td>total_amount</td><td>是</td><td>5000</td><td>int</td><td>红包总金额（单位分）</td></tr><tr><td>失败原因</td><td>reason</td><td>否</td><td>余额不足</td><td>String(32)</td><td>发送失败原因</td></tr><tr><td>红包发送时间</td><td>send_time</td><td>是</td><td>########</td><td>String(32)</td><td>&nbsp;</td></tr><tr><td>红包退款时间</td><td>refund_time</td><td>否</td><td>########</td><td>String(32)</td><td>红包的退款时间（如果其未领取的退款）</td></tr><tr><td>红包退款金额</td><td>refund_amount</td><td>否</td><td>8000</td><td>Int</td><td>红包退款金额</td></tr><tr><td>祝福语</td><td>wishing</td><td>否</td><td>新年快乐</td><td>String(128)</td><td>祝福语</td></tr><tr><td>活动描述</td><td>remark</td><td>否</td><td>新年红包</td><td>String(256)</td><td>活动描述，低版本微信可见</td></tr><tr><td>活动名称</td><td>act_name</td><td>否</td><td>新年红包</td><td>String(32)</td><td>发红包的活动名称</td></tr><tr><td>领取红包的Openid</td><td>openid</td><td>是</td><td>ohO4GtzOAAYMp2yapORH3dQB3W18</td><td>String(32)</td><td>领取红包的openid</td></tr><tr><td>金额</td><td>amount</td><td>是</td><td>100</td><td>int</td><td>领取金额</td></tr><tr><td>接收时间</td><td>rcv_time</td><td>是</td><td>########</td><td>String(32)</td><td>领取红包的时间</td></tr><tr><td>发送者名称</td><td>sender_name</td><td>是</td><td>XX活动</td><td>String(128)</td><td>发送者名称</td></tr><tr><td>发送者头像</td><td>sender_header_media_id</td><td>否</td><td>1G6nrLmr5EC3MMb_-zK1dDdzmd0p7cNliYu9V5w7o8K0</td><td>String(128)</td><td>发送者头像素材，通过企业微信开放接口上传获取</td></tr></tbody></table></div><p data-sign="18860e6f624313d459fd72dd4e8bd379" data-type="p" data-lines="2"><strong>错误码:</strong></p><div class="cherry-table-container" data-sign="2b795be44dd7cac06643567dc1b844e7" data-lines="10">
        <table class="cherry-table"><thead><tr><th>错误码</th><th>错误描述</th><th>解决方式</th></tr></thead><tbody><tr><td>CA_ERROR</td><td>请求未携带证书，或请求携带的证书出错</td><td>到商户平台下载证书，请求带上证书后重试。</td></tr><tr><td>SIGN_ERROR</td><td>微信支付签名错误</td><td>按文档要求重新生成签名后再重试。</td></tr><tr><td>NO_AUTH</td><td>没有权限</td><td>请联系微信支付开通api权限</td></tr><tr><td>NOT_FOUND</td><td>指定单号数据不存在</td><td>查询单号对应的数据不存在，请使用正确的商户订单号查询</td></tr><tr><td>FREQ_LIMIT</td><td>受频率限制</td><td>请对请求做频率控制</td></tr><tr><td>XML_ERROR</td><td>请求的xml格式错误，或者post的数据为空</td><td>检查请求串，确认无误后重试</td></tr><tr><td>PARAM_ERROR</td><td>参数错误</td><td>请查看err_code_des，修改设置错误的参数</td></tr><tr><td>PSYSTEMERROR</td><td>系统繁忙，请再试</td><td>红包系统繁忙</td></tr></tbody></table></div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>