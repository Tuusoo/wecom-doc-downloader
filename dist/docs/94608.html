<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>wx.qy.shareToExternalMoments - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        wx.qy.shareToExternalMoments
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2021/08/25</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><p data-sign="bdf047eb8dde6ce9f3f487ccf0766c3b" data-type="p" data-lines="1">具有客户联系权限的企业成员，可通过该接口将文本内容和附件传递到客户朋友圈。当前暂仅支持在企业微信内调用。</p><div data-sign="d654dc3f61811bcce5c2f5ab4d8fde59" data-type="codeBlock" data-lines="35">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">wx<span class="token punctuation">.</span>qy<span class="token punctuation">.</span><span class="token function">shareToExternalMoments</span><span class="token punctuation">(</span> <span class="token punctuation">{</span></span>
<span class="code-line">      text<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">            content<span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>    <span class="token comment">// 文本内容</span></span>
<span class="code-line">      <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">      attachments<span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">	        <span class="token punctuation">{</span></span>
<span class="code-line">            	  msgtype<span class="token operator">:</span> <span class="token string">"image"</span><span class="token punctuation">,</span>    <span class="token comment">// 消息类型，必填</span></span>
<span class="code-line">				  image<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">						mediaid<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>      <span class="token comment">// 图片的素材id</span></span>
<span class="code-line">						imgUrl<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// 图片的imgUrl,跟图片mediaid填其中一个即可</span></span>
<span class="code-line">				  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				  msgtype<span class="token operator">:</span> <span class="token string">"link"</span><span class="token punctuation">,</span>    <span class="token comment">// 消息类型，必填</span></span>
<span class="code-line">				  link<span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">						title<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// H5消息标题</span></span>
<span class="code-line">					    imgUrl<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>    <span class="token comment">// H5消息封面图片URL</span></span>
<span class="code-line">					    url<span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// H5消息页面url 必填</span></span>
<span class="code-line">				  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				  msgtype<span class="token operator">:</span> <span class="token string">"video"</span><span class="token punctuation">,</span>    <span class="token comment">// 消息类型，必填</span></span>
<span class="code-line">				  video<span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">						mediaid<span class="token operator">:</span><span class="token string">""</span><span class="token punctuation">,</span>        <span class="token comment">// 视频的素材id</span></span>
<span class="code-line">				 <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">      <span class="token punctuation">]</span><span class="token punctuation">}</span><span class="token punctuation">,</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>res<span class="token punctuation">.</span>err_msg <span class="token operator">==</span> <span class="token string">"shareToExternalMoments:ok"</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">	<span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h4 id="%E5%8F%82%E6%95%B0" data-sign="8cb71f61557fabe1ccf527e1bd04a132" data-lines="2"><a class="anchor" href="#%E5%8F%82%E6%95%B0"></a>参数</h4><h5 id="object-object" data-sign="46276ba891600e417ac243f8fabb1b82" data-lines="2"><a class="anchor" href="#object-object"></a>Object object</h5><div class="cherry-table-container" data-sign="c9f4574fcfd888251a34e38ad6a99fe2" data-lines="15">
        <table class="cherry-table"><thead><tr><th>参数名</th><th>类型</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>text</td><td>Object</td><td>否</td><td>文本消息</td></tr><tr><td>text::content</td><td>string</td><td>否</td><td>消息文本内容，最多支持传入2000个字符，若超出长度报错'invalid text size'</td></tr><tr><td>attachments</td><td>Array</td><td>否</td><td>附件，最多支持9个图片类型，或者1个视频，或者1个链接。类型只能三选一，若传了不同类型，报错'invalid attachments msgtype'</td></tr><tr><td>msgtype</td><td>string</td><td>是</td><td>附件类型，可选image、link或者video</td></tr><tr><td>image</td><td>Object</td><td>否</td><td>图片消息附件。普通图片：建议不超过 1440 x 1080，长图片：长边建议不超过 10800px。图片建议不要超过10M。最多支持传入9个；超过9个报错'invalid attachments size'</td></tr><tr><td>image::mediaid</td><td>string</td><td>否</td><td>图片的素材id，若mediaid不为空，但是mediaid拉取资源出错，客户端会忽略该素材。可通过<a href="#10112" rel="nofollow">素材管理</a>接口获得</td></tr><tr><td>image::imgUrl</td><td>string</td><td>否</td><td>图片的链接，若拉取图片失败，客户端会忽略该素材。<strong>仅可使用<a href="#13219" rel="nofollow">上传图片</a>接口得到的链接</strong>，跟图片mediaid填其中一个即可</td></tr><tr><td>link</td><td>Object</td><td>否</td><td>图文消息附件。只支持1个；若超过1个报错'invalid attachments size'</td></tr><tr><td>link::title</td><td>string</td><td>否</td><td>图文消息标题，最多64个<strong>字节</strong></td></tr><tr><td>link::url</td><td>string</td><td>是</td><td>图文消息链接</td></tr><tr><td>link::imgUrl</td><td>string</td><td>否</td><td>图文消息封面图片URL</td></tr><tr><td>video</td><td>Object</td><td>否</td><td>视频消息附件，建议不超过 1280 x 720，帧率 30 FPS，视频码率 1.67 Mbps，最长不超过30S，最大建议不超过10MB。只支持1个；若超过1个报错'invalid attachments size'</td></tr><tr><td>video::mediaid</td><td>string</td><td>是</td><td>视频的素材id，未填写报错"invalid msg",若mediaid不为空，但是mediaid拉取资源出错，客户端会忽略该素材。可通过<a href="#10112" rel="nofollow">素材管理</a>接口获得</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><blockquote data-sign="95704e6242eb1420f3b700bf22e887d5_7" data-lines="7">* 企业微信3.1.12及以上版本支持,仅支持ios跟安卓。微信客户端不支持（微信开发者工具也不支持）。<br>* 必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态<br>* 应用需有<a href="#13473/%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E8%81%94%E7%B3%BB%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%BA%94%E7%94%A8" rel="nofollow">配置客户联系功能权限</a><br>* 当前成员必须<a href="#13473/%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E8%81%94%E7%B3%BB%E5%8A%9F%E8%83%BD%E7%9A%84%E6%88%90%E5%91%98" rel="nofollow">配置了客户联系功能</a><br>* 当前成员必须在客户朋友圈使用范围<br>* 当前成员必须具备外部沟通管理成员使用权限<br>* text和attachments不能同时为空（注：若text和attachments同时为空，报错'missing arguments'。）</blockquote><ul data-sign="840b33283da66773eb3cfcd22dd4f32alist1" data-lines="1" class="cherry-list__square"><li>attachments中每个附件信息必须与msgtype一致，例如，msgtype指定为image，则需要填写image::imgUrl或者image::mediaid，否则会报错"invalid msg"。mediaid和imgUrl只需填写一个，两者同时填写时使用media_id且imgUrl失效，二者不可同时为空。若附件中的mediaid失效，客户端将丢弃该条附件</li></ul><p data-sign="br4" data-type="br" data-lines="4">&nbsp;</p></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>