<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>开发案例演示 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        开发案例演示
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2021/03/18</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><h3 data-sign="08b6064f2d9a886fe6c2ba79e864faec" data-lines="1" id="c%E7%89%88%E6%9C%ACso%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><a class="anchor" href="#c%E7%89%88%E6%9C%ACso%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"></a>c版本so使用案例</h3><div data-sign="e42c44e01b943496cf1218a770c3a2b2" data-type="codeBlock" data-lines="145">
      <pre class="language-c"><code class="language-c wrap"><span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">"WeWorkFinanceSdk_C.h"</span></span></span>
<span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdio.h&gt;</span></span></span>
<span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h&gt;</span></span></span>
<span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h&gt;</span></span></span>
<span class="code-line"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string&gt;</span></span></span>
<span class="code-line">using std<span class="token operator">::</span>string<span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">// 私钥内容，示例</span></span>
<span class="code-line"><span class="token keyword">static</span> <span class="token keyword">const</span> <span class="token keyword">char</span><span class="token operator">*</span> priKey <span class="token operator">=</span> </span>
<span class="code-line"><span class="token string">"-----BEGIN RSA PRIVATE KEY-----\n"</span></span>
<span class="code-line"><span class="token string">"MIIEogIBAAKCAQEAngIe+L+lJFQOWu+FtgWzTYcG+bQTANvgatpjM0CswTLR5oY+\n"</span></span>
<span class="code-line"><span class="token string">"IvpQ9X0EID3AEC0PyaatOgSvmvWCUQunZtA3lhdkdsJG1Nxe1FOOI+Q1qlgW/ykT\n"</span></span>
<span class="code-line"><span class="token string">"JkuJJv8qnd9HFdpkTkkAB3CxW5zGoYYtBlnp3G3mUhGXZ/6dIWQ4Wln4lJlUlxSe\n"</span></span>
<span class="code-line"><span class="token string">"Qv4YvDOGN2dWbIG79nL9YNKyk9yYgLop2O7XJGXgqCuV5CUz4jdxB5XCH3SzqFgJ\n"</span></span>
<span class="code-line"><span class="token string">"A36JguG5jD7ovFh7cL+yp1iTyF/+1woDARXXpIj+W6K3Skoo5cpt0BboPYu0EuCz\n"</span></span>
<span class="code-line"><span class="token string">"YQtfn+hUfkcS6kltnwSXUBFzrSLhjCkf5tY/LwIDAQABAoIBADxB8M/KPk9hYuwZ\n"</span></span>
<span class="code-line"><span class="token string">"BjQJbny1btqRauHb+HSnfkdQddFj8RppvY6XSYKlP4qQIgvJM4kicFN87/83e5Au\n"</span></span>
<span class="code-line"><span class="token string">"0pNp+pjZqO2FX3/T3rI4fy9+21xwJaz/XBcxnUdq7jSwrqpN1Azq2AD+YBTg7/sv\n"</span></span>
<span class="code-line"><span class="token string">"cUJHzeDLZJeNr+Dv/7p5PuhuAVehm3g+b0GwuWK2HieXAlRR240vn+dCZoq8ti6Y\n"</span></span>
<span class="code-line"><span class="token string">"jmcZcJ9E6urY/L3d5bqByN2SGSbgJav6VAQYf8vfOU+SeAXFunGUWasuS3tvQlMO\n"</span></span>
<span class="code-line"><span class="token string">"eEPW37oNAsKHkKDQcKAcPo59fwPdbPKE/5N/wKPsbN8nVYTqdzociQdZnNpG8DK2\n"</span></span>
<span class="code-line"><span class="token string">"SdE5ZzkCgYEA4S3mNaklMA0vNR20lSum68j4L0r57Q7pN0ATmItBhF5ihEbtLlAg\n"</span></span>
<span class="code-line"><span class="token string">"OsLsxQZ2XIzevsnvUvRKDi7pcu3u2VqlX/89aWOcTOyEyKGHCUPkkOr4+3m2cGtQ\n"</span></span>
<span class="code-line"><span class="token string">"WF676TtNcfj4yOyJ5gMmtld84yUwrHjHgvtP/L73MftHzssQFj0Qk20CgYEAs6Ka\n"</span></span>
<span class="code-line"><span class="token string">"kXLAHtKwB5R/knXmkCYnfRX/TqjhTVO3Hr2PvqojAmiuWmWp9YsXtbYDFpxQPOp0\n"</span></span>
<span class="code-line"><span class="token string">"Y1qosC1qW+pZCXgSlsjsdhJa3t2hhsF2SAWoy2QpAsuHWizHq9T8XFb14U/4PjBz\n"</span></span>
<span class="code-line"><span class="token string">"B9P1mf5c84Iox3tUnwKuBsNt8FOXwJRPnddsH4sCgYB2zpLR6SaXzb0El2G5+sgd\n"</span></span>
<span class="code-line"><span class="token string">"S3G28iYfb2iZIBO2vnKY9nugMxPdBaWbm1D1O02j0yeLHlxJNl8EULgXTXZh87Oh\n"</span></span>
<span class="code-line"><span class="token string">"jLfILShAZeJBQQhQWSP1WiR3+mXJtrUzivg2PHXGFoic6kBvvWXlew+HgQ3HUgpi\n"</span></span>
<span class="code-line"><span class="token string">"D1rKja87Dct7TiR0t09RmQKBgBspvWG9Dlwa089xnxDQjzrA6ju59c85Lkh5Hjmh\n"</span></span>
<span class="code-line"><span class="token string">"xHi6VWzp02OL9/VPQRiTG0hx/pgXg936OYPaejjH6QrLg1QVsdvwzpjgvqoX2wDt\n"</span></span>
<span class="code-line"><span class="token string">"CicnUCRCDoeOOes726VC6Q9W/ly5CsvmOz87/WY9ClmPxq38w7/2EUvD+DCAvMFL\n"</span></span>
<span class="code-line"><span class="token string">"b+gdAoGAUiY1xefNe4qnbQzJXpPUUcOGiJcl7r9HwrZx8tDwGgBg+/5zbwi/0TfH\n"</span></span>
<span class="code-line"><span class="token string">"YrIj86g+JHaMEQCcKko8H0KdQzzp1vNECNxOGvz8ckOrO+NsLzHOpZ4jhojV/vFg\n"</span></span>
<span class="code-line"><span class="token string">"FNl6PhOdUozqTYwrnszoO67a/jKS/rWQh5Ta2Y2K5sUNprk8Z1w=\n"</span></span>
<span class="code-line"><span class="token string">"-----END RSA PRIVATE KEY-----\n"</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">// rsa 解密函数，需企业自行实现</span></span>
<span class="code-line"><span class="token keyword">int</span> <span class="token function">RsaDecryptChatData</span><span class="token punctuation">(</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>encryptdata<span class="token punctuation">,</span><span class="token keyword">const</span> string <span class="token operator">&amp;</span>priKey<span class="token punctuation">,</span>string <span class="token operator">&amp;</span>aeskey<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span>argv<span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span></span>
<span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">	<span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token keyword">if</span> <span class="token punctuation">(</span>argc <span class="token operator">&lt;</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="code-line">	<span class="token punctuation">{</span></span>
<span class="code-line">		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"./sdktools 1 seq limit proxy passwd timeout\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"./sdktools 2 fileid savefile proxy passwd timeout\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"./sdktools 3 encrypt_key encrypt_msg\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token punctuation">}</span></span>
<span class="code-line"></span>
<span class="code-line">	<span class="token comment">// new sdk api</span></span>
<span class="code-line">    WeWorkFinanceSdk_t<span class="token operator">*</span> sdk <span class="token operator">=</span> <span class="token function">NewSdk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">	<span class="token comment">// init api</span></span>
<span class="code-line">    ret <span class="token operator">=</span> <span class="token function">Init</span><span class="token punctuation">(</span>sdk<span class="token punctuation">,</span> <span class="token string">"wwd08coe7d775abaaa"</span><span class="token punctuation">,</span><span class="token string">"zJ6k0naVVQ--gt9PUSSEvs03zW_nlDVmjAkPOTAfrew"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">    <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line"></span>
<span class="code-line">       <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"init sdk err ret:%d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">	   <span class="token keyword">return</span> ret<span class="token punctuation">;</span></span>
<span class="code-line">    <span class="token punctuation">}</span></span>
<span class="code-line"></span>
<span class="code-line">    <span class="token keyword">int</span> type <span class="token operator">=</span>  <span class="token function">strtoul</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="code-line">	<span class="token punctuation">{</span></span>
<span class="code-line">		<span class="token class-name">uint64_t</span> iSeq <span class="token operator">=</span> <span class="token function">strtoul</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token class-name">uint64_t</span> iLimit <span class="token operator">=</span> <span class="token function">strtoul</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token class-name">uint64_t</span> timeout <span class="token operator">=</span> <span class="token function">strtoul</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        </span>
<span class="code-line">        Slice_t<span class="token operator">*</span> chatDatas <span class="token operator">=</span> <span class="token function">NewSlice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">		<span class="token comment">// getchatdata api</span></span>
<span class="code-line">        ret <span class="token operator">=</span> <span class="token function">GetChatData</span><span class="token punctuation">(</span>sdk<span class="token punctuation">,</span> iSeq<span class="token punctuation">,</span> iLimit<span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>argv<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> chatDatas<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"GetChatData err ret:%d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">            <span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"GetChatData len:%d data:%s\n"</span><span class="token punctuation">,</span> chatDatas<span class="token operator">-&gt;</span>len<span class="token punctuation">,</span> <span class="token function">GetContentFromSlice</span><span class="token punctuation">(</span>chatDatas<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token function">FreeSlice</span><span class="token punctuation">(</span>chatDatas<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token punctuation">}</span></span>
<span class="code-line">	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">2</span><span class="token punctuation">)</span></span>
<span class="code-line">	<span class="token punctuation">{</span></span>
<span class="code-line">		std<span class="token operator">::</span>string index <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token class-name">uint64_t</span> timeout <span class="token operator">=</span> <span class="token function">strtoul</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">6</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        </span>
<span class="code-line">		<span class="token keyword">while</span><span class="token punctuation">(</span>true<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"index:%s\n"</span><span class="token punctuation">,</span>index<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			MediaData_t<span class="token operator">*</span> media <span class="token operator">=</span> <span class="token function">NewMediaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">			<span class="token comment">// getmediadata api</span></span>
<span class="code-line">			ret <span class="token operator">=</span> <span class="token function">GetMediaData</span><span class="token punctuation">(</span>sdk<span class="token punctuation">,</span> index<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span>argv<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span>argv<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">,</span> timeout<span class="token punctuation">,</span> media<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">			<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"GetMediaData err ret:%d\n"</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token function">FreeMediaData</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"content size:%d isfin:%d outindex:%s\n"</span><span class="token punctuation">,</span><span class="token function">GetDataLen</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">IsMediaDataFinish</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">GetOutIndexBuf</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">			<span class="token keyword">char</span> file<span class="token punctuation">[</span><span class="token number">200</span><span class="token punctuation">]</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token function">snprintf</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>file<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"%s%s"</span><span class="token punctuation">,</span> <span class="token string">"/home/qspace/upload/"</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			FILE <span class="token operator">*</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>file<span class="token punctuation">,</span> <span class="token string">"ab+"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"filename:%s \n"</span><span class="token punctuation">,</span> file<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token constant">NULL</span> <span class="token operator">==</span> fp<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"open file err\n"</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token keyword">return</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line"></span>
<span class="code-line">			<span class="token function">fwrite</span><span class="token punctuation">(</span><span class="token function">GetData</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token function">GetDataLen</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">			<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">IsMediaDataFinish</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token function">FreeMediaData</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">			<span class="token keyword">else</span><span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token comment">// assign index value if not finish</span></span>
<span class="code-line">				index<span class="token punctuation">.</span><span class="token function">assign</span><span class="token punctuation">(</span><span class="token function">GetOutIndexBuf</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">				<span class="token comment">// need free media </span></span>
<span class="code-line">				<span class="token function">FreeMediaData</span><span class="token punctuation">(</span>media<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">		<span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">}</span> 	<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">        Slice_t<span class="token operator">*</span> msg <span class="token operator">=</span> <span class="token function">NewSlice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        std<span class="token operator">::</span>string encrypt_key<span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">		<span class="token comment">// rsa decrypt code .need do it by yourself</span></span>
<span class="code-line">        <span class="token keyword">int</span> ret <span class="token operator">=</span> <span class="token function">RsaDecryptChatData</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> priKey<span class="token punctuation">,</span> encrypt_key<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"Rsadecrypt key :%s ret :%d\n"</span> <span class="token punctuation">,</span>encrypt_key<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">		<span class="token comment">// decryptdata api</span></span>
<span class="code-line">        ret <span class="token operator">=</span> <span class="token function">DecryptData</span><span class="token punctuation">(</span>encrypt_key<span class="token punctuation">.</span><span class="token function">c_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"chatdata :%s ret :%d\n"</span> <span class="token punctuation">,</span><span class="token function">GetContentFromSlice</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token function">FreeSlice</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">    <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span>type <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="code-line">		Slice_t<span class="token operator">*</span> msg <span class="token operator">=</span> <span class="token function">NewSlice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		ret <span class="token operator">=</span> <span class="token function">DecryptData</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> argv<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"chatdata :%s ret :%d\n"</span> <span class="token punctuation">,</span><span class="token function">GetContentFromSlice</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">,</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token function">DestroySdk</span><span class="token punctuation">(</span>sdk<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">	<span class="token keyword">return</span> ret<span class="token punctuation">;</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><h3 data-sign="e03fa3c3a8b39410c744fc5a5525abcd" data-lines="1" id="java%E7%89%88%E6%9C%ACso%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"><a class="anchor" href="#java%E7%89%88%E6%9C%ACso%E4%BD%BF%E7%94%A8%E6%A1%88%E4%BE%8B"></a>java版本so使用案例</h3><div data-sign="1f223b286d91f4997a6edd848331d9f6" data-type="codeBlock" data-lines="104">
      <pre class="language-java"><code class="language-java wrap"><span class="code-line"><span class="token keyword">import</span> <span class="token namespace">com<span class="token punctuation">.</span>tencent<span class="token punctuation">.</span>wework<span class="token punctuation">.</span></span><span class="token class-name">Finance</span><span class="token punctuation">;</span></span>
<span class="code-line"><span class="token keyword">import</span> <span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token operator">*</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line"></span>
<span class="code-line"><span class="token keyword">public</span> <span class="token keyword">class</span> sdkdemo <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="code-line">        <span class="token keyword">long</span> sdk <span class="token operator">=</span> <span class="token class-name">Finance<span class="token punctuation">.</span>NewSdk</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token class-name">Finance<span class="token punctuation">.</span>Init</span><span class="token punctuation">(</span>sdk<span class="token punctuation">,</span>  <span class="token string">"wwd08coe7d775abaaa"</span><span class="token punctuation">,</span><span class="token string">"zJ6k0naVVQ--gt9PUSSEvs03zW_nlDVmjAkPOTAfrew"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token class-name">String</span> priKey <span class="token operator">=</span> </span>
<span class="code-line">            <span class="token string">"-----BEGIN RSA PRIVATE KEY-----\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"MIIEowIBAAKCAQEAjzJfnYgy8gI/UdR9OMzMh2/Svtz6ynPJdgqWX0qCm7361g04\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"Sz/g+aJGtqu8jRJNg3rxQhezoy5mc+//QDyL6sM0auASS+eWx2igxVahLhJEWef3\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"2woMrb+OHs6nJf2jBcfA494KvgkxSYXU84vl8UCHwUI839SLBSLWofb8ccFEmy9W\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"VSWY7EIUVV8pO8sLZ9uVWK1IrHHSrcGkx4SF913RDIxCTExj7bLqxNRklzWZgi3m\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"bYoIsTG6dmsGkmxagGPEtuVOI2UjpjQw1WyrN+6o+2+qpOIuoHKF5vGrPbQBL1jU\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"nshGs3MnwTWdxVOe+bw8a+VAqxpD5DlfdKamgQIDAQABAoIBAGNRbe3mPGeMVXyd\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"I6kUqrs5PPNyc2OdwVpk53z6QfJhZyu1iZjvmkuqWN9z59f0nNyXlePgapDAqwC4\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"sdJM7EKM17tU5HvPCc4O7ItSlYJN2yh8cnVy1+5ekOUfMeFwtPRaYpfpNowt9ghn\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"kZbGLlsRBddt6KjaUv3h9vnpQ5hlhU53slh+Zsdrsselpy0sTCF0ulVQgioZ6lzg\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"/Y61xCGxRWqq71UT/7EOZwIoD3NmLRZLE6vxm8uBrFvZZ5/jw9Z//8S+vgtRUgGj\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"/5v55ftTG+EOsaz2Zvt+jghkaEAchcyy5LyUv09Ir9eOYfjNAgeCk9dQv6E+2BiR\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"SvcUJEECgYEA5CvcoSpV66qC1T99/JqmqyTjORZ4ZKBJY9vos4uxNYfCbbhNJLDY\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"QAbCC234nBuKQ+3cVKkWtjBwfNp90mEmIoN6sYv+SdtVe2ofhJEqLMTiGyZPi2Iv\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"+vvRpFmiAUfWXqFzBy+3HSoTkRqbCytUIT7NXZZ3YwKbbIhyzABTzSkCgYEAoKlf\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"Gsn4rQEfmitAGJpuiSahih6KV3K+S9olnPbwd04YOw4u5UmouhyC7N0z2K8AO6zo\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"IkzCQtWQS1B1uaPE/stG7I/iy0CI6q46nSly5pajBBGQc+Y5ixRf23hEjGgca556\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"1pDyMs0Nb0J2AGDcr8olrbT1KwBvg8oWHOlA4ZkCgYAmC+pONXD+SwBl7qBjbqY8\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"A3qgGk8Y+GFEdXbn+XMjKfARu5mhdJuakYXpwfyiizUS/qaut0NCPfGD4Cr62Zgy\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"SRo8YMuWJSyr15ZJ1KrjrDDHtiutYkH959+dOBT7ga8NOH6lxB8Ujd+VYopX4nG0\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"2XQFFwHxUI36GwaJXcSbgQKBgEe4VERZNTHF9p2UASD6j62aGTLXP1qaVmj2ESRo\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"+B/KNPbn9fdVUoUChU/Hz4VDWg9JuLbXHUFIpQl5+ZPNj/tOM3MXKF8jh/t7m57d\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"CfX1+P+v95RFihqUFdabcb5cG5PPQ3bVbclP0FeCi7rPgrTWwMsypN91alKivAxb\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"9CLBAoGBALfb5SEupOoyIUetiWhOc1vlmP+71rJEXUEYwm0CMmfKZRW+I1A8qTE+\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"DVT6iUMVt6jj8L/YiMzjUh8y8HLcp4mlldzdfyjssZg6v2hABJcnID6o3DcTXA8k\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"8uMmaZZ0qY4oUzwgZa7bf/C//3mKlRUMoBYOT/LAksZlySIBXoST\n"</span> <span class="token operator">+</span></span>
<span class="code-line">            <span class="token string">"-----END RSA PRIVATE KEY-----\n"</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">		<span class="token keyword">long</span> ret <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span></span>
<span class="code-line"></span>
<span class="code-line">        <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"1"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token keyword">int</span> seq <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">            <span class="token keyword">int</span> limit <span class="token operator">=</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">            <span class="token keyword">long</span> slice <span class="token operator">=</span> <span class="token class-name">Finance<span class="token punctuation">.</span>NewSlice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">            ret <span class="token operator">=</span> <span class="token class-name">Finance<span class="token punctuation">.</span>GetChatData</span><span class="token punctuation">(</span>sdk<span class="token punctuation">,</span> seq<span class="token punctuation">,</span> limit<span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">5</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> slice<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">            <span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">                <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getchatdata ret "</span> <span class="token operator">+</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">                <span class="token keyword">return</span><span class="token punctuation">;</span></span>
<span class="code-line">            <span class="token punctuation">}</span></span>
<span class="code-line">            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getchatdata :"</span> <span class="token operator">+</span> <span class="token class-name">Finance<span class="token punctuation">.</span>GetContentFromSlice</span><span class="token punctuation">(</span>slice<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">            <span class="token class-name">Finance<span class="token punctuation">.</span>FreeSlice</span><span class="token punctuation">(</span>slice<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token punctuation">}</span> <span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"2"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line"></span>
<span class="code-line">			<span class="token class-name">String</span> indexbuf <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token keyword">while</span><span class="token punctuation">(</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token keyword">long</span> media_data <span class="token operator">=</span> <span class="token class-name">Finance<span class="token punctuation">.</span>NewMediaData</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">				ret <span class="token operator">=</span> <span class="token class-name">Finance<span class="token punctuation">.</span>GetMediaData</span><span class="token punctuation">(</span>sdk<span class="token punctuation">,</span> indexbuf<span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> args<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name">Integer</span><span class="token punctuation">.</span><span class="token function">parseInt</span><span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">,</span> media_data<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getmediadata ret:"</span> <span class="token operator">+</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token keyword">if</span><span class="token punctuation">(</span>ret<span class="token operator">!=</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="code-line">					<span class="token keyword">return</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token punctuation">}</span></span>
<span class="code-line">				<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"getmediadata outindex len:%d, data_len:%d, is_finis:%d\n"</span><span class="token punctuation">,</span><span class="token class-name">Finance<span class="token punctuation">.</span>GetIndexLen</span><span class="token punctuation">(</span>media_data<span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token class-name">Finance<span class="token punctuation">.</span>GetDataLen</span><span class="token punctuation">(</span>media_data<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token class-name">Finance<span class="token punctuation">.</span>IsMediaDataFinish</span><span class="token punctuation">(</span>media_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">                <span class="token keyword">try</span> <span class="token punctuation">{</span></span>
<span class="code-line">                    <span class="token class-name">FileOutputStream</span> outputStream  <span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileOutputStream</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string">"/home/qspace/upload/media_data"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">                    outputStream<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token class-name">Finance<span class="token punctuation">.</span>GetData</span><span class="token punctuation">(</span>media_data<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">                    outputStream<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">                <span class="token punctuation">}</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">                    e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">                <span class="token punctuation">}</span></span>
<span class="code-line"></span>
<span class="code-line">				<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token class-name">Finance<span class="token punctuation">.</span>IsMediaDataFinish</span><span class="token punctuation">(</span>media_data<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span><span class="token punctuation">)</span></span>
<span class="code-line">				<span class="token punctuation">{</span></span>
<span class="code-line">					<span class="token comment">// need free media_data</span></span>
<span class="code-line">					<span class="token class-name">Finance<span class="token punctuation">.</span>FreeMediaData</span><span class="token punctuation">(</span>media_data<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">					<span class="token keyword">break</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token punctuation">}</span></span>
<span class="code-line">				<span class="token keyword">else</span></span>
<span class="code-line">				<span class="token punctuation">{</span></span>
<span class="code-line">					indexbuf <span class="token operator">=</span> <span class="token class-name">Finance<span class="token punctuation">.</span>GetOutIndexBuf</span><span class="token punctuation">(</span>media_data<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">					</span>
<span class="code-line">					<span class="token comment">// need free media_data</span></span>
<span class="code-line">					<span class="token class-name">Finance<span class="token punctuation">.</span>FreeMediaData</span><span class="token punctuation">(</span>media_data<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">				<span class="token punctuation">}</span></span>
<span class="code-line">																																			             <span class="token punctuation">}</span></span>
<span class="code-line">        <span class="token punctuation">}</span><span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span>args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span><span class="token string">"3"</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token comment">// notice!</span></span>
<span class="code-line">			<span class="token comment">// // use prikey to decrpyt get args[1] by do it yourself</span></span>
<span class="code-line">			</span>
<span class="code-line">			<span class="token keyword">long</span> msg <span class="token operator">=</span> <span class="token class-name">Finance<span class="token punctuation">.</span>NewSlice</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			ret <span class="token operator">=</span> <span class="token class-name">Finance<span class="token punctuation">.</span>DecryptData</span><span class="token punctuation">(</span>sdk<span class="token punctuation">,</span>args<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token punctuation">,</span>args<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">,</span> msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token keyword">if</span> <span class="token punctuation">(</span>ret <span class="token operator">!=</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">			     <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getchatdata ret "</span> <span class="token operator">+</span> ret<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			         <span class="token keyword">return</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">			<span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"decrypt ret:"</span> <span class="token operator">+</span> ret <span class="token operator">+</span> <span class="token string">" msg:"</span> <span class="token operator">+</span> <span class="token class-name">Finance<span class="token punctuation">.</span>GetContentFromSlice</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">			<span class="token class-name">Finance<span class="token punctuation">.</span>FreeSlice</span><span class="token punctuation">(</span>msg<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">		<span class="token punctuation">}</span></span>
<span class="code-line">		<span class="token keyword">else</span> <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"wrong args "</span> <span class="token operator">+</span> args<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">        <span class="token class-name">Finance<span class="token punctuation">.</span>DestroySdk</span><span class="token punctuation">(</span>sdk<span class="token punctuation">)</span><span class="token punctuation">;</span></span>
<span class="code-line">    <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>