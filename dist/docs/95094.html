<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>企业发表内容到客户的朋友圈 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        企业发表内容到客户的朋友圈
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2025/09/11</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="51343e73cad28e1b3bcb04a84e2d0ee0-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E5%88%9B%E5%BB%BA%E5%8F%91%E8%A1%A8%E4%BB%BB%E5%8A%A1" class="level-2">创建发表任务</a></li><li class="toc-li"><a href="#%E8%8E%B7%E5%8F%96%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA%E7%BB%93%E6%9E%9C" class="level-2">获取任务创建结果</a></li></dir><h2 id="%E5%88%9B%E5%BB%BA%E5%8F%91%E8%A1%A8%E4%BB%BB%E5%8A%A1" data-sign="0a40c35ecb6cab5f9745105b0cb9d8b6" data-lines="1"><a class="anchor" href="#%E5%88%9B%E5%BB%BA%E5%8F%91%E8%A1%A8%E4%BB%BB%E5%8A%A1"></a>创建发表任务</h2><p data-sign="6d59072b319be3b4066e64b498afb11b" data-type="p" data-lines="1">企业和第三方应用可通过该接口创建客户朋友圈的发表任务。</p><p data-sign="aeb58793fccb6f6149ceee9b279aa631" data-type="p" data-lines="3"><strong>请求方式：</strong>POST(<strong>HTTPS</strong>)<br><strong>请求地址：</strong>https://qyapi.weixin.qq.com/cgi-bin/externalcontact/add_moment_task?access_token=ACCESS_TOKEN</p><p data-sign="0eaf88df03cd3784619d00af1ca68a35" data-type="p" data-lines="1"><strong>请求示例：</strong></p><div data-sign="793b6fa447641a57c852f6ac9dad8252" data-type="codeBlock" data-lines="38">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">	<span class="token string">"text"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">		<span class="token string">"content"</span><span class="token operator">:</span> <span class="token string">"文本消息内容"</span></span>
<span class="code-line">	<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">	<span class="token string">"attachments"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">		<span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token string">"msgtype"</span><span class="token operator">:</span> <span class="token string">"image"</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token string">"image"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token string">"media_id"</span><span class="token operator">:</span> <span class="token string">"MEDIA_ID"</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">		<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">		<span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token string">"msgtype"</span><span class="token operator">:</span> <span class="token string">"video"</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token string">"video"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token string">"media_id"</span><span class="token operator">:</span> <span class="token string">"MEDIA_ID"</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">		<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">		<span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token string">"msgtype"</span><span class="token operator">:</span> <span class="token string">"link"</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token string">"link"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token string">"title"</span><span class="token operator">:</span> <span class="token string">"消息标题"</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"url"</span><span class="token operator">:</span> <span class="token string">"https://example.link.com/path"</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"media_id"</span><span class="token operator">:</span> <span class="token string">"MEDIA_ID"</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">		<span class="token punctuation">}</span></span>
<span class="code-line">	<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line"> 	<span class="token string">"visible_range"</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">		<span class="token string">"sender_list"</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token string">"user_list"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"zhangshan"</span><span class="token punctuation">,</span><span class="token string">"lisi"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token string">"department_list"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span></span>
<span class="code-line">		<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">		<span class="token string">"external_contact_list"</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token string">"tag_list"</span><span class="token operator">:</span><span class="token punctuation">[</span> <span class="token string">"etXXXXXXXXXX"</span><span class="token punctuation">,</span> <span class="token string">"etYYYYYYYYYY"</span><span class="token punctuation">]</span></span>
<span class="code-line">		<span class="token punctuation">}</span></span>
<span class="code-line">	<span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="2"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="376393426c3ebf6cccef1d8309af339c" data-lines="21">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">必须</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">access_token</td><td align="left"></td><td align="left">调用接口凭证</td></tr><tr><td align="left">visible_range</td><td align="left">否</td><td align="left">指定的发表范围；若未指定，则表示执行者为应用可见范围内所有成员</td></tr><tr><td align="left">sender_list</td><td align="left">否</td><td align="left">发表任务的执行者列表，详见下文的“可见范围说明”</td></tr><tr><td align="left">sender_list.user_list</td><td align="left">否</td><td align="left">发表任务的执行者用户列表，最多支持10万个</td></tr><tr><td align="left">sender_list.department_list</td><td align="left">否</td><td align="left">发表任务的执行者部门列表</td></tr><tr><td align="left">external_contact_list</td><td align="left">否</td><td align="left">可见到该朋友圈的客户列表，详见下文的“可见范围说明”</td></tr><tr><td align="left">external_contact_list.tag_list</td><td align="left">否</td><td align="left">可见到该朋友圈的客户标签列表。<strong>注：这里仅支持企业客户标签，不支持规则组标签</strong></td></tr><tr><td align="left">text</td><td align="left">否</td><td align="left">文本消息</td></tr><tr><td align="left">text.content</td><td align="left">否</td><td align="left">消息文本内容，不能与附件同时为空，最多支持传入2000个字（4000个字节），若超出长度报错'invalid text size'</td></tr><tr><td align="left">attachments</td><td align="left">否</td><td align="left">附件，不能与text.content同时为空，最多支持9个图片类型，或者1个视频，或者1个链接。类型只能三选一，若传了不同类型，报错'invalid attachments msgtype'</td></tr><tr><td align="left">msgtype</td><td align="left">是</td><td align="left">附件类型，可选image、link或者video</td></tr><tr><td align="left">image</td><td align="left">否</td><td align="left">图片消息附件。最多支持传入9个；超过9个报错'invalid attachments size'</td></tr><tr><td align="left">image.media_id</td><td align="left">是</td><td align="left">图片的素材id，长边不超过10800像素，短边不超过1080像素。可通过<a href="#34657" rel="nofollow">上传附件资源</a>接口获得</td></tr><tr><td align="left">link</td><td align="left">否</td><td align="left">图文消息附件。只支持1个；若超过1个报错'invalid attachments size'</td></tr><tr><td align="left">link.title</td><td align="left">否</td><td align="left">图文消息标题，最多64个<strong>字</strong>(128个字节)</td></tr><tr><td align="left">link.url</td><td align="left">是</td><td align="left">图文消息链接</td></tr><tr><td align="left">link.media_id</td><td align="left">是</td><td align="left">图片链接封面，长边不超过10800像素，短边不超过1080像素，可通过<a href="#34657" rel="nofollow">上传附件资源</a>接口获得</td></tr><tr><td align="left">video</td><td align="left">否</td><td align="left">视频消息附件。最长不超过30S，最大不超过10MB。只支持1个；若超过1个报错'invalid attachments size'</td></tr><tr><td align="left">video.media_id</td><td align="left">是</td><td align="left">视频的素材id，未填写报错"invalid msg"。可通过<a href="#34657" rel="nofollow">上传附件资源</a>接口获得</td></tr></tbody></table></div><p data-sign="3ce6a49a54b4adfb38d2d40c3ba135d0" data-type="p" data-lines="2"><strong>可见范围说明</strong></p><p data-sign="c313f122e17b946bd8b34ff6ea3cd4ff" data-type="p" data-lines="2">visible_range，分以下几种情况：</p><ol data-sign="02cda3ef7af78a60455f6e66d6be2533list10" data-lines="10" class="cherry-list__default" start="1"><li>若只指定sender_list，则可见的客户范围为该部分执行者的客户，目前执行者支持传userid与部门id列表，注意不在应用可见范围内的执行者会被忽略。<br><br></li><li>若只指定external_contact_list，即指定了可见该朋友圈的目标客户（通过客户标签指定），此时会将该发表任务推给这些目标客户的应用可见范围内的跟进人。<br><br></li><li>若同时指定sender_list以及external_contact_list，会将该发表任务推送给同时满足以下条件的执行者：<br>（1）在sender_list中且在应用可见范围内的执行者；<br>（2）执行者有客户在external_contact_list当中。<br>执行者发表后仅external_contact_list指定的客户可见。<br><br></li><li>若未指定visible_range，则可见客户的范围为该应用可见范围内执行者的客户，执行者为应用可见范围内所有成员。</li></ol><p data-sign="7c5266c21493e820472c095f32d39771" data-type="p" data-lines="1"><em>注</em>：若指定external_contact_list列表，则该条朋友圈为部分可见；否则为公开</p><p data-sign="be69a8d80807fc12104a6f71258f88a9" data-type="p" data-lines="1"><strong>权限说明：</strong></p><ul data-sign="b1ee75e63f115b484bf5834df4a3cc49list5" data-lines="5" class="cherry-list__default"><li>企业需要使用配置到“<a href="#13473/%E5%BC%80%E5%A7%8B%E5%BC%80%E5%8F%91" rel="nofollow">可调用应用</a>”列表中的自建应用secret所获取的accesstoken来调用（<a href="#10013/%E7%AC%AC%E4%B8%89%E6%AD%A5%EF%BC%9A%E8%8E%B7%E5%8F%96access_token" rel="nofollow">accesstoken如何获取？</a>）。</li><li>自建应用调用，只会返回应用可见范围内用户的发送情况。</li><li>第三方应用或代开发自建应用调用需要企业授权<strong>客户朋友圈</strong>下<strong>发表到成员客户的朋友圈</strong>的权限</li><li>企业每个月允许通过api创建的朋友圈次数限制：10万</li><li>企业只允许创建10次/min。</li></ul><p data-sign="8c8bd07f58486862a201112e85376126" data-type="p" data-lines="1"><strong>返回结果：</strong></p><div data-sign="17fd1fca56e07db9f55113fe34543c1b" data-type="codeBlock" data-lines="7">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">	<span class="token string">"errcode"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">	<span class="token string">"errmsg"</span><span class="token operator">:</span><span class="token string">"ok"</span><span class="token punctuation">,</span></span>
<span class="code-line">	<span class="token string">"jobid"</span><span class="token operator">:</span><span class="token string">"xxxx"</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="2"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="32144138dc2bd37ea5b3844aaf1bb423" data-lines="5">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">errcode</td><td align="left">返回码</td></tr><tr><td align="left">errmsg</td><td align="left">对返回码的文本描述内容</td></tr><tr><td align="left">jobid</td><td align="left">异步任务id，最大长度为64字节，24小时有效；可使用<a href="#%E8%8E%B7%E5%8F%96%E5%8F%91%E8%A1%A8%E6%9C%8B%E5%8F%8B%E5%9C%88%E4%BB%BB%E5%8A%A1%E7%BB%93%E6%9E%9C" rel="nofollow">获取发表朋友圈任务结果</a>查询任务状态</td></tr></tbody></table></div><h2 id="%E8%8E%B7%E5%8F%96%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA%E7%BB%93%E6%9E%9C" data-sign="2bcd4a96a23426733e21d68e0e91f7c6" data-lines="2"><a class="anchor" href="#%E8%8E%B7%E5%8F%96%E4%BB%BB%E5%8A%A1%E5%88%9B%E5%BB%BA%E7%BB%93%E6%9E%9C"></a>获取任务创建结果</h2><p data-sign="d474103fd6f46382c31c80f92f82e570" data-type="p" data-lines="3">由于发表任务的创建是异步执行的，应用需要再调用该接口以获取创建的结果。<br><strong>请求方式：</strong>GET（<strong>HTTPS</strong>）<br><strong>请求地址：</strong>https://qyapi.weixin.qq.com/cgi-bin/externalcontact/get_moment_task_result?access_token=ACCESS_TOKEN&amp;jobid=JOBID</p><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="1"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="d893b592025fdd11e43feb38e21abd1e" data-lines="4">
        <table class="cherry-table"><thead><tr><th>参数</th><th>必须</th><th>说明</th></tr></thead><tbody><tr><td>access_token</td><td>是</td><td>调用接口凭证</td></tr><tr><td>jobid</td><td>是</td><td>异步任务id，最大长度为64字节，由<a href="#%E5%88%9B%E5%BB%BA%E5%8F%91%E8%A1%A8%E5%86%85%E5%AE%B9%E5%88%B0%E5%AE%A2%E6%88%B7%E6%9C%8B%E5%8F%8B%E5%9C%88%E4%BB%BB%E5%8A%A1" rel="nofollow">创建发表内容到客户朋友圈任务</a>接口获取</td></tr></tbody></table></div><p data-sign="be69a8d80807fc12104a6f71258f88a9" data-type="p" data-lines="2"><strong>权限说明：</strong></p><p data-sign="1c7fb415da8be27fe01cf1fb3e333331" data-type="p" data-lines="2">只能查询已经提交过的历史任务。</p><p data-sign="8c8bd07f58486862a201112e85376126" data-type="p" data-lines="2"><strong>返回结果：</strong></p><div data-sign="5245a1e73e95db15e12d0f767efa51ac" data-type="codeBlock" data-lines="23">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token string">"errcode"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token string">"errmsg"</span><span class="token operator">:</span> <span class="token string">"ok"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token string">"status"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token string">"type"</span><span class="token operator">:</span> <span class="token string">"add_moment_task"</span><span class="token punctuation">,</span></span>
<span class="code-line">	<span class="token string">"result"</span><span class="token operator">:</span> <span class="token punctuation">{</span></span>
<span class="code-line">		<span class="token string">"errcode"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">		<span class="token string">"errmsg"</span><span class="token operator">:</span><span class="token string">"ok"</span><span class="token punctuation">,</span></span>
<span class="code-line">		<span class="token string">"moment_id"</span><span class="token operator">:</span><span class="token string">"xxxx"</span><span class="token punctuation">,</span></span>
<span class="code-line">		<span class="token string">"invalid_sender_list"</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token string">"user_list"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"zhangshan"</span><span class="token punctuation">,</span><span class="token string">"lisi"</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token string">"department_list"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">,</span><span class="token number">3</span><span class="token punctuation">]</span></span>
<span class="code-line">		<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">		<span class="token string">"invalid_external_contact_list"</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">			<span class="token string">"tag_list"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"xxx"</span><span class="token punctuation">]</span></span>
<span class="code-line">		<span class="token punctuation">}</span></span>
<span class="code-line">	<span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span>
<span class="code-line"></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="1"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="d9d706d4a750d597831302a55bf26cc4" data-lines="11">
        <table class="cherry-table"><thead><tr><th>参数</th><th>说明</th></tr></thead><tbody><tr><td>errcode</td><td>返回码</td></tr><tr><td>errmsg</td><td>对返回码的文本描述内容</td></tr><tr><td>status</td><td>任务状态，整型，1表示开始创建任务，2表示正在创建任务中，3表示创建任务已完成</td></tr><tr><td>type</td><td>操作类型，字节串，此处固定为add_moment_task</td></tr><tr><td>result</td><td>详细的处理结果。当任务完成后此字段有效</td></tr><tr><td>result.errcode</td><td>返回码</td></tr><tr><td>result.errmsg</td><td>对返回码的文本描述内容</td></tr><tr><td>result.moment_id</td><td>朋友圈id，可通过<a href="#25254/%E8%8E%B7%E5%8F%96%E5%AE%A2%E6%88%B7%E6%9C%8B%E5%8F%8B%E5%9C%88%E4%BC%81%E4%B8%9A%E5%8F%91%E8%A1%A8%E7%9A%84%E5%88%97%E8%A1%A8" rel="nofollow">获取客户朋友圈企业发表的列表</a>接口获取朋友圈企业发表的列表</td></tr><tr><td>result.invalid_sender_list</td><td>不合法的执行者列表，包括不存在的id以及不在应用可见范围内的部门或者成员</td></tr></tbody></table></div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>