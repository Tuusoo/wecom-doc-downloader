<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>获取成员假期余额 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        获取成员假期余额
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2023/12/01</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><p data-sign="e181bfce0881535468c7cbc026fd075f" data-type="p" data-lines="1">通过本接口可获取应用可见范围内各个员工的假期余额数据。</p><p data-sign="b5e5164a475a80f71b1c3e343c2fa5c0" data-type="p" data-lines="2"><strong>请求方式：</strong>POST(<strong>HTTPS</strong>)</p><p data-sign="4dd536a6f416c9e40bb5b00ff55554c9" data-type="p" data-lines="2"><strong>请求地址：</strong>https://qyapi.weixin.qq.com/cgi-bin/oa/vacation/getuservacationquota?access_token=ACCESS_TOKEN</p><p data-sign="8b8b131af4d7916d08149d0729990346" data-type="p" data-lines="2"><strong>请求示例</strong></p><div data-sign="b63afa9fa893410d9464dee2844e8972" data-type="codeBlock" data-lines="6">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"userid"</span><span class="token operator">:</span> <span class="token string">"ZhangSan"</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="2"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="2b81e332b2724bc782e63544188a241c" data-lines="4">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">必须</th><th align="left">类型</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">access_token</td><td align="left">是</td><td align="left">string</td><td align="left">调用接口凭证。必须使用第三方应用accesstoken获取，获取方式参考：<a href="https://work.weixin.qq.com/api/doc/90001/90143/90605" rel="nofollow">文档-获取access_token</a></td></tr><tr><td align="left">userid</td><td align="left">是</td><td align="left">string</td><td align="left">需要获取假期余额的成员的userid</td></tr></tbody></table></div><p data-sign="ead0b8626d017850354715630c15b56b" data-type="p" data-lines="1"><strong>权限说明：</strong> </p><div class="cherry-table-container" data-sign="9ea60c837b32040556e2114d37955696" data-lines="5">
        <table class="cherry-table"><thead><tr><th>应用类型</th><th>权限要求</th></tr></thead><tbody><tr><td>自建应用</td><td>配置到「<a href="#17893/%E9%85%8D%E7%BD%AE%E5%8F%AF%E8%B0%83%E7%94%A8%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%BA%94%E7%94%A8" rel="nofollow">审批 - 可调用接口的应用</a>」中</td></tr><tr><td>代开发应用</td><td>具有「审批」权限</td></tr><tr><td>第三方应用</td><td>具有「审批」权限</td></tr></tbody></table></div><blockquote data-sign="1769f92d10d229cf9355197df095cf58_2" data-lines="2">1.第三方应用可以获取第三方应用添加的模板详情。<br>2.自建应用的Secret可获取企业自建模板的模板详情。<br>3.接口调用频率限制为600次/分钟。</blockquote><p data-sign="4500ae644890b2a3e6568b5481167358" data-type="p" data-lines="2"><em>注：</em> 从2023年12月1日0点起，不再支持通过系统应用secret调用接口，存量企业暂不受影响 <a href="https://developer.work.weixin.qq.com/document/51165" rel="nofollow">查看详情</a></p><p data-sign="8c8bd07f58486862a201112e85376126" data-type="p" data-lines="2"><strong>返回结果：</strong></p><div data-sign="d3b3fd5fd28ed422207a2f0af05937d4" data-type="codeBlock" data-lines="33">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token property">"errcode"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"errmsg"</span><span class="token operator">:</span> <span class="token string">"ok"</span><span class="token punctuation">,</span></span>
<span class="code-line">    <span class="token property">"lists"</span><span class="token operator">:</span> <span class="token punctuation">[</span></span>
<span class="code-line">        <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"assignduration"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"usedduration"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"leftduration"</span><span class="token operator">:</span> <span class="token number">604800</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"vacationname"</span><span class="token operator">:</span> <span class="token string">"年假"</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token property">"real_assignduration"</span><span class="token operator">:</span> <span class="token number">0</span></span>
<span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">2</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"assignduration"</span><span class="token operator">:</span> <span class="token number">1296000</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"usedduration"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"leftduration"</span><span class="token operator">:</span> <span class="token number">1296000</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"vacationname"</span><span class="token operator">:</span> <span class="token string">"事假"</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token property">"real_assignduration"</span><span class="token operator">:</span> <span class="token number">1296000</span></span>
<span class="code-line">        <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">        <span class="token punctuation">{</span></span>
<span class="code-line">            <span class="token property">"id"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"assignduration"</span><span class="token operator">:</span> <span class="token number">1296000</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"usedduration"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"leftduration"</span><span class="token operator">:</span> <span class="token number">1296000</span><span class="token punctuation">,</span></span>
<span class="code-line">            <span class="token property">"vacationname"</span><span class="token operator">:</span> <span class="token string">"病假"</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token property">"real_assignduration"</span><span class="token operator">:</span> <span class="token number">86400</span></span>
<span class="code-line">        <span class="token punctuation">}</span></span>
<span class="code-line">    <span class="token punctuation">]</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="2"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="1cf537b61d0f995c3b357879133e4596" data-lines="11">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">类型</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">errcode</td><td align="left">int32</td><td align="left">错误码，详情见错误码说明</td></tr><tr><td align="left">errmsg</td><td align="left">string</td><td align="left">错误码对应的错误信息提示</td></tr><tr><td align="left">lists</td><td align="left">obj[]</td><td align="left">假期列表</td></tr><tr><td align="left">lists.id</td><td align="left">int32</td><td align="left">假期id</td></tr><tr><td align="left">lists.assignduration</td><td align="left">uint32</td><td align="left">发放时长，单位为秒</td></tr><tr><td align="left">lists.usedduration</td><td align="left">uint32</td><td align="left">使用时长，单位为秒</td></tr><tr><td align="left">lists.leftduration</td><td align="left">uint32</td><td align="left">剩余时长，单位为秒</td></tr><tr><td align="left">lists.vacationname</td><td align="left">string</td><td align="left">假期名称</td></tr><tr><td align="left">lists.real_assignduration</td><td align="left">uint32</td><td align="left">假期的实际发放时长，通常在设置了按照实际工作时间发放假期后进行计算</td></tr></tbody></table></div><blockquote data-sign="758bc4188755f195d1f42e5c96c56afe_1" data-lines="1">接口频率限制 600次/分钟<br>注：余额的时长单位都为秒，如果假期时间刻度为“按天”，需要除以86400，得到真实假期余额天数；如果假期时间刻度为“按小时”，需要除以3600得到真实假期余额小时数。</blockquote><p data-sign="0be5475ec20788fd60322d08598315a7" data-type="p" data-lines="2"><strong>错误说明：</strong></p><div class="cherry-table-container" data-sign="8f89815a96ca0c439a75a07d11c74f4b" data-lines="5">
        <table class="cherry-table"><thead><tr><th align="left">错误码</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">301062</td><td align="left">没有假勤权限</td></tr><tr><td align="left">301063</td><td align="left">参数错误</td></tr><tr><td align="left">301064</td><td align="left">内部错误</td></tr></tbody></table></div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>