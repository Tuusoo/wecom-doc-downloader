<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>获取观看直播统计 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        获取观看直播统计
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2024/07/19</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><p data-sign="c936c8026e581a016235b56ec9e68a01" data-type="p" data-lines="1">通过该接口可以获取所有观看直播的人员统计</p><p data-sign="a7fb599a45c3a5ee0e0168579ded8277" data-type="p" data-lines="3"><strong>请求方式：</strong>POST（<strong>HTTPS</strong>）<br><strong>请求地址：</strong>https://qyapi.weixin.qq.com/cgi-bin/school/living/get_watch_stat?access_token=ACCESS_TOKEN</p><p data-sign="382edfac6a8b56ec46332834f416136e" data-type="p" data-lines="2"><strong>请求包体：</strong></p><div data-sign="848b42e0700117a0771b65192ae84fe6" data-type="codeBlock" data-lines="8">
      <pre class="language-json"><code class="language-json wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">	<span class="token property">"livingid"</span><span class="token operator">:</span> <span class="token string">"livingid1"</span><span class="token punctuation">,</span></span>
<span class="code-line">	<span class="token property">"next_key"</span><span class="token operator">:</span> <span class="token string">"NEXT_KEY"</span></span>
<span class="code-line"><span class="token punctuation">}</span></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="2"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="030e697f1ea8d258f289600d9fc13b54" data-lines="5">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">必须</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">access_token</td><td align="left">是</td><td align="left">调用接口凭证</td></tr><tr><td align="left">livingid</td><td align="left">是</td><td align="left">直播的id</td></tr><tr><td align="left">next_key</td><td align="left">否</td><td align="left">上一次调用时返回的next_key，初次调用可以填"0"</td></tr></tbody></table></div><p data-sign="be69a8d80807fc12104a6f71258f88a9" data-type="p" data-lines="1"><strong>权限说明：</strong></p><div class="cherry-table-container" data-sign="8ae8e8773675c01f48e6e1efc21fb76d" data-lines="5">
        <table class="cherry-table"><thead><tr><th>应用类型</th><th>权限要求</th></tr></thead><tbody><tr><td>自建应用</td><td>配置到「<span style="color:#ff0000">上课直播 - 可调用接口的应用</span>」和「<span style="color:#ff0000">家长可以使用的应用</span>」中</td></tr><tr><td>代开发应用</td><td>具有「直播」和「家校沟通」权限</td></tr><tr><td>第三方应用</td><td>具有「直播」和「家校沟通」权限</td></tr></tbody></table></div><ul data-sign="3328698e08ba15cb9a4b5751ba750c1flist2" data-lines="2" class="cherry-list__default"><li>自建应用必须通知配置到「上课直播」和家长可以使用的应用中</li><li>只能获取本应用创建的直播</li></ul><p data-sign="4500ae644890b2a3e6568b5481167358" data-type="p" data-lines="1"><em>注：</em> 从2023年12月1日0点起，不再支持通过系统应用secret调用接口，存量企业暂不受影响 <a href="https://developer.work.weixin.qq.com/document/51165" rel="nofollow">查看详情</a></p><p data-sign="8c8bd07f58486862a201112e85376126" data-type="p" data-lines="2"><strong>返回结果：</strong></p><div data-sign="47944085796bb287daf04f9ecc0950e3" data-type="codeBlock" data-lines="51">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token punctuation">{</span></span>
<span class="code-line">   <span class="token string">"errcode"</span><span class="token operator">:</span> <span class="token number">0</span><span class="token punctuation">,</span></span>
<span class="code-line">   <span class="token string">"errmsg"</span><span class="token operator">:</span> <span class="token string">"ok"</span><span class="token punctuation">,</span></span>
<span class="code-line">   <span class="token string">"ending"</span><span class="token operator">:</span><span class="token number">1</span><span class="token punctuation">,</span></span>
<span class="code-line">   <span class="token string">"next_key"</span><span class="token operator">:</span> <span class="token string">"NEXT_KEY"</span><span class="token punctuation">,</span></span>
<span class="code-line">   <span class="token string">"stat_infoes"</span><span class="token operator">:</span><span class="token punctuation">{</span></span>
<span class="code-line">		<span class="token string">"students"</span><span class="token operator">:</span><span class="token punctuation">[</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token string">"student_userid"</span><span class="token operator">:</span> <span class="token string">"zhansan_child"</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"parent_userid"</span><span class="token operator">:</span> <span class="token string">"zhangsan"</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"partyids"</span><span class="token operator">:</span><span class="token punctuation">[</span></span>
<span class="code-line">					<span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span></span>
<span class="code-line">				<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"watch_time"</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"enter_time"</span><span class="token operator">:</span> <span class="token number">1586433904</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"leave_time"</span><span class="token operator">:</span> <span class="token number">1586434000</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"is_comment"</span><span class="token operator">:</span> <span class="token number">1</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token string">"student_userid"</span><span class="token operator">:</span> <span class="token string">"lisi_child"</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"parent_userid"</span><span class="token operator">:</span> <span class="token string">"lisi"</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"partyids"</span><span class="token operator">:</span><span class="token punctuation">[</span></span>
<span class="code-line">					<span class="token number">10</span><span class="token punctuation">,</span><span class="token number">11</span></span>
<span class="code-line">				<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"watch_time"</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"enter_time"</span><span class="token operator">:</span> <span class="token number">1586433904</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"leave_time"</span><span class="token operator">:</span> <span class="token number">1586434000</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"is_comment"</span><span class="token operator">:</span> <span class="token number">0</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">		<span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">		<span class="token string">"visitors"</span><span class="token operator">:</span><span class="token punctuation">[</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token string">"nickname"</span><span class="token operator">:</span> <span class="token string">"wx_nickname1"</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"watch_time"</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"enter_time"</span><span class="token operator">:</span> <span class="token number">1586433904</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"leave_time"</span><span class="token operator">:</span> <span class="token number">1586434000</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"is_comment"</span><span class="token operator">:</span> <span class="token number">1</span></span>
<span class="code-line">			<span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">			<span class="token punctuation">{</span></span>
<span class="code-line">				<span class="token string">"nickname"</span><span class="token operator">:</span> <span class="token string">"wx_nickname2"</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"watch_time"</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"enter_time"</span><span class="token operator">:</span> <span class="token number">1586433904</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"leave_time"</span><span class="token operator">:</span> <span class="token number">1586434000</span><span class="token punctuation">,</span></span>
<span class="code-line">				<span class="token string">"is_comment"</span><span class="token operator">:</span> <span class="token number">0</span></span>
<span class="code-line">			<span class="token punctuation">}</span></span>
<span class="code-line">		<span class="token punctuation">]</span></span>
<span class="code-line">   <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="f2e21495051cadd2d5b0f8a3eedbae8d" data-type="p" data-lines="1"><strong>参数说明：</strong></p><div class="cherry-table-container" data-sign="34a9bb40cd02a44b8a41406e616f3c52" data-lines="21">
        <table class="cherry-table"><thead><tr><th align="left">参数</th><th align="left">说明</th></tr></thead><tbody><tr><td align="left">errcode</td><td align="left">返回码</td></tr><tr><td align="left">errmsg</td><td align="left">对返回码的文本描述内容</td></tr><tr><td align="left">ending</td><td align="left">是否结束。0：表示还有更多数据，需要继续拉取，1：表示已经拉取完所有数据。注意只能根据该字段判断是否已经拉完数据</td></tr><tr><td align="left">next_key</td><td align="left">当前数据最后一个key值，如果下次调用带上该值则从该key值往后拉，用于实现分页拉取</td></tr><tr><td align="left">stat_infoes</td><td align="left">统计信息列表</td></tr><tr><td align="left">stat_infoes.students</td><td align="left">观看直播的学生列表</td></tr><tr><td align="left">stat_infoes.students.student_userid</td><td align="left">学生的userid</td></tr><tr><td align="left">stat_infoes.students.parent_userid</td><td align="left">家长的userid，直播参与者是家长身份才展示，学生身份加入直播不展示</td></tr><tr><td align="left">stat_infoes.students.partyids</td><td align="left">学生所在的班级id列表</td></tr><tr><td align="left">stat_infoes.students.watch_time</td><td align="left">观看时长，单位为秒</td></tr><tr><td align="left">stat_infoes.students.enter_time</td><td align="left">首次进入直播时间</td></tr><tr><td align="left">stat_infoes.students.leave_time</td><td align="left">最后离开直播时间</td></tr><tr><td align="left">stat_infoes.students.is_comment</td><td align="left">是否评论，1表示评论，0表示没有评论</td></tr><tr><td align="left">stat_infoes.visitors</td><td align="left">观看直播的游客列表</td></tr><tr><td align="left">stat_infoes.visitors.nickname</td><td align="left">微信昵称</td></tr><tr><td align="left">stat_infoes.visitors.watch_time</td><td align="left">观看时长，单位为秒</td></tr><tr><td align="left">stat_infoes.visitors.enter_time</td><td align="left">首次进入直播时间</td></tr><tr><td align="left">stat_infoes.visitors.leave_time</td><td align="left">最后离开直播时间</td></tr><tr><td align="left">stat_infoes.visitors.is_comment</td><td align="left">是否评论，1表示评论，0表示没有评论</td></tr></tbody></table></div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>