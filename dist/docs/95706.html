<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>聊天工具栏接口 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        聊天工具栏接口
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2022/07/27</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="bc6b014a7cc43817bf7e111740da679c-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E6%A6%82%E8%BF%B0" class="level-2">概述</a></li><li class="toc-li"><a href="#%E6%8E%A5%E5%8F%A3%E8%AF%B4%E6%98%8E" class="level-2">接口说明</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#getcontext" class="level-3">getContext</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%B8%8A%E4%B8%8B%E6%B8%B8%E8%81%94%E7%B3%BB%E4%BA%BAuserid" class="level-3">获取当前上下游联系人userid</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%B8%8A%E4%B8%8B%E6%B8%B8%E4%BA%92%E8%81%94%E7%BE%A4%E7%9A%84%E7%BE%A4id" class="level-3">获取当前上下游互联群的群ID</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%88%86%E4%BA%AB%E6%B6%88%E6%81%AF%E5%88%B0%E5%BD%93%E5%89%8D%E4%BC%9A%E8%AF%9D" class="level-3">分享消息到当前会话</a></li></dir><h2 id="%E6%A6%82%E8%BF%B0" data-sign="9a8437ccee43ad66c084b8dfd3d259d3" data-lines="2"><a class="anchor" href="#%E6%A6%82%E8%BF%B0"></a>概述</h2><p data-sign="7aa5d9a77fa4d41eebfe063f4764c991" data-type="p" data-lines="2">企业可将应用页面配置到上下游聊天工具栏，方便接待人员在与上下游联系人的聊天中查看和使用，提高服务效率。从工具栏打开的页面，除了一般的小程序接口之外，可以使用有会话属性的接口，例如：获取当前联系人userid、分享消息到当前会话。当然，开发者首先需要调用getContext接口获取当前入口entry值，以此判断是否从上下游工具栏进入页面。</p><h2 id="%E6%8E%A5%E5%8F%A3%E8%AF%B4%E6%98%8E" data-sign="3ee63dd18c817dfdbd95d92975b82eab" data-lines="2"><a class="anchor" href="#%E6%8E%A5%E5%8F%A3%E8%AF%B4%E6%98%8E"></a>接口说明</h2><h3 id="getcontext" data-sign="3d28d5e69c85aba8b79697c8c0683830" data-lines="2"><a class="anchor" href="#getcontext"></a>getContext</h3><p data-sign="f5586726bfa34426798ee827e71a059b" data-type="p" data-lines="2">接口使用说明详见“<a href="#21951" rel="nofollow">wx.qy.getContext</a>”，在上下游聊天工具栏里返回的entry值是chain_single_chat_tools或chain_group_chat_tools，具体如下：</p><p data-sign="cc4a2fd4bedea2795ecb872a9d95dd67" data-type="p" data-lines="2">返回结果 <strong>entry</strong> 说明</p><div class="cherry-table-container" data-sign="874e2a6a305eafee821dc86055440f8f" data-lines="10">
        <table class="cherry-table"><thead><tr><th>值</th><th>说明</th><th>支持的最低版本</th></tr></thead><tbody><tr><td>contact_profile</td><td>从联系人详情进入</td><td>3.0.24</td></tr><tr><td>single_chat_tools</td><td>从单聊会话的工具栏进入</td><td>3.0.24</td></tr><tr><td>group_chat_tools</td><td>从群聊会话的工具栏进入</td><td>3.0.24</td></tr><tr><td>chat_attachment</td><td>从会话的聊天附件栏进入</td><td>3.1.6</td></tr><tr><td>single_kf_tools</td><td>从微信客服的工具栏进入</td><td>3.1.10</td></tr><tr><td><strong>chain_single_chat_tools</strong></td><td><strong>从上下游单聊会话的工具栏进入</strong></td><td>4.0.8</td></tr><tr><td><strong>chain_group_chat_tools</strong></td><td><strong>从上下游群聊会话的工具栏进入</strong></td><td>4.0.8</td></tr><tr><td>normal</td><td>除以上场景之外进入，例如工作台，聊天会话等</td><td>3.0.24</td></tr></tbody></table></div><h3 id="%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%B8%8A%E4%B8%8B%E6%B8%B8%E8%81%94%E7%B3%BB%E4%BA%BAuserid" data-sign="2a1941e331d5cf6609cfd10ece2aea37" data-lines="2"><a class="anchor" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%B8%8A%E4%B8%8B%E6%B8%B8%E8%81%94%E7%B3%BB%E4%BA%BAuserid"></a>获取当前上下游联系人userid</h3><blockquote data-sign="e4ccd2622876db1f7b89f4b514d7384b_5" data-lines="5"><strong>调用前提：</strong><br>此接口仅在企业微信4.0.8及以后版本支持，微信端不支持（微信开发者工具也不支持），仅支持ios，android和PC端调用<br>必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态<br>当前成员必须在应用的可见范围。<br>需要从上下游会话的工具栏进入页面才可调用，否则会报错：“only support chain group chat tools entry”，可先通过调用<a href="#21951" rel="nofollow">wx.qy.getContext</a>来判断进入小程序的入口。</blockquote><div class="cherry-table-container" data-sign="105b6fbcd22a4b075ef3acbbcb2890d0" data-lines="3">
        <table class="cherry-table"><thead><tr><th>入口</th><th>getContext的entry值</th><th>自建应用</th><th>第三方应用</th><th>用户</th><th>支持的最低版本</th></tr></thead><tbody><tr><td>上下游单聊会话的工具栏</td><td>chain_single_chat_tools</td><td>所有</td><td>所有</td><td>所有</td><td>4.0.8</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="3bbe378bfec626ca99632a23bd5fe229" data-type="p" data-lines="2"><strong>参数</strong><br><strong>Object object</strong></p><div class="cherry-table-container" data-sign="6bbd907124a2c2e9d706f602221a0648" data-lines="5">
        <table class="cherry-table"><thead><tr><th>参数名</th><th>类型</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>success</td><td>Function</td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>Function</td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>Function</td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="76eadcfe7a03d934cb337c22990151b8" data-type="p" data-lines="2"><strong>object.success 回调函数</strong><br><strong>参数</strong></p><p data-sign="2af9fbc618b17cf6a6fb5cb8c9589844" data-type="p" data-lines="2"><strong>Object res</strong></p><div class="cherry-table-container" data-sign="6fe8835ea92bd9b403164ac609152fe8" data-lines="4">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>corpId</td><td>String</td><td>返回当前上下游联系人所在的企业corpId</td></tr><tr><td>userId</td><td>String</td><td>返回当前上下游联系人的userId</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="8349d1aef0548ab082591d41e79adaef" data-type="p" data-lines="1"><strong>示例代码：</strong></p><div data-sign="eeacdc2adb80ffee9d14343e1680dcf8" data-type="codeBlock" data-lines="11">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line"></span>
<span class="code-line">wx<span class="token punctuation">.</span>qy<span class="token punctuation">.</span><span class="token function">getCurCorpGroupContact</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token keyword">var</span> corpId <span class="token operator">=</span> res<span class="token punctuation">.</span>corpId<span class="token punctuation">;</span> <span class="token comment">// 返回当前联系人的企业corpId</span></span>
<span class="code-line">    <span class="token keyword">var</span> userId <span class="token operator">=</span> res<span class="token punctuation">.</span>userId <span class="token comment">//返回当前联系人userId</span></span>
<span class="code-line">  <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h3 id="%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%B8%8A%E4%B8%8B%E6%B8%B8%E4%BA%92%E8%81%94%E7%BE%A4%E7%9A%84%E7%BE%A4id" data-sign="5631b7d9e6279e755cbde0e3f044d2e2" data-lines="2"><a class="anchor" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E4%B8%8A%E4%B8%8B%E6%B8%B8%E4%BA%92%E8%81%94%E7%BE%A4%E7%9A%84%E7%BE%A4id"></a>获取当前上下游互联群的群ID</h3><blockquote data-sign="1a6302765fd27641a797545b4837487d_5" data-lines="5"><strong>调用前提：</strong><br>此接口仅在企业微信4.0.12及以后版本支持，微信端不支持（微信开发者工具也不支持），仅支持ios，android和PC端调用<br>必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态<br>当前成员必须在应用的可见范围。<br>需要从上下游会话的工具栏进入页面才可调用，否则会报错：without context of corpgroup contact，可先通过调用<a href="#21951" rel="nofollow">wx.qy.getContext</a>来判断进入小程序的入口。</blockquote><div class="cherry-table-container" data-sign="52baf93533cb55bb3a5bba8f9dea3858" data-lines="3">
        <table class="cherry-table"><thead><tr><th>入口</th><th>getContext的entry值</th><th>自建应用</th><th>第三方应用</th><th>用户</th><th>支持的最低版本</th></tr></thead><tbody><tr><td>上下游群聊会话的工具栏</td><td>chain_group_chat_tools</td><td>所有</td><td>所有</td><td>所有</td><td>4.0.12</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="3bbe378bfec626ca99632a23bd5fe229" data-type="p" data-lines="2"><strong>参数</strong><br><strong>Object object</strong></p><div class="cherry-table-container" data-sign="6bbd907124a2c2e9d706f602221a0648" data-lines="5">
        <table class="cherry-table"><thead><tr><th>参数名</th><th>类型</th><th>必填</th><th>说明</th></tr></thead><tbody><tr><td>success</td><td>Function</td><td>否</td><td>接口调用成功的回调函数</td></tr><tr><td>fail</td><td>Function</td><td>否</td><td>接口调用失败的回调函数</td></tr><tr><td>complete</td><td>Function</td><td>否</td><td>接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="76eadcfe7a03d934cb337c22990151b8" data-type="p" data-lines="2"><strong>object.success 回调函数</strong><br><strong>参数</strong></p><p data-sign="2af9fbc618b17cf6a6fb5cb8c9589844" data-type="p" data-lines="2"><strong>Object res</strong></p><div class="cherry-table-container" data-sign="3bc7680d1f73c4e1fc1b021319059174" data-lines="3">
        <table class="cherry-table"><thead><tr><th>参数</th><th>类型</th><th>说明</th></tr></thead><tbody><tr><td>chatId</td><td>String</td><td>返回当前互联群的群聊ID</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="8349d1aef0548ab082591d41e79adaef" data-type="p" data-lines="1"><strong>示例代码：</strong></p><div data-sign="6b9f726cdda1b1ebe36ac7f905cfa8e6" data-type="codeBlock" data-lines="10">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line"></span>
<span class="code-line">wx<span class="token punctuation">.</span>qy<span class="token punctuation">.</span><span class="token function">getCurCorpGroupChat</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    chatId  <span class="token operator">=</span> res<span class="token punctuation">.</span>chatId <span class="token punctuation">;</span> <span class="token comment">//返回当前互联群的群聊ID</span></span>
<span class="code-line">  <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><h3 id="%E5%88%86%E4%BA%AB%E6%B6%88%E6%81%AF%E5%88%B0%E5%BD%93%E5%89%8D%E4%BC%9A%E8%AF%9D" data-sign="8c0ec29aa4e7c5e97275939c92c299f3" data-lines="1"><a class="anchor" href="#%E5%88%86%E4%BA%AB%E6%B6%88%E6%81%AF%E5%88%B0%E5%BD%93%E5%89%8D%E4%BC%9A%E8%AF%9D"></a>分享消息到当前会话</h3><p data-sign="4ae6ae192e0826034cdc3eb496db071f" data-type="p" data-lines="2">接口使用说明详见“<a href="#21264" rel="nofollow">wx.qy.sendChatMessage</a>”，可在上下游的聊天工具栏里可调用该接口，调用前可先通过调用<a href="#21951" rel="nofollow">wx.qy.getContext</a>来判断进入小程序的入口。</p><div class="cherry-table-container" data-sign="f2cfccff2d74e37e6fbf7755c639bc6f" data-lines="4">
        <table class="cherry-table"><thead><tr><th>入口</th><th>getContext的entry值</th><th>自建应用</th><th>第三方应用</th><th>用户</th><th>支持的最低版本</th></tr></thead><tbody><tr><td>上下游单聊会话的工具栏</td><td>chain_single_chat_tools</td><td>所有</td><td>所有</td><td>所有</td><td>4.0.8</td></tr><tr><td>上下游群聊会话的工具栏</td><td>chain_group_chat_tools</td><td>所有</td><td>所有</td><td>所有</td><td>4.0.8</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>