<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>wx.qy.getCurExternalContact - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        wx.qy.getCurExternalContact
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2025/11/17</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><h3 id="wxqygetcurexternalcontactobject-object" data-sign="16070135d75573814001708cea3697a1" data-lines="1" data-relingo-block="true"><a class="anchor" href="#wxqygetcurexternalcontactobject-object"></a>wx.qy.getCurExternalContact(Object object)</h3><blockquote data-sign="dcd7ea46dd16d85d903fdca78b74aa39_6" data-lines="6"><strong data-relin-paragraph="73">调用前提：</strong><br>必须先调用过wx.qy.login，且session_key未过期，开发者可调用checkSession 检查当前登录态<br>当前成员必须在应用的可见范围。<br>需要从特定入口进入页面才可调用，否则会报错：without context of external contact，可先通过调用<a href="#21951" rel="nofollow">wx.qy.getContext</a>来判断进入小程序的入口，允许调用的入口说明参见<a href="#%E4%B8%8D%E5%90%8C%E5%85%A5%E5%8F%A3%E6%89%80%E9%9C%80%E7%9A%84%E6%9D%83%E9%99%90%E8%AF%B4%E6%98%8E" rel="nofollow" data-relin-paragraph="75">“不同入口所需的权限说明”</a>。<br>从不同的入口进入的页面，应用需要满足相应用的权限，否则会报“no permission”错误，所需的权限参见<a href="#%E4%B8%8D%E5%90%8C%E5%85%A5%E5%8F%A3%E6%89%80%E9%9C%80%E7%9A%84%E6%9D%83%E9%99%90%E8%AF%B4%E6%98%8E" rel="nofollow" data-relin-paragraph="76">“不同入口所需的权限说明”</a><br>「营销获客」类应用仅可获取该应用带来的客户/微信客服</blockquote><p data-sign="47c76728ca1fc4c02ab6954532614554" data-type="p" data-lines="2" data-relingo-block="true" data-relin-paragraph="9">获取当前外部联系人userid</p><h4 id="%E5%8F%82%E6%95%B0" data-sign="8cb71f61557fabe1ccf527e1bd04a132" data-lines="2" data-relingo-block="true" data-relin-paragraph="10"><a class="anchor" href="#%E5%8F%82%E6%95%B0"></a>参数</h4><h5 id="object-object" data-sign="46276ba891600e417ac243f8fabb1b82" data-lines="2" data-relingo-block="true"><a class="anchor" href="#object-object"></a>Object object</h5><div class="cherry-table-container" data-sign="6bbd907124a2c2e9d706f602221a0648" data-lines="5">
        <table class="cherry-table" data-relingo-block="true"><thead data-relingo-block="true"><tr data-relingo-block="true"><th data-relingo-block="true" data-relin-paragraph="12">参数名</th><th data-relingo-block="true" data-relin-paragraph="13">类型</th><th data-relingo-block="true" data-relin-paragraph="14">必填</th><th data-relingo-block="true" data-relin-paragraph="15">说明</th></tr></thead><tbody data-relingo-block="true"><tr data-relingo-block="true"><td data-relingo-block="true">success</td><td data-relingo-block="true">Function</td><td data-relingo-block="true">否</td><td data-relingo-block="true" data-relin-paragraph="18">接口调用成功的回调函数</td></tr><tr data-relingo-block="true"><td data-relingo-block="true">fail</td><td data-relingo-block="true">Function</td><td data-relingo-block="true">否</td><td data-relingo-block="true" data-relin-paragraph="21">接口调用失败的回调函数</td></tr><tr data-relingo-block="true"><td data-relingo-block="true">complete</td><td data-relingo-block="true">Function</td><td data-relingo-block="true">否</td><td data-relingo-block="true" data-relin-paragraph="24">接口调用结束的回调函数（调用成功、失败都会执行）</td></tr></tbody></table></div><p data-sign="br3" data-type="br" data-lines="3" data-relingo-block="true">&nbsp;</p><h6 id="objectsuccess-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0" data-sign="530ca0ecde81dd40e6bb9cb99b6e2c93" data-lines="1" data-relingo-block="true"><a class="anchor" href="#objectsuccess-%E5%9B%9E%E8%B0%83%E5%87%BD%E6%95%B0"></a>object.success 回调函数</h6><p data-sign="5477f16037a9e95ffb1ce412685a5e6b" data-type="p" data-lines="1" data-relingo-block="true" data-relin-paragraph="26"><strong>参数</strong></p><p data-sign="2af9fbc618b17cf6a6fb5cb8c9589844" data-type="p" data-lines="2" data-relingo-block="true"><strong>Object res</strong></p><div class="cherry-table-container" data-sign="5e68c0847cdb792200280eb65411070a" data-lines="3">
        <table class="cherry-table" data-relingo-block="true"><thead data-relingo-block="true"><tr data-relingo-block="true"><th data-relingo-block="true" data-relin-paragraph="28">参数</th><th data-relingo-block="true" data-relin-paragraph="29">类型</th><th data-relingo-block="true" data-relin-paragraph="30">说明</th></tr></thead><tbody data-relingo-block="true"><tr data-relingo-block="true"><td data-relingo-block="true">userId</td><td data-relingo-block="true">String</td><td data-relingo-block="true" data-relin-paragraph="33">返回此次选择的外部联系人userId</td></tr></tbody></table></div><p data-sign="br2" data-type="br" data-lines="2" data-relingo-block="true">&nbsp;</p><h4 id="%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%EF%BC%9A" data-sign="a3eb661066708b00561e1028019ee536" data-lines="1" data-relingo-block="true" data-relin-paragraph="34"><a class="anchor" href="#%E7%A4%BA%E4%BE%8B%E4%BB%A3%E7%A0%81%EF%BC%9A"></a>示例代码：</h4><div data-sign="6622747156e331f638711fb0011f70f1" data-type="codeBlock" data-lines="10">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line"></span>
<span class="code-line">wx<span class="token punctuation">.</span>qy<span class="token punctuation">.</span><span class="token function">getCurExternalContact</span> <span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token function-variable function">success</span><span class="token operator">:</span> <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token keyword">var</span> userId <span class="token operator">=</span> res<span class="token punctuation">.</span>userId <span class="token comment">//返回当前外部联系人userId</span></span>
<span class="code-line">  <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="code-line"></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h4 id="%E4%B8%8D%E5%90%8C%E5%85%A5%E5%8F%A3%E6%89%80%E9%9C%80%E7%9A%84%E6%9D%83%E9%99%90%E8%AF%B4%E6%98%8E" data-sign="1bbe6c76f8a3e3be3737f07c9a3faf0d" data-lines="2" data-relingo-block="true" data-relin-paragraph="35"><a class="anchor" href="#%E4%B8%8D%E5%90%8C%E5%85%A5%E5%8F%A3%E6%89%80%E9%9C%80%E7%9A%84%E6%9D%83%E9%99%90%E8%AF%B4%E6%98%8E"></a>不同入口所需的权限说明</h4><div class="cherry-table-container" data-sign="48c41c398194eeef19700885f18342c2" data-lines="4">
        <table class="cherry-table" data-relingo-block="true"><thead data-relingo-block="true"><tr data-relingo-block="true"><th data-relingo-block="true" data-relin-paragraph="36">入口</th><th data-relingo-block="true">[getContext](#21951)的entry值</th><th data-relingo-block="true" data-relin-paragraph="38">自建应用</th><th data-relingo-block="true" data-relin-paragraph="39">第三方应用</th><th data-relingo-block="true" data-relin-paragraph="40">用户</th><th data-relingo-block="true" data-relin-paragraph="41">支持的最低版本</th></tr></thead><tbody data-relingo-block="true"><tr data-relingo-block="true"><td data-relingo-block="true" data-relin-paragraph="42">联系人详情页</td><td data-relingo-block="true">contact_profile</td><td data-relingo-block="true" data-relin-paragraph="44">需有<a href="#13473/%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E8%81%94%E7%B3%BB%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%BA%94%E7%94%A8" rel="nofollow">客户联系功能权限</a></td><td data-relingo-block="true" data-relin-paragraph="45">需有“企业客户权限-&gt;客户基础信息”权限</td><td data-relingo-block="true" data-relin-paragraph="46"><a href="#13473/%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E8%81%94%E7%B3%BB%E5%8A%9F%E8%83%BD%E7%9A%84%E6%88%90%E5%91%98" rel="nofollow">配置了客户联系功能</a></td><td data-relingo-block="true" data-relin-paragraph="47">2.5.8</td></tr><tr data-relingo-block="true"><td data-relingo-block="true" data-relin-paragraph="48">外部单聊工具栏</td><td data-relingo-block="true">single_chat_tools</td><td data-relingo-block="true" data-relin-paragraph="50">需有<a href="#13473/%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E8%81%94%E7%B3%BB%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%BA%94%E7%94%A8" rel="nofollow">客户联系功能权限</a></td><td data-relingo-block="true" data-relin-paragraph="51">需有“企业客户权限-&gt;客户基础信息”权限</td><td data-relingo-block="true" data-relin-paragraph="52"><a href="#13473/%E9%85%8D%E7%BD%AE%E5%8F%AF%E4%BD%BF%E7%94%A8%E5%AE%A2%E6%88%B7%E8%81%94%E7%B3%BB%E5%8A%9F%E8%83%BD%E7%9A%84%E6%88%90%E5%91%98" rel="nofollow">配置了客户联系功能</a></td><td data-relingo-block="true" data-relin-paragraph="53">2.8.10</td></tr></tbody></table></div></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>