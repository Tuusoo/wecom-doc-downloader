<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>通讯录同步接口调整 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        通讯录同步接口调整
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2022/08/20</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><p data-sign="b80c68aff24ad09d62bbd6bf2eadeb8a" data-type="p" data-lines="1">为保障企业数据安全，通过<strong>"企业管理后台 - 管理工具 - 通讯录同步"</strong>调用接口或接收通讯录变更事件时，将不再返回除ID（userid和部门ID）之外的其他信息，包括但不限于姓名、手机号、部门名等。通讯录的新增、修改、删除等写入接口不受影响，建议“通讯录同步”功能仅用于将外部通讯录写入企业微信的场景，企业通过新的「<a href="#40856" rel="nofollow">获取成员ID列表</a>」接口可用于实现增量写的比对功能。如需获取员工姓名等其他信息，需要通过企业自建应用实现。</p><p data-sign="1894ee30d49251e197bdafbbda86a44e" data-type="p" data-lines="2">注意：以下通讯录接口调整，仅针对于“<a href="https://wework.qpic.cn/wwpic/741306_c1N_zqOTRAmnfSZ_1658996696/0" rel="nofollow">企业管理后台 - 管理工具 - 通讯录同步</a>”功能，<strong>不涉及企业自建应用、服务商代开发应用、第三方应用和第三方通讯录应用</strong>。</p><p data-sign="353e3a06380864b2f079a68f3b2137e7" data-type="p" data-lines="5"><a href="#contact1" rel="nofollow">新增ID查询接口</a><br><a href="#contact2" rel="nofollow">通讯录查询接口停用</a><br><a href="#contact3" rel="nofollow">通讯录回调通知调整</a><br><a href="#contact4" rel="nofollow">FAQ</a></p><p data-sign="f79054cd0c4c0c97982131c8a878525d" data-type="p" data-lines="2"><a id="contact1"></a></p><h2 id="%E6%96%B0%E5%A2%9Eid%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3" data-sign="9e7e79ae79c34170321db10b5edaa619" data-lines="1"><a class="anchor" href="#%E6%96%B0%E5%A2%9Eid%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3"></a>新增ID查询接口</h2><blockquote data-sign="568c24af2079865090cc542560cac7c8_1" data-lines="1">上线时间：已上线</blockquote><p data-sign="07989e02fc9a6ded927e29eebfd80c57" data-type="p" data-lines="2">新增「<a href="#40856" rel="nofollow">获取成员ID列表</a>」接口，企业可通过「<a href="#40856" rel="nofollow">获取成员ID列表</a>」和「<a href="#36259" rel="nofollow">获取部门ID列表</a>」接口获取userid和部门ID列表。</p><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="a15defe9392c1133337cfd150da4804d" data-type="p" data-lines="1"><a id="contact2"></a></p><h2 id="%E9%80%9A%E8%AE%AF%E5%BD%95%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3%E5%81%9C%E7%94%A8" data-sign="fb660db5a8e6955dafde35c7371d48df" data-lines="1"><a class="anchor" href="#%E9%80%9A%E8%AE%AF%E5%BD%95%E6%9F%A5%E8%AF%A2%E6%8E%A5%E5%8F%A3%E5%81%9C%E7%94%A8"></a>通讯录查询接口停用</h2><blockquote data-sign="9af66acbca90898891fc83a80ac8c126_3" data-lines="3">生效时间：8月15日10点开始灰度，8月22日20点全量上线<br>影响的应用：“企业管理后台 - 管理工具 - 通讯录同步”<br>影响的范围：新的IP（过去90天通讯录同步助手未使用过的IP）</blockquote><p data-sign="86655f94c3b3ea266b64218fea82974b" data-type="p" data-lines="1">对于“企业管理后台 - 管理工具 - 通讯录同步Secret”停用的接口列表：</p><ul data-sign="1684b5b9da31b817ca33568f98a025a4list8" data-lines="8" class="cherry-list__default"><li><a href="#10019" rel="nofollow">读取成员</a></li><li><a href="#10061" rel="nofollow">获取部门成员</a></li><li><a href="#10063" rel="nofollow">获取部门成员详情</a></li><li><a href="#10093" rel="nofollow">获取部门列表</a></li><li><a href="#36260" rel="nofollow">获取单个部门详情</a></li><li><a href="#31876" rel="nofollow">导出成员</a></li><li><a href="#31880" rel="nofollow">导出成员详情</a></li><li><a href="#31882" rel="nofollow">导出部门</a></li></ul><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="04c9c3e7226a5a3d10c2c85bd002eec1" data-type="p" data-lines="2">注意： <br>1.上线后，近90天内有访问记录的历史IP可暂时不受影响，可继续调用通讯录查询接口获取姓名、部门名等全部信息。</p><p data-sign="7bb409ffdb341591e38ab51515af6714" data-type="p" data-lines="1"><strong>历史IP的具体定义为：</strong></p><ul data-sign="616c43f59f424809176fff761901960flist2" data-lines="2" class="cherry-list__default"><li>8月15日前，企业已经配置在通讯录同步的“企业可信IP”。</li><li>若企业已开启通讯录同步功能但是未配置“企业可信IP”，则系统默认将该企业过去90天内有通过“通讯录同步”secret调用接口的IP地址，自动配置在“企业可信IP”。由系统自动配置的IP可继续调用通讯录查询接口获取姓名、部门名等全部信息。企业后续新增的IP将停用以上通讯录查询接口。没有配置在“企业可信IP”列表中的IP，将不可以通过“通讯录同步”secret调用接口。</li></ul><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="274e0e5632eaff5ad4e15ed661da7a20" data-type="p" data-lines="1">2.针对历史IP的接口调整将另行提前通知，建议企业尽快调整功能，不再依赖通过“通讯录同步”功能获取通讯录信息。建议“通讯录同步”功能仅用于将外部通讯录写入企业微信的场景。</p><p data-sign="a9af0e1dc4a199c87456d4320c411fc0" data-type="p" data-lines="2">3.仅影响“企业管理后台 - 管理工具 - 通讯录同步”，其他应用不受影响。企业自建应用、服务商代开发应用、第三方应用和第三方通讯录应用可继续按照原有模式调用通讯录查询接口。其中，服务商历史上已有的第三方通讯录应用后续也将调整为只能够获取ID信息，但本次升级暂未涉及。具体的升级调整将另行提前通知，建议服务商提前进行相关改造。</p><p data-sign="725d3cb4775bde868904addd4a27ebdc" data-type="p" data-lines="2"><a id="contact3"></a></p><h2 id="%E9%80%9A%E8%AE%AF%E5%BD%95%E5%9B%9E%E8%B0%83%E9%80%9A%E7%9F%A5%E8%B0%83%E6%95%B4" data-sign="f70883e305f2d2ebd6d6ba39ecb616a3" data-lines="1"><a class="anchor" href="#%E9%80%9A%E8%AE%AF%E5%BD%95%E5%9B%9E%E8%B0%83%E9%80%9A%E7%9F%A5%E8%B0%83%E6%95%B4"></a>通讯录回调通知调整</h2><blockquote data-sign="8c1cce1fc65120d2fcc7626b666ee977_3" data-lines="3">生效时间：8月15日10点开始灰度，8月22日20点全量上线<br>影响的应用：“企业管理后台 - 管理工具 - 通讯录同步”<br>影响的范围：新配置或修改的接收事件服务器</blockquote><p data-sign="888db0055477a9cc9139a290d6269b75" data-type="p" data-lines="1">调整内容：</p><ul data-sign="0198ebd99b1cf96eda989aa026eed4ablist2" data-lines="2" class="cherry-list__default"><li>8月15日后新设置的接收事件服务器，通讯录回调通知仅返回userid和部门ID。</li><li>正在使用的接收事件服务器不受影响，通讯录回调通知继续返回成员和部门的详细信息。但是当企业修改并保存接收事件服务器的URL后，通讯录回调通知将按照最新的方式仅返回userid和部门ID。</li></ul><p data-sign="br2" data-type="br" data-lines="2">&nbsp;</p><p data-sign="13d551f65f026d57fd5257c6fa24cfa7" data-type="p" data-lines="1">涉及的事件：</p><ul data-sign="ada7405b3f038bb79df292472bf71680list4" data-lines="4" class="cherry-list__default"><li><a href="#15004/%E6%96%B0%E5%A2%9E%E6%88%90%E5%91%98%E4%BA%8B%E4%BB%B6" rel="nofollow">新增成员事件</a></li><li><a href="#15004/%E6%9B%B4%E6%96%B0%E6%88%90%E5%91%98%E4%BA%8B%E4%BB%B6" rel="nofollow">更新成员事件</a> （仅在成员转移部门时回调）</li><li><a href="#15005/%E6%96%B0%E5%A2%9E%E9%83%A8%E9%97%A8%E4%BA%8B%E4%BB%B6" rel="nofollow">新增部门事件</a></li><li><a href="#15005/%E6%9B%B4%E6%96%B0%E9%83%A8%E9%97%A8%E4%BA%8B%E4%BB%B6" rel="nofollow">更新部门事件</a>（仅在变更父部门时回调）</li></ul><p data-sign="041b6dbed5f3d33875dc97d1bce5d2f4" data-type="p" data-lines="1"><a id="contact4"></a></p><h2 id="qampa" data-sign="94340b966ba29de895d24f7ba939814c" data-lines="1"><a class="anchor" href="#qampa"></a>Q&amp;A</h2><ol data-sign="c57b3460581d783c6bcece8e9162810flist17" data-lines="17" class="cherry-list__default" start="1"><li><strong>升级后，是否可以通过“通讯录同步”接口将除ID之外的其他信息写入企业微信？</strong><br>答：可以。本次升级仅针对“通讯录查询接口“，已有的通讯录写入接口不受影响，企业可继续将员工的姓名、部门、手机号等信息通过接口写入企业微信。同时企业可通过「<a href="#40856" rel="nofollow">获取成员ID列表</a>」和「<a href="#36259" rel="nofollow">获取部门ID列表</a>」接口获取ID信息，用于实现增量写的比对功能。<br><br><br></li><li><strong>本次升级是否会影响服务商已有的第三方通讯录应用？</strong><br>答：服务商历史上已有的第三方通讯录应用后续也将调整为只能够获取ID信息，但本次升级暂未涉及。具体的升级调整将另行提前通知，建议服务商提前进行相关改造。<br><br><br></li><li><strong>本次升级是否会影响企业自建应用调用通讯录接口？</strong><br>答：不会。本次通讯录接口调整，面向“企业管理后台 - 管理工具 -  通讯录同步 - 开启API接口同步”，<strong>不涉及自建应用</strong>。企业自建应用可继续调用通讯录接口获取成员姓名、部门等详细信息。其中敏感信息获取需区分：（<a href="https://developer.work.weixin.qq.com/community/announcement/detail?content_id=16334603338859177543" rel="nofollow">查看历史通知</a>）<br>1）2022年6月20日后新创建的自建应用，成员敏感信息需要成员在登录应用时自主授权，通过「<a href="https://developer.work.weixin.qq.com/document/path/95833" rel="nofollow">获取访问用户敏感信息</a>」接口获取。<br>2）2022年6月20日前已经创建的自建应用，可继续调用通讯录接口获取员工敏感信息。<br><br><br></li><li><strong>升级后，企业如何获取员工的姓名、部门、手机号等信息？</strong><br>答：企业获取员工信息，需要创建自建应用。经成员授权授权后，可获取手机号等敏感信息。<br><br></li></ol></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>