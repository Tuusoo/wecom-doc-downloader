<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>更新重复日程 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        更新重复日程
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2022/09/28</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="64399b5ddffccbeaa105ef9c9bae7904-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E6%A6%82%E8%BF%B0" class="level-2">概述</a></li><li class="toc-li"><a href="#%E5%8E%9F%E7%90%86" class="level-2">原理</a></li><li class="toc-li"><a href="#%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90" class="level-2">案例分析</a></li></dir><h2 id="%E6%A6%82%E8%BF%B0" data-sign="9a8437ccee43ad66c084b8dfd3d259d3" data-lines="1"><a class="anchor" href="#%E6%A6%82%E8%BF%B0"></a>概述</h2><p data-sign="8b3f9c175da645ad4e08e2c6dce53c52" data-type="p" data-lines="1">企业微信重复日程（即周期性日程），用户可能只想更新或取消特定周期的日程，因此API接口提供三种修改模式，以满足不同的使用场景（删除和更新类似，后文仅已更新日程作说明）。调用者需配合使用<code>op_mode</code>和<code>op_start_time</code>两个入参字段来按自己想要的方式修改重复日程。</p><ul data-sign="0cd5a9fac1090a95d1bed30410661ebdlist3" data-lines="3" class="cherry-list__default"><li>全部修改。即所有周期的日程均修改，是默认修改模式。</li><li>仅修改此日程。即只修改指定周期的日程。此时原周期性日程会删除指定周期，并产生一个新的单次日程，调接口指定的日程属性生效于新的日程上。</li><li>修改将来的所有日程。即修改指定周期及以后的所有日程。此时会修改原日程的repeat_until（重复结束时间），原日程被修剪并分裂出新的日程，调接口指定的日程属性生效于新的日程上。</li></ul><h2 id="%E5%8E%9F%E7%90%86" data-sign="e35999bfcf956c0b8a33aec5b307d88e" data-lines="2"><a class="anchor" href="#%E5%8E%9F%E7%90%86"></a>原理</h2><p data-sign="5673596ab3f07065a3ecdee47003b0f5" data-type="p" data-lines="2">图示不同模式的修改原理：<br><img src="images/96204/2342c220.png" alt="周期性日程的修改模式"></p><p data-sign="02a8dc3730011d3a414b0122b2d23571" data-type="p" data-lines="1">需要注意的点：</p><ol data-sign="221da706f89aadcaf925b102928a69c8list10" data-lines="10" data-start="1" class="cherry-list__default" start="1"><li>仅周期性日程，才可以指定<code>op_mode</code>为“仅修改此日程”或“修改将来的所有日程”，非周期性日程指定会报错<code>90485</code>。<br></li><li>当修改模式为“仅修改此日程”或“修改将来的所有日程”时，必须通过<code>op_start_time</code>来指定从哪个周期开始修改。<br><code>op_start_time</code>需是原日程某个周期的开始时间（Unix时间戳，精确到秒），如果企业微信后台不能匹配到任何周期的开始时间，会报错<code>90482</code>。<br></li><li>当修改模式为“仅修改此日程”或“修改将来的所有日程”时，企业微信后台会对原日程A做修剪处理，并分裂出新的日程B，此次更新操作指定的属性（包括starttime等所有参数）生效于日程B上。分裂新产生的日程B的ID，通过接口的返回参数schedule_id返回给调用者。<br></li><li>第2点有个特例，如果修改模式是“修改将来的所有日程”，当op_start_time指定为同start_time（即首个周期的开始时间）时，此时会演变为“修改全部日程”，不会分裂出新的日程。如图中场景③所示。<br></li><li>如果修改模式为“仅修改此日程”，那么分裂出的新日程B，只能是单次日程。因此在这种修改模式下，不支持指定为重复日程（即is_repeate不能指定为1），如果指定会报错<code>90484</code>。其它重复性相关的参数也会被认为无效。</li></ol><h2 id="%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90" data-sign="4c186920ce8c9840696717d85bff65b2" data-lines="2"><a class="anchor" href="#%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90"></a>案例分析</h2><p data-sign="43df9842b7de94a9fa4635398c375230" data-type="p" data-lines="4">以学校课程表场景为例：<br>	学校教师通过企业微信日历API为学生添加课程表日历本，并在该日历本上通过日程API添加体育课日程。体育课每周三14:00进行，第一次上课时间是2022年9月7日。那么，创建日程时，指定开始时间start_time为1662530400（2022-09-07 14:00:00），且重复类型指定为每周重复，这样企业微信就会每周三提醒学生上课。<br>	假设第二周体育老师临时有事需要修改课程时间到16:00，那么需要通过更新日程接口，修改第二周当次的日程。<br>调用更新接口时，指定op_mode=1（仅修改此日程），op_start_time=1663135200（2022-09-14 14:00:00，即第二周周三当次课程的原开始时间），并指定新的start_time=1663142400（2022-09-14 16:00:00），即可达成临时修改课程时间的目的。</p></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>