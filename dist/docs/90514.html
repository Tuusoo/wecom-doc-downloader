<!DOCTYPE html><html lang="zh-CN"><head>
                <meta charset="UTF-8">
                <title>开始使用 - 文档 - 企业微信开发者中心</title>
                <link rel="stylesheet" href="../doc-style.css">
                </head>
                <body>
                <div id="js-ep-doc-cnt" class="ep-doc-area-cnt">
    <div class="ep-doc-area-top" id="js-ep-doc-cnt-title">
      <div class="ep-doc-area-title">
        开始使用
      </div>
      <div class="ep-doc-area-subtitle">最后更新：2025/11/18</div>
    </div>
    <div class="ep-doc-area-cherry cherry-markdown cherry-wecom" id="js-ep-doc-cnt-md"><div data-inline-code-theme="red" data-code-block-theme="coy"><dir class="toc" data-sign="2c7e5bb80b12c638347c7d83d20b06fa-1" data-lines="1"><p class="toc-title">目录</p><li class="toc-li"><a href="#%E5%AE%89%E8%A3%85" class="level-2">安装</a></li><li class="toc-li"><a href="#%E6%8E%A5%E5%8F%A3%E9%89%B4%E6%9D%83" class="level-2">接口鉴权</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%B0%83%E7%94%A8%E8%A6%81%E6%B1%82" class="level-3">调用要求</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E4%BC%81%E4%B8%9A%E8%BA%AB%E4%BB%BD%E6%B3%A8%E5%86%8C" class="level-3">企业身份注册</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E5%BA%94%E7%94%A8%E8%BA%AB%E4%BB%BD%E6%B3%A8%E5%86%8C" class="level-3">应用身份注册</a></li><li class="toc-li"><a href="#%E6%8E%A5%E5%8F%A3%E7%BA%A6%E5%AE%9A" class="level-2">接口约定</a></li><li class="toc-li"><a href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%BF%AB%E9%80%9F%E6%8E%A5%E5%85%A5" class="level-2">开发环境快速接入</a></li><li class="toc-li"><a href="#%E6%97%A7%E7%89%88jweixin%E8%BF%81%E7%A7%BB" class="level-2">旧版jweixin迁移</a></li><li class="toc-li">&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a href="#%E8%BF%81%E7%A7%BB%E6%8C%87%E5%8D%97" class="level-3">迁移指南</a></li></dir><h2 id="%E5%AE%89%E8%A3%85" data-sign="d6de5182315b0c2a436d1751644fbd40" data-lines="1"><a class="anchor" href="#%E5%AE%89%E8%A3%85"></a>安装</h2><p data-sign="8a479f437455076a8a07899165a7bfeb" data-type="p" data-lines="2">企业微信JS-SDK提供了 npm 和 cdn 两种引入途径。</p><ol data-sign="82aad40e0e40e9c6cffb9b41c739ffc6list8" data-lines="8" class="cherry-list__default" start="1"><li>通过 npm 引入<br><div data-sign="93512a02eac3da4c8b4240389cf33948" data-type="codeBlock" data-lines="3">
      <pre class="language-bash"><code class="language-bash wrap"><span class="code-line"><span class="token function">npm</span> <span class="token function">install</span> @wecom/jssdk</span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br>安装完成后即可在应用中使用 SDK：<br><div data-sign="372e09fedff5a0d07ca59d962516de3e" data-type="codeBlock" data-lines="3">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line"><span class="token keyword">import</span> <span class="token operator">*</span> <span class="token keyword">as</span> ww <span class="token keyword">from</span> <span class="token string">'@wecom/jssdk'</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div></li><li>通过 script 标签引入<br><div data-sign="ccdf511d065baab8f138455bf2b0ffe5" data-type="codeBlock" data-lines="3">
      <pre class="language-html"><code class="language-html wrap"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span> <span class="token attr-name">src</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://wwcdn.weixin.qq.com/node/open/js/wecom-jssdk-2.3.3.js<span class="token punctuation">"</span></span><span class="token punctuation">&gt;</span></span><span class="token script"></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><br>安装完成后，SDK 会在 window 上定义 ww 对象：<br><div data-sign="70af347f2a1b2ed4419786ce2ac5c2f6" data-type="codeBlock" data-lines="5">
      <pre class="language-html"><code class="language-html wrap"><span class="code-line"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">&gt;</span></span><span class="token script"><span class="token language-javascript"></span></span></span>
<span class="code-line"><span class="token script"><span class="token language-javascript">  <span class="token function">alert</span><span class="token punctuation">(</span>ww<span class="token punctuation">.</span><span class="token constant">SDK_VERSION</span><span class="token punctuation">)</span></span></span></span>
<span class="code-line"><span class="token script"><span class="token language-javascript"></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">&gt;</span></span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div></li></ol><h2 id="%E6%8E%A5%E5%8F%A3%E9%89%B4%E6%9D%83" data-sign="190676006f492e83e7ef943aae60c8ab" data-lines="1"><a class="anchor" href="#%E6%8E%A5%E5%8F%A3%E9%89%B4%E6%9D%83"></a>接口鉴权</h2><h3 id="%E8%B0%83%E7%94%A8%E8%A6%81%E6%B1%82" data-sign="1c6df63714be4e1048daf96aafde7534" data-lines="1"><a class="anchor" href="#%E8%B0%83%E7%94%A8%E8%A6%81%E6%B1%82"></a>调用要求</h3><ul data-sign="021a6bac35e7d29d558cee7d74e4b692list7" data-lines="7" class="cherry-list__default"><li>所有的JS接口只能在企业微信应用的可信域名下调用(包括子域名)，且可信域名必须有ICP备案且在管理端验证域名归属。</li><li>验证域名归属的方法在企业微信的管理后台“我的应用”里，进入应用，设置应用可信域名。<br></li><li>在调用 JSAPI 前，需要先通过 ww.register 注册当前页面的身份信息。身份信息分为两种：<br>1) 企业身份与权限，通过企业签名获得。<br>2) 应用（自建/待开发/第三方应用等）身份与权限，通过应用签名获得。<br>使用者可根据具体调用的JSAPI所要求的身份权限进行注册即可，应用身份权限 &gt; 企业身份权限。</li></ul><h3 id="%E4%BC%81%E4%B8%9A%E8%BA%AB%E4%BB%BD%E6%B3%A8%E5%86%8C" data-sign="8da0992d55e1b5d4d5d0d8cf6fec8f6d" data-lines="2"><a class="anchor" href="#%E4%BC%81%E4%B8%9A%E8%BA%AB%E4%BB%BD%E6%B3%A8%E5%86%8C"></a>企业身份注册</h3><div data-sign="9c3b67fceab52d35f46217d32d95c582" data-type="codeBlock" data-lines="14">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line">ww<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">  corpId<span class="token operator">:</span> <span class="token string">'ww7ca4776b2a70000'</span><span class="token punctuation">,</span>       <span class="token comment">// 必填，当前用户企业所属企业ID</span></span>
<span class="code-line">  jsApiList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'getExternalContact'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 必填，需要使用的JSAPI列表</span></span>
<span class="code-line">  getConfigSignature                 <span class="token comment">// 必填，根据url生成企业签名的回调函数</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getConfigSignature</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token comment">// 根据 url 生成企业签名</span></span>
<span class="code-line">  <span class="token comment">// 生成方法参考 https://developer.work.weixin.qq.com/document/14924</span></span>
<span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span> timestamp<span class="token punctuation">,</span> nonceStr<span class="token punctuation">,</span> signature <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="b288903101e94dc38074f51fc09b8aeb" data-type="p" data-lines="2">在注册应用身份信息时，开发者需要提供对应的签名函数。该函数需要根据当前页面的 URL 和应用的 Secret 等信息生成 JS-SDK 签名并返回相关信息。详见 <a href="#14924" rel="nofollow">JS-SDK 签名算法</a>。</p><p data-sign="272b6851d41d948a87d23faaf66257d3" data-type="p" data-lines="2"><strong>注意：</strong></p><ul data-sign="e74ea2ec239668da08ed4267b11272c5list2" data-lines="2" class="cherry-list__default"><li><strong>参数中的回调函数调用时机由 JSSDK 自行控制，开发者无需关心具体调用顺序</strong></li><li>用于生成签名的 jsapi_ticket 属于敏感信息，请在服务端完成签名操作</li></ul><h3 id="%E5%BA%94%E7%94%A8%E8%BA%AB%E4%BB%BD%E6%B3%A8%E5%86%8C" data-sign="fc7441001816cd57b968b94b7cd218ac" data-lines="2"><a class="anchor" href="#%E5%BA%94%E7%94%A8%E8%BA%AB%E4%BB%BD%E6%B3%A8%E5%86%8C"></a>应用身份注册</h3><p data-sign="15b2d96a7fe4543090bb263a1a6b1996" data-type="p" data-lines="2">应用在原有企业身份信息的基础上，需要额外提供应用身份信息（原 agentConfig）：</p><div data-sign="cf553612835de38b13071191b0bf7d83" data-type="codeBlock" data-lines="21">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line">ww<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">  corpId<span class="token operator">:</span> <span class="token string">'ww7ca4776b2a70000'</span><span class="token punctuation">,</span>       <span class="token comment">// 必填，当前用户企业所属企业ID</span></span>
<span class="code-line">  agentId<span class="token operator">:</span> <span class="token number">1000247</span><span class="token punctuation">,</span>                  <span class="token comment">// 必填，当前应用的AgentID</span></span>
<span class="code-line">  jsApiList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'getExternalContact'</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token comment">// 必填，需要使用的JSAPI列表</span></span>
<span class="code-line">  getConfigSignature<span class="token punctuation">,</span>                <span class="token comment">// 必填，根据url生成企业签名的回调函数</span></span>
<span class="code-line">  getAgentConfigSignature            <span class="token comment">// 必填，根据url生成应用签名的回调函数</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getConfigSignature</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token comment">// 根据 url 生成企业签名</span></span>
<span class="code-line">  <span class="token comment">// 生成方法参考 https://developer.work.weixin.qq.com/document/14924</span></span>
<span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span> timestamp<span class="token punctuation">,</span> nonceStr<span class="token punctuation">,</span> signature <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token keyword">async</span> <span class="token keyword">function</span> <span class="token function">getAgentConfigSignature</span><span class="token punctuation">(</span><span class="token parameter">url</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token comment">// 根据 url 生成应用签名，生成方法同上，但需要使用应用的 jsapi_ticket</span></span>
<span class="code-line">  <span class="token keyword">return</span> <span class="token punctuation">{</span> timestamp<span class="token punctuation">,</span> nonceStr<span class="token punctuation">,</span> signature <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="5a145498e5bf40111aeb428acabce055" data-type="p" data-lines="2">应用在原有签名函数的基础上，需要额外提供应用的AgentID以及应用签名函数。和原有的签名函数不同，应用签名函数需要使用应用的 jsapi_ticket。见 <a href="#14924/%E8%8E%B7%E5%8F%96%E5%BA%94%E7%94%A8-jsapi-ticket" rel="nofollow">获取应用 jsapi_ticket</a>。</p><p data-sign="5936cc7a4087c9d1c7e9992e7f938b34" data-type="p" data-lines="2"><strong>注意：用于生成签名的 jsapi_ticket 属于敏感信息，请在服务端完成签名操作。</strong></p><h2 id="%E6%8E%A5%E5%8F%A3%E7%BA%A6%E5%AE%9A" data-sign="bddf82c90fd8e61b2ef2cbf28088b0f5" data-lines="2"><a class="anchor" href="#%E6%8E%A5%E5%8F%A3%E7%BA%A6%E5%AE%9A"></a>接口约定</h2><p data-sign="1700b781825b9907b999b802d875dd2a" data-type="p" data-lines="2">在调用 ww.register 后，页面可以立刻调用其他 JSAPI，JS-SDK 内部会自行处理注册身份信息的时序。这里约定两种通用的 JS 接口调用形式：</p><p data-sign="5ae4a15e16548d25e90c77e5c0e78f43" data-type="p" data-lines="2"><strong>1. 命令接口：</strong></p><div data-sign="201a5d335c8e72d03b24f0ea2303108a" data-type="codeBlock" data-lines="15">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line">ww<span class="token punctuation">.</span><span class="token function">方法名</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">  参数<span class="token operator">:</span> xxx<span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token comment">// 成功回调，result.errMsg 固定格式为“方法名:ok”</span></span>
<span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token function">fail</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token comment">// 失败回调，通过 result.errMsg 查看失败详情</span></span>
<span class="code-line">  <span class="token punctuation">}</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token function">complete</span><span class="token punctuation">(</span><span class="token parameter">result</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token comment">// 完成回调，无论调用成功还是失败，都会回调该方法</span></span>
<span class="code-line">  <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="6389ea39c11053acb2234411cfd7f9ee" data-type="p" data-lines="2"><strong>2. 事件接口：</strong></p><div data-sign="8027d0e0a6fbacfc3ae8892e49337e1b" data-type="codeBlock" data-lines="6">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line">ww<span class="token punctuation">.</span><span class="token function">on事件名</span><span class="token punctuation">(</span><span class="token parameter">event</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token comment">// 事件发生时回调</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="0a7573e9d3ef842e2576ea7768f22fda" data-type="p" data-lines="2">另外所有命令接口均会返回 promise，开发者也可以通过 promise 的回调获取调用结果：</p><div data-sign="02577a8e6f25480ea69673f0118e7f31" data-type="codeBlock" data-lines="5">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line"><span class="token keyword">const</span> <span class="token punctuation">{</span> errMsg<span class="token punctuation">,</span> userIds <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">await</span> ww<span class="token punctuation">.</span><span class="token function">selectExternalContact</span><span class="token punctuation">(</span><span class="token punctuation">)</span></span>
<span class="code-line"><span class="token comment">// errMsg === 'selectExternalContact:ok'</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h2 id="%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%BF%AB%E9%80%9F%E6%8E%A5%E5%85%A5" data-sign="9b04514ec0d1a2cb003b4ce45798db5f" data-lines="2"><a class="anchor" href="#%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83%E5%BF%AB%E9%80%9F%E6%8E%A5%E5%85%A5"></a>开发环境快速接入</h2><p data-sign="8e012bfe0de8ff0217e47dbeb72cee63" data-type="p" data-lines="2">为方便开发者在<strong>开发环境</strong>快速接入，JS-SDK 提供了 getSignature 方法，开发者可以通过内联 jsapi_ticket 在页面上生成 JSAPI 签名：</p><div data-sign="e5521b91f91ac4fdb49b252fe1ac3883" data-type="codeBlock" data-lines="23">
      <pre class="language-js"><code class="language-js wrap"><span class="code-line"><span class="token comment">// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span>
<span class="code-line"><span class="token comment">// 该代码仅用于开发环境快速接入，请勿在生产环境对外暴露JSAPI_TICKET</span></span>
<span class="code-line"><span class="token comment">// Ticket有效期为2个小时，过期后请手动更换</span></span>
<span class="code-line"><span class="token comment">// !!!!!!!!!!!!!!!!!!!!!!!!!!!!!!!</span></span>
<span class="code-line"><span class="token keyword">const</span> <span class="token constant">JSAPI_TICKET</span> <span class="token operator">=</span> <span class="token string">'sM4AOVdWfPE4DxkXGEs8VMCPGGVi4C3VM0P37wVUCFvkVAy_90u5h9nbSlYy3-Sl-HhTdfl2fzFy1AOcHKP7qg '</span></span>
<span class="code-line"></span>
<span class="code-line">ww<span class="token punctuation">.</span><span class="token function">register</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">  corpId<span class="token operator">:</span> <span class="token string">'ww7ca4776b2a70000'</span><span class="token punctuation">,</span></span>
<span class="code-line">  jsApiList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'selectExternalContact'</span><span class="token punctuation">]</span><span class="token punctuation">,</span></span>
<span class="code-line">  <span class="token function">getConfigSignature</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token keyword">return</span> ww<span class="token punctuation">.</span><span class="token function">getSignature</span><span class="token punctuation">(</span><span class="token constant">JSAPI_TICKET</span><span class="token punctuation">)</span></span>
<span class="code-line">  <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span>
<span class="code-line"></span>
<span class="code-line"><span class="token comment">// 调用 register 后可以立刻调用其他 JS 接口</span></span>
<span class="code-line">ww<span class="token punctuation">.</span><span class="token function">selectExternalContact</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">  <span class="token function">success</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span> <span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token function">alert</span><span class="token punctuation">(</span><span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">stringify</span><span class="token punctuation">(</span>res<span class="token punctuation">)</span><span class="token punctuation">)</span></span>
<span class="code-line">  <span class="token punctuation">}</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="3c4aded7f1f74596e9d2335e1d4b52b2" data-type="p" data-lines="2">jsapi_ticket 的获取方法可以参考<a href="#14924/%E8%8E%B7%E5%8F%96%E4%BC%81%E4%B8%9A-jsapi-ticket" rel="nofollow">获取企业 jsapi_ticket</a>和<a href="#14924/%E8%8E%B7%E5%8F%96%E5%BA%94%E7%94%A8-jsapi-ticket" rel="nofollow">获取应用 jsapi_ticket</a>，在开发阶段我们也可以通过以下命令快速获取：</p><div data-sign="9e8b82c300f29aa54592994f2db13e21" data-type="codeBlock" data-lines="5">
      <pre class="language-bash"><code class="language-bash wrap"><span class="code-line"><span class="token comment"># CORPID、SECRET为占位符，请自行填入真实的企业ID和应用Secret</span></span>
<span class="code-line">npx wwutil ticket CORPID SECRET</span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><h2 id="%E6%97%A7%E7%89%88jweixin%E8%BF%81%E7%A7%BB" data-sign="2da21a415ddc4e57d0b4c23b6389ceb9" data-lines="2"><a class="anchor" href="#%E6%97%A7%E7%89%88jweixin%E8%BF%81%E7%A7%BB"></a>旧版jweixin迁移</h2><p data-sign="a1ef6359c79da0ab39f09f9dc2e78234" data-type="p" data-lines="2">新版的wecom-jssdk.js中，我们提供了完全的Typescript类型支持，npm引入等新特性。未来企业微信中新功能接口也将基于wecom-jssdk进行更新升级。如果你的应用正在使用旧版 jweixin-1.2.0.js进行接口调用，我们强烈建议进行升级。</p><h3 id="%E8%BF%81%E7%A7%BB%E6%8C%87%E5%8D%97" data-sign="e01fb91b47e79551e9c53396c01eb887" data-lines="2"><a class="anchor" href="#%E8%BF%81%E7%A7%BB%E6%8C%87%E5%8D%97"></a>迁移指南</h3><p data-sign="8eb5facfdb80ed94e9b8a90bbcb43484" data-type="p" data-lines="3"><strong>非兼容性的改变：</strong><br>1、wx.config, wx.agentConfig 需改为使用ww.register进行身份注册。<br>2、ww.register方法，开发者无需关注ready等注册状态，SDK内部会自动处理相关函数回调。</p><p data-sign="914c6f9d3849ae571767f495a271f2b2" data-type="p" data-lines="3">兼容性改变：<br>ww.invoke方法，ww.on方法 均兼容旧版的wx.invoke，wx.on方法，可以直接进行替换。</p><p data-sign="ff2701e67a4838305fd2bef4507257f2" data-type="p" data-lines="2"><strong>以下为旧版 jweixin-1.2.0.js 的接入和使用方式。</strong></p><p data-sign="b0fa7eeeea5ff1d6ef5341b693e95389" data-type="p" data-lines="2"><strong>步骤一：引入JS文件</strong></p><p data-sign="383da92e849426a59f64d429e89b8a8e" data-type="p" data-lines="2">在需要调用JS接口的页面引入如下JS文件：<a href="https://res.wx.qq.com/open/js/jweixin-1.2.0.js" target="_blank">https://res.wx.qq.com/open/js/jweixin-1.2.0.js</a></p><div data-sign="828cb27f7ef3c8b46478d6308253410b" data-type="codeBlock" data-lines="4">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line"><span class="token operator">&lt;</span>script src<span class="token operator">=</span><span class="token string">"https://res.wx.qq.com/open/js/jweixin-1.2.0.js"</span><span class="token operator">&gt;</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">&gt;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><blockquote data-sign="e6ae50ece9acda4c3b72970c8d21cbfa_2" data-lines="2">为支持微信插件（原企业号）功能，请引用此文件。原企业微信的js文件在微信插件不生效。<br>jweixin-1.6.0 版本企业微信客户端暂不支持。</blockquote><p data-sign="7533c3857935b00b585a7fabe606b4ce" data-type="p" data-lines="2"><strong>步骤二：通过config接口注入权限验证配置</strong></p><blockquote data-sign="3f27066b0780dbaea1e5f2d8d17cf5f9_2" data-lines="2">所有需要使用JS-SDK的页面必须先注入配置信息，否则将无法调用（同一个url仅需调用一次，对于变化url的SPA（single-page application）的web app可在每次url变化时进行调用）。</blockquote><div data-sign="b191b3729fd4f8bd057eecbbfd93dadc" data-type="codeBlock" data-lines="12">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">wx<span class="token punctuation">.</span><span class="token function">config</span><span class="token punctuation">(</span><span class="token punctuation">{</span></span>
<span class="code-line">    beta<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span><span class="token comment">// 必须这么写，否则wx.invoke调用形式的jsapi会有问题</span></span>
<span class="code-line">    debug<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// 开启调试模式,调用的所有api的返回值会在客户端alert出来，若要查看传入的参数，可以在pc端打开，参数信息会通过log打出，仅在pc端时才会打印。</span></span>
<span class="code-line">    appId<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 必填，企业微信的corpID，必须是本企业的corpID，不允许跨企业使用</span></span>
<span class="code-line">    timestamp<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的时间戳</span></span>
<span class="code-line">    nonceStr<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span> <span class="token comment">// 必填，生成签名的随机串</span></span>
<span class="code-line">    signature<span class="token operator">:</span> <span class="token string">''</span><span class="token punctuation">,</span><span class="token comment">// 必填，签名，见 附录-JS-SDK使用权限签名算法</span></span>
<span class="code-line">    jsApiList<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token comment">// 必填，需要使用的JS接口列表，凡是要调用的接口都需要传进来</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="1ccf6e1d3aafa3425925ff2c7e8f70a4" data-type="p" data-lines="2">生成签名算法详见：<a href="#14924" rel="nofollow">附录-JS-SDK使用权限签名算法</a><br><strong>步骤三：通过ready接口处理成功验证</strong></p><div data-sign="695cf66f8cafac5c63009f3d65f1bf5e" data-type="codeBlock" data-lines="6">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">wx<span class="token punctuation">.</span><span class="token function">ready</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token comment">// config信息验证后会执行ready方法，所有接口调用都必须在config接口获得结果之后，config是一个客户端的异步操作，所以如果需要在页面加载时就调用相关接口，则须把相关接口放在ready函数中调用来确保正确执行。对于用户触发时才调用的接口，则可以直接调用，不需要放在ready函数中。</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="6437b92365679679ecf02303c2418394" data-type="p" data-lines="2"><strong>步骤四：通过error接口处理失败验证</strong></p><div data-sign="304c5c8955d5b27520a58d7c0fff11f5" data-type="codeBlock" data-lines="6">
      <pre class="language-javascript"><code class="language-javascript wrap"><span class="code-line">wx<span class="token punctuation">.</span><span class="token function">error</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">res</span><span class="token punctuation">)</span><span class="token punctuation">{</span></span>
<span class="code-line">    <span class="token comment">// config信息验证失败会执行error函数，如签名过期导致验证失败，具体错误信息可以打开config的debug模式查看，也可以在返回的res参数中查看，对于SPA可以在这里更新签名。</span></span>
<span class="code-line"><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span></code><div class="codeCopyBtn"></div><div class="codeCopyBtn_tips">点击复制</div></pre>
    </div><p data-sign="8ddea8479e2e9d14870fd829092172c2" data-type="p" data-lines="2"><strong>接口调用说明</strong></p><p data-sign="b016e12201b0c815cbf9dfd9caa9930f" data-type="p" data-lines="2">所有接口通过wx对象(也可使用jWeixin对象)来调用，参数是一个对象，除了每个接口本身需要传的参数之外，还有以下通用参数：</p><ol data-sign="e4a0b8a765c7f0ceebb5f7c75d41262alist5" data-lines="5" class="cherry-list__default" start="1"><li>success：接口调用成功时执行的回调函数。</li><li>fail：接口调用失败时执行的回调函数。</li><li>complete：接口调用完成时执行的回调函数，无论成功或失败都会执行。</li><li>cancel：用户点击取消时的回调函数，仅部分有用户取消操作的api才会用到。</li><li>trigger: 监听Menu中的按钮点击时触发的方法，该方法仅支持Menu中的相关接口。</li></ol><blockquote data-sign="c089bbb93f4cff844eabd990444fba3d_2" data-lines="2">不要尝试在 trigger 中使用 Ajax 异步请求修改本次分享的内容，因为客户端分享操作是一个同步操作，这时候使用 Ajax 的回包会还没有返回。</blockquote><p data-sign="63726025ff1b01d8c6a1e8612a42a68c" data-type="p" data-lines="2">以上几个函数都带有一个参数，类型为对象，其中除了每个接口本身返回的数据之外，还有一个通用属性err_msg，其值格式如下：</p><ol data-sign="3f0fe9b29de5ef9ddb82c81de411db6clist3" data-lines="3" class="cherry-list__default" start="1"><li>调用成功时："xxx:ok" ，其中xxx为调用的接口名</li><li>用户取消时："xxx:cancel"，其中xxx为调用的接口名</li><li>调用失败时：其值为具体错误信息</li></ol></div></div>
    </div>
                <script src="../doc-script.js"></script>
                
                
                </body></html>